<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Visualizations for Env Chem | R for Environmental Chemists</title>
  <meta name="description" content="This is a proof-of-concept for a further full length textbook." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Visualizations for Env Chem | R for Environmental Chemists" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://davidrosshall.github.io/R4EnvChem/" />
  
  <meta property="og:description" content="This is a proof-of-concept for a further full length textbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Visualizations for Env Chem | R for Environmental Chemists" />
  
  <meta name="twitter:description" content="This is a proof-of-concept for a further full length textbook." />
  

<meta name="author" content="David Hall, Steven Kutarna, Kristen Yeh, Hui Peng and Jessica D’eon" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="summarizing-data.html"/>
<link rel="next" href="linear-regression-redux.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Environmental Chemistry</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#providing-feedback"><i class="fa fa-check"></i>Providing Feedback</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors"><i class="fa fa-check"></i>Authors</a></li>
</ul></li>
<li class="part"><span><b>Section 1: Getting Setup in R</b></span></li>
<li class="chapter" data-level="1" data-path="installing-r.html"><a href="installing-r.html"><i class="fa fa-check"></i><b>1</b> Installing R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="installing-r.html"><a href="installing-r.html#prerequisite-software"><i class="fa fa-check"></i><b>1.1</b> Prerequisite software</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="installing-r.html"><a href="installing-r.html#r"><i class="fa fa-check"></i><b>1.1.1</b> R</a></li>
<li class="chapter" data-level="1.1.2" data-path="installing-r.html"><a href="installing-r.html#downloading-rstudio-ide"><i class="fa fa-check"></i><b>1.1.2</b> Downloading RStudio IDE</a></li>
<li class="chapter" data-level="1.1.3" data-path="installing-r.html"><a href="installing-r.html#installing-packages"><i class="fa fa-check"></i><b>1.1.3</b> Installing packages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="installing-r.html"><a href="installing-r.html#running-r-code"><i class="fa fa-check"></i><b>1.2</b> Running R Code</a></li>
<li class="chapter" data-level="1.3" data-path="installing-r.html"><a href="installing-r.html#customizing-rstudio"><i class="fa fa-check"></i><b>1.3</b> Customizing RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="installing-r.html"><a href="installing-r.html#where-to-get-help"><i class="fa fa-check"></i><b>1.4</b> Where to get help</a></li>
<li class="chapter" data-level="1.5" data-path="installing-r.html"><a href="installing-r.html#summary"><i class="fa fa-check"></i><b>1.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-studio-projects.html"><a href="r-studio-projects.html"><i class="fa fa-check"></i><b>2</b> R Studio Projects</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-studio-projects.html"><a href="r-studio-projects.html#paths-and-directories"><i class="fa fa-check"></i><b>2.1</b> Paths and directories</a></li>
<li class="chapter" data-level="2.2" data-path="r-studio-projects.html"><a href="r-studio-projects.html#importing-a-project"><i class="fa fa-check"></i><b>2.2</b> Importing a project</a></li>
<li class="chapter" data-level="2.3" data-path="r-studio-projects.html"><a href="r-studio-projects.html#summary-1"><i class="fa fa-check"></i><b>2.3</b> Summary</a></li>
<li class="chapter" data-level="2.4" data-path="r-studio-projects.html"><a href="r-studio-projects.html#creating-an-rstudio-project"><i class="fa fa-check"></i><b>2.4</b> Creating an RStudio project</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-coding-basics.html"><a href="r-coding-basics.html"><i class="fa fa-check"></i><b>3</b> R coding basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#variables"><i class="fa fa-check"></i><b>3.1</b> Variables</a></li>
<li class="chapter" data-level="3.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-types"><i class="fa fa-check"></i><b>3.2</b> Data Types</a></li>
<li class="chapter" data-level="3.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-structures"><i class="fa fa-check"></i><b>3.3</b> Data Structures</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#accessing-data-in-subfolders"><i class="fa fa-check"></i><b>3.3.1</b> Accessing data in subfolders</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r-coding-basics.html"><a href="r-coding-basics.html#other-data-structures"><i class="fa fa-check"></i><b>3.4</b> Other data structures</a></li>
<li class="chapter" data-level="3.5" data-path="r-coding-basics.html"><a href="r-coding-basics.html#r-packages-and-functions"><i class="fa fa-check"></i><b>3.5</b> R packages and functions</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#ggplot2"><i class="fa fa-check"></i><b>3.5.1</b> ggplot2</a></li>
<li class="chapter" data-level="3.5.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#calling-specific-functions"><i class="fa fa-check"></i><b>3.5.2</b> Calling specific functions</a></li>
<li class="chapter" data-level="3.5.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#function-documentation"><i class="fa fa-check"></i><b>3.5.3</b> Function Documentation</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="r-coding-basics.html"><a href="r-coding-basics.html#summary-2"><i class="fa fa-check"></i><b>3.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html"><i class="fa fa-check"></i><b>4</b> Workflows for R coding</a>
<ul>
<li class="chapter" data-level="4.1" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#creating-or-opening-a-script"><i class="fa fa-check"></i><b>4.1</b> Creating or opening a script</a></li>
<li class="chapter" data-level="4.2" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#workspace-and-whats-real"><i class="fa fa-check"></i><b>4.2</b> Workspace and what’s real</a></li>
<li class="chapter" data-level="4.3" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#saving-r-scripts"><i class="fa fa-check"></i><b>4.3</b> Saving R scripts</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#what-should-i-save"><i class="fa fa-check"></i><b>4.3.1</b> What should I save?</a></li>
<li class="chapter" data-level="4.3.2" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#saving-objects"><i class="fa fa-check"></i><b>4.3.2</b> Saving objects</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#script-formatting"><i class="fa fa-check"></i><b>4.4</b> Script formatting</a></li>
<li class="chapter" data-level="4.5" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#viewing-data-and-code-simultaneously"><i class="fa fa-check"></i><b>4.5</b> Viewing data and code simultaneously</a></li>
<li class="chapter" data-level="4.6" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#troubleshooting-error-messages"><i class="fa fa-check"></i><b>4.6</b> Troubleshooting error messages</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#script-diagnostics"><i class="fa fa-check"></i><b>4.6.1</b> Script diagnostics</a></li>
<li class="chapter" data-level="4.6.2" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#reading-error-codes"><i class="fa fa-check"></i><b>4.6.2</b> Reading error codes</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#summary-3"><i class="fa fa-check"></i><b>4.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="using-r-markdown.html"><a href="using-r-markdown.html"><i class="fa fa-check"></i><b>5</b> Using R Markdown</a>
<ul>
<li class="chapter" data-level="5.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#deeper-look-into-rmarkdown"><i class="fa fa-check"></i><b>5.1</b> Deeper look into rmarkdown</a></li>
<li class="chapter" data-level="5.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#getting-started-with-rmarkdown"><i class="fa fa-check"></i><b>5.2</b> Getting started with rmarkdown</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#understanding-rmarkdown"><i class="fa fa-check"></i><b>5.2.1</b> Understanding rmarkdown</a></li>
<li class="chapter" data-level="5.2.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#running-code-in-rmarkdown"><i class="fa fa-check"></i><b>5.2.2</b> Running code in rmarkdown</a></li>
<li class="chapter" data-level="5.2.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#generating-final-report"><i class="fa fa-check"></i><b>5.2.3</b> Generating final report</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#so-now-what-do-i-do-with-r-markdown"><i class="fa fa-check"></i><b>5.3</b> So now what do I do with R Markdown?</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-markdown-resources-and-further-reading"><i class="fa fa-check"></i><b>5.3.1</b> R Markdown resources and further reading</a></li>
<li class="chapter" data-level="5.3.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-code-chunk-options"><i class="fa fa-check"></i><b>5.3.2</b> R code chunk options</a></li>
<li class="chapter" data-level="5.3.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#inserting-images"><i class="fa fa-check"></i><b>5.3.3</b> Inserting images</a></li>
<li class="chapter" data-level="5.3.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#generating-tables"><i class="fa fa-check"></i><b>5.3.4</b> Generating Tables</a></li>
<li class="chapter" data-level="5.3.5" data-path="using-r-markdown.html"><a href="using-r-markdown.html#spellcheck-in-r-markdown"><i class="fa fa-check"></i><b>5.3.5</b> Spellcheck in R Markdown</a></li>
<li class="chapter" data-level="5.3.6" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-markdown-syntax"><i class="fa fa-check"></i><b>5.3.6</b> R markdown syntax</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#rstudio-tips-and-tricks"><i class="fa fa-check"></i><b>5.4</b> RStudio tips and tricks</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="r-tutorial-exercise.html"><a href="r-tutorial-exercise.html"><i class="fa fa-check"></i><b>6</b> R Tutorial Exercise</a>
<ul>
<li class="chapter" data-level="6.1" data-path="r-tutorial-exercise.html"><a href="r-tutorial-exercise.html#expected-outcome"><i class="fa fa-check"></i><b>6.1</b> Expected outcome</a></li>
</ul></li>
<li class="part"><span><b>Section 2: Data Analysis in R</b></span></li>
<li class="chapter" data-level="7" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html"><i class="fa fa-check"></i><b>7</b> Intro to Data Analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#example-data"><i class="fa fa-check"></i><b>7.1</b> Example Data</a></li>
<li class="chapter" data-level="7.2" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#further-reading"><i class="fa fa-check"></i><b>7.2</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html"><i class="fa fa-check"></i><b>8</b> Importing data into R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#how-data-is-stored"><i class="fa fa-check"></i><b>8.1</b> How data is stored</a></li>
<li class="chapter" data-level="8.2" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#read_csv"><i class="fa fa-check"></i><b>8.2</b> read_csv</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#tibbles-vs.-data-frames"><i class="fa fa-check"></i><b>8.2.1</b> Tibbles vs. data frames</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#importing-other-data-types"><i class="fa fa-check"></i><b>8.3</b> Importing other data types</a></li>
<li class="chapter" data-level="8.4" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#saving-data"><i class="fa fa-check"></i><b>8.4</b> Saving data</a></li>
<li class="chapter" data-level="8.5" data-path="importing-data-into-r.html"><a href="importing-data-into-r.html#further-reading-1"><i class="fa fa-check"></i><b>8.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tidying-your-data.html"><a href="tidying-your-data.html"><i class="fa fa-check"></i><b>9</b> Tidying your data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="tidying-your-data.html"><a href="tidying-your-data.html#what-is-tidy-data"><i class="fa fa-check"></i><b>9.1</b> What is tidy data?</a></li>
<li class="chapter" data-level="9.2" data-path="tidying-your-data.html"><a href="tidying-your-data.html#tools-to-tidy-your-data"><i class="fa fa-check"></i><b>9.2</b> Tools to tidy your data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="tidying-your-data.html"><a href="tidying-your-data.html#making-data-longer"><i class="fa fa-check"></i><b>9.2.1</b> Making data ‘longer’</a></li>
<li class="chapter" data-level="9.2.2" data-path="tidying-your-data.html"><a href="tidying-your-data.html#making-data-wider"><i class="fa fa-check"></i><b>9.2.2</b> Making data ‘wider’</a></li>
<li class="chapter" data-level="9.2.3" data-path="tidying-your-data.html"><a href="tidying-your-data.html#seperating-columns"><i class="fa fa-check"></i><b>9.2.3</b> Seperating columns</a></li>
<li class="chapter" data-level="9.2.4" data-path="tidying-your-data.html"><a href="tidying-your-data.html#unitingcombining-columns"><i class="fa fa-check"></i><b>9.2.4</b> Uniting/combining columns</a></li>
<li class="chapter" data-level="9.2.5" data-path="tidying-your-data.html"><a href="tidying-your-data.html#renaming-columnsheaders"><i class="fa fa-check"></i><b>9.2.5</b> Renaming columns/headers</a></li>
<li class="chapter" data-level="9.2.6" data-path="tidying-your-data.html"><a href="tidying-your-data.html#rounding-numbers"><i class="fa fa-check"></i><b>9.2.6</b> Rounding numbers</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="tidying-your-data.html"><a href="tidying-your-data.html#tips-for-recording-data"><i class="fa fa-check"></i><b>9.3</b> Tips for recording data</a></li>
<li class="chapter" data-level="9.4" data-path="tidying-your-data.html"><a href="tidying-your-data.html#further-reading-2"><i class="fa fa-check"></i><b>9.4</b> Further reading</a></li>
<li class="chapter" data-level="9.5" data-path="tidying-your-data.html"><a href="tidying-your-data.html#chapter-references"><i class="fa fa-check"></i><b>9.5</b> Chapter References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="transform-dplyr-and-data-manipulation.html"><a href="transform-dplyr-and-data-manipulation.html"><i class="fa fa-check"></i><b>10</b> Transform: dplyr and data manipulation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="transform-dplyr-and-data-manipulation.html"><a href="transform-dplyr-and-data-manipulation.html#selecting-by-row-or-value"><i class="fa fa-check"></i><b>10.1</b> Selecting by row or value</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="transform-dplyr-and-data-manipulation.html"><a href="transform-dplyr-and-data-manipulation.html#logical-oeprators"><i class="fa fa-check"></i><b>10.1.1</b> Logical oeprators</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="transform-dplyr-and-data-manipulation.html"><a href="transform-dplyr-and-data-manipulation.html#arranging-rows"><i class="fa fa-check"></i><b>10.2</b> Arranging rows</a></li>
<li class="chapter" data-level="10.3" data-path="transform-dplyr-and-data-manipulation.html"><a href="transform-dplyr-and-data-manipulation.html#selecting-by-column-or-variable"><i class="fa fa-check"></i><b>10.3</b> Selecting by column or variable</a></li>
<li class="chapter" data-level="10.4" data-path="transform-dplyr-and-data-manipulation.html"><a href="transform-dplyr-and-data-manipulation.html#adding-new-variables"><i class="fa fa-check"></i><b>10.4</b> Adding new variables</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="transform-dplyr-and-data-manipulation.html"><a href="transform-dplyr-and-data-manipulation.html#useful-mutate-function"><i class="fa fa-check"></i><b>10.4.1</b> Useful mutate function</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="transform-dplyr-and-data-manipulation.html"><a href="transform-dplyr-and-data-manipulation.html#group-and-summarize-data"><i class="fa fa-check"></i><b>10.5</b> Group and summarize data</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="transform-dplyr-and-data-manipulation.html"><a href="transform-dplyr-and-data-manipulation.html#useful-summarize-functions"><i class="fa fa-check"></i><b>10.5.1</b> Useful summarize functions</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="transform-dplyr-and-data-manipulation.html"><a href="transform-dplyr-and-data-manipulation.html#the-pipe-chaining-functions-together"><i class="fa fa-check"></i><b>10.6</b> The pipe: chaining functions together</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="transform-dplyr-and-data-manipulation.html"><a href="transform-dplyr-and-data-manipulation.html#notes-on-piping"><i class="fa fa-check"></i><b>10.6.1</b> Notes on piping</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="transform-dplyr-and-data-manipulation.html"><a href="transform-dplyr-and-data-manipulation.html#further-reading-3"><i class="fa fa-check"></i><b>10.7</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="programming-with-r.html"><a href="programming-with-r.html"><i class="fa fa-check"></i><b>11</b> Programming with R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="programming-with-r.html"><a href="programming-with-r.html#functions"><i class="fa fa-check"></i><b>11.1</b> Functions</a></li>
<li class="chapter" data-level="11.2" data-path="programming-with-r.html"><a href="programming-with-r.html#conditional-arguments"><i class="fa fa-check"></i><b>11.2</b> Conditional arguments</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="programming-with-r.html"><a href="programming-with-r.html#piping-conditional-statements"><i class="fa fa-check"></i><b>11.2.1</b> Piping conditional statements</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="programming-with-r.html"><a href="programming-with-r.html#when-to-use-functions"><i class="fa fa-check"></i><b>11.3</b> When to use functions</a></li>
<li class="chapter" data-level="11.4" data-path="programming-with-r.html"><a href="programming-with-r.html#further-reading-4"><i class="fa fa-check"></i><b>11.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="modelling.html"><a href="modelling.html"><i class="fa fa-check"></i><b>12</b> Modelling</a>
<ul>
<li class="chapter" data-level="12.1" data-path="modelling.html"><a href="modelling.html#base-r-linear-model"><i class="fa fa-check"></i><b>12.1</b> Base R Linear Model</a></li>
<li class="chapter" data-level="12.2" data-path="modelling.html"><a href="modelling.html#cleaning-up-model-ouputs"><i class="fa fa-check"></i><b>12.2</b> Cleaning up model ouputs</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="modelling.html"><a href="modelling.html#why-we-approach-modelling-this-way"><i class="fa fa-check"></i><b>12.2.1</b> Why we approach modelling this way</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="modelling.html"><a href="modelling.html#visualizing-model"><i class="fa fa-check"></i><b>12.3</b> Visualizing model</a></li>
<li class="chapter" data-level="12.4" data-path="modelling.html"><a href="modelling.html#further-reading-5"><i class="fa fa-check"></i><b>12.4</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="visualizations.html"><a href="visualizations.html"><i class="fa fa-check"></i><b>13</b> Visualizations</a>
<ul>
<li class="chapter" data-level="13.1" data-path="visualizations.html"><a href="visualizations.html#building-plots-ups"><i class="fa fa-check"></i><b>13.1</b> Building plots ups</a></li>
<li class="chapter" data-level="13.2" data-path="visualizations.html"><a href="visualizations.html#basic-plotting"><i class="fa fa-check"></i><b>13.2</b> Basic plotting</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="visualizations.html"><a href="visualizations.html#changing-plot-labels"><i class="fa fa-check"></i><b>13.2.1</b> Changing plot labels</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="visualizations.html"><a href="visualizations.html#further-reading-6"><i class="fa fa-check"></i><b>13.3</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="communication.html"><a href="communication.html"><i class="fa fa-check"></i><b>14</b> Communication</a></li>
<li class="part"><span><b>Section 3: Data Analysis Toolbox</b></span></li>
<li class="chapter" data-level="15" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>15</b> Introduction</a></li>
<li class="chapter" data-level="16" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>16</b> Summarizing data</a>
<ul>
<li class="chapter" data-level="16.1" data-path="summarizing-data.html"><a href="summarizing-data.html#data-to-play-with"><i class="fa fa-check"></i><b>16.1</b> Data to play with</a></li>
<li class="chapter" data-level="16.2" data-path="summarizing-data.html"><a href="summarizing-data.html#summarizing-data-by-group"><i class="fa fa-check"></i><b>16.2</b> Summarizing data by group</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#further-sumarize-operations"><i class="fa fa-check"></i><b>16.2.1</b> Further sumarize operations</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="summarizing-data.html"><a href="summarizing-data.html#pretty-tables-with-flextable"><i class="fa fa-check"></i><b>16.3</b> Pretty tables with flextable</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#uniting-columns"><i class="fa fa-check"></i><b>16.3.1</b> Uniting columns</a></li>
<li class="chapter" data-level="16.3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#pretty-kables"><i class="fa fa-check"></i><b>16.3.2</b> Pretty kables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html"><i class="fa fa-check"></i><b>17</b> Visualizations for Env Chem</a>
<ul>
<li class="chapter" data-level="" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#discrete-vs.-continuous-variables"><i class="fa fa-check"></i>Discrete vs. continuous variables</a></li>
<li class="chapter" data-level="" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="17.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#bar-chart"><i class="fa fa-check"></i><b>17.1</b> Bar chart</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#adding-error-bars"><i class="fa fa-check"></i><b>17.1.1</b> Adding error bars</a></li>
<li class="chapter" data-level="17.1.2" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#ordering-bar-charts"><i class="fa fa-check"></i><b>17.1.2</b> Ordering bar charts</a></li>
<li class="chapter" data-level="17.1.3" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#grouping-bar-charts"><i class="fa fa-check"></i><b>17.1.3</b> Grouping bar charts</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#box-plots"><i class="fa fa-check"></i><b>17.2</b> Box Plots</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#box-plot-alternatives"><i class="fa fa-check"></i><b>17.2.1</b> Box plot alternatives</a></li>
<li class="chapter" data-level="17.2.2" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#statistical-comparisons-between-groups"><i class="fa fa-check"></i><b>17.2.2</b> Statistical comparisons between groups</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#histograms"><i class="fa fa-check"></i><b>17.3</b> Histograms</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#multiple-histograms"><i class="fa fa-check"></i><b>17.3.1</b> Multiple histograms</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#scatter-plots"><i class="fa fa-check"></i><b>17.4</b> Scatter plots</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#marginal-plots"><i class="fa fa-check"></i><b>17.4.1</b> Marginal plots</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#plotting-for-publication"><i class="fa fa-check"></i><b>17.5</b> Plotting for publication</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#plot-themes"><i class="fa fa-check"></i><b>17.5.1</b> Plot Themes</a></li>
<li class="chapter" data-level="17.5.2" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#legends"><i class="fa fa-check"></i><b>17.5.2</b> Legends</a></li>
<li class="chapter" data-level="17.5.3" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#modifying-labels"><i class="fa fa-check"></i><b>17.5.3</b> Modifying labels</a></li>
<li class="chapter" data-level="17.5.4" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#modifying-axis"><i class="fa fa-check"></i><b>17.5.4</b> Modifying Axis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-regression-redux.html"><a href="linear-regression-redux.html"><i class="fa fa-check"></i><b>18</b> Linear Regression Redux</a></li>
<li class="chapter" data-level="19" data-path="non-linear-logistic-regression-modelling.html"><a href="non-linear-logistic-regression-modelling.html"><i class="fa fa-check"></i><b>19</b> Non-linear Logistic Regression Modelling</a>
<ul>
<li class="chapter" data-level="19.1" data-path="non-linear-logistic-regression-modelling.html"><a href="non-linear-logistic-regression-modelling.html#visually-inspecting-our-data"><i class="fa fa-check"></i><b>19.1</b> Visually inspecting our data</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="non-linear-logistic-regression-modelling.html"><a href="non-linear-logistic-regression-modelling.html#annotating-maximal-values"><i class="fa fa-check"></i><b>19.1.1</b> Annotating maximal values</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="non-linear-logistic-regression-modelling.html"><a href="non-linear-logistic-regression-modelling.html#extracting-maximal-values"><i class="fa fa-check"></i><b>19.2</b> Extracting maximal values</a></li>
<li class="chapter" data-level="19.3" data-path="non-linear-logistic-regression-modelling.html"><a href="non-linear-logistic-regression-modelling.html#modelling-sigmoidal-curve"><i class="fa fa-check"></i><b>19.3</b> Modelling Sigmoidal Curve</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="non-linear-logistic-regression-modelling.html"><a href="non-linear-logistic-regression-modelling.html#calculating-logistic-regression"><i class="fa fa-check"></i><b>19.3.1</b> Calculating Logistic Regression</a></li>
<li class="chapter" data-level="19.3.2" data-path="non-linear-logistic-regression-modelling.html"><a href="non-linear-logistic-regression-modelling.html#extracting-model-parameters"><i class="fa fa-check"></i><b>19.3.2</b> Extracting model parameters</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Section 4: Notes for Env. Chem. Labs</b></span></li>
<li class="chapter" data-level="20" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html"><i class="fa fa-check"></i><b>20</b> CHM410: Air Quality Lab</a>
<ul>
<li class="chapter" data-level="20.1" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#importing-data"><i class="fa fa-check"></i><b>20.1</b> Importing Data</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#importing-airbeam-2-data"><i class="fa fa-check"></i><b>20.1.1</b> Importing Airbeam 2 data</a></li>
<li class="chapter" data-level="20.1.2" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#importing-co2-and-o3-data"><i class="fa fa-check"></i><b>20.1.2</b> Importing CO2 and O3 data</a></li>
<li class="chapter" data-level="20.1.3" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#merging-datasets"><i class="fa fa-check"></i><b>20.1.3</b> Merging datasets</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#plotting-data-spatially"><i class="fa fa-check"></i><b>20.2</b> Plotting data spatially</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#plotting-airbeam-data-spatially"><i class="fa fa-check"></i><b>20.2.1</b> Plotting Airbeam data spatially</a></li>
<li class="chapter" data-level="20.2.2" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#plotting-gases-data-spatially"><i class="fa fa-check"></i><b>20.2.2</b> Plotting gases data spatially</a></li>
<li class="chapter" data-level="20.2.3" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#combining-maps"><i class="fa fa-check"></i><b>20.2.3</b> Combining maps</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#summary-4"><i class="fa fa-check"></i><b>20.3</b> Summary</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Environmental Chemists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualizations-for-env-chem" class="section level1" number="17">
<h1><span class="header-section-number">Chapter 17</span> Visualizations for Env Chem</h1>
<p>We’ve already encountered and produced several types of plots to visualize our data. We’ve also gone over the theory and basic operations of <code>ggplot()</code> in the <a href="visualizations.html#visualizations">Visualizations</a> chapter. In this chapter, we’ll expand on these and explicitly walk through the most common data visualization methods you’ll encounter in the field of environmental chemistry. Additionally, we’ll learn how to get your plots ready for publication.</p>
<p>The plots we’ll be covering include:</p>
<ul>
<li>bar plots</li>
<li>box plots</li>
<li>histograms</li>
<li>scatter plots (with linear regression)</li>
<li>Touch ups for publications</li>
</ul>
<p>These are only a smattering of the possible data visualizations you can perform in R. We’re focusing on them because of their ubiquity in our field, but they often won’t be the ideal visualizations you need to communicate <em>your story</em>. We highly recommend you check out the following resources. Not only are they a great source of inspiration, they provide example code to get you up and running. We consult them regularly.</p>
<ul>
<li><strong><a href="https://www.data-to-viz.com/">Data to viz</a></strong> which features a decision tree to help you decide on what plot would serve you best.</li>
<li><strong><a href="https://exts.ggplot2.tidyverse.org/gallery/">ggplot2 extensions gallery</a></strong> which is the best repository to the plethora of <code>ggplot2()</code> extensions. If you need a specialized plot, check here. Odds are someone has a solution to your problem. Some great extensions include <a href="https://github.com/slowkow/ggrepel"><code>ggrepel</code></a> for easy labelling of points; <a href="https://docs.r4photobiology.info/ggpmisc/"><code>ggpmisc</code></a> for statistical annotations; and <a href="https://rpkgs.datanovia.com/ggpubr/"><code>ggpubr</code></a> for publication ready plots, group wise comparisons, and annotation of statistical significance.</li>
<li><strong><a href="https://www.r-graph-gallery.com/index.html">The R Graph Gallery</a></strong> contains hundreds of charts made with R. While it’s not as easy to navigate as <em>Data to viz</em>, it does contain many more examples; it is definitely worth exploring.</li>
</ul>
<div id="discrete-vs.-continuous-variables" class="section level3 unnumbered">
<h3>Discrete vs. continuous variables</h3>
<p>The type of plots available to you, and how they display, are dependent on the type of data. Namely, whether your data is <em>discrete</em> (i.e .can only take particular values) or <em>continuous</em> (is not restricted to defined separate values, but can occupy any value over a continuous range). So a variable consisting of cities would be discrete, whereas a variable like concentration of a chemical would be continuous. You can treat numeric data as categorical if you so chose. Understanding the difference between discrete and continuous data will shape how you plot your data.</p>
</div>
<div id="prerequisites" class="section level3 unnumbered">
<h3>Prerequisites</h3>
<p>This chapter assumes you’ve read the <a href="tidying-your-data.html#tidying-your-data">Tidying your data</a> chapter to understand the concept of tidy data, and the <a href="visualizations.html#visualizations">Visualizations</a> chapter to understand the fundamental logic of the <code>ggplot2</code> package.</p>
<p>Additionally, for this chapter we’ll mostly be using the <code>atlNO2</code> and <code>sumAtl</code> datasets we created in the <a href="summarizing-data.html#summarizing-data">Summarizing data</a> chapter. Please revisit that chapter for details on that dataset.</p>
</div>
<div id="bar-chart" class="section level2" number="17.1">
<h2><span class="header-section-number">17.1</span> Bar chart</h2>
<p>Bar charts, also called <em>column</em> charts, represent <em>categorical</em> data with rectangular bars whose height/length is proportional to the values they represent.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="visualizations-for-env-chem.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sumAtl,</span>
<span id="cb217-2"><a href="visualizations-for-env-chem.html#cb217-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> city, </span>
<span id="cb217-3"><a href="visualizations-for-env-chem.html#cb217-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb217-4"><a href="visualizations-for-env-chem.html#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb217-5"><a href="visualizations-for-env-chem.html#cb217-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="co"># rotates plot 90 degrees</span></span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<p>Pretty boring, but it’s gotten the job done. <strong>Note</strong> that we used <code>coord_flip()</code> to rotate our plot 90<span class="math inline">\(^\circ\)</span> therefore the supplied <code>x</code> option of <code>city</code> is now plotted on the <code>y-axis</code>. This makes reading long categorical names (i.e. the names of cities) easier. <code>coord_flip()</code> doesn’t change anything else except the final orientation of the plot.</p>
<p>Also note that <code>ggplot()</code> includes <code>geom_col()</code> and <code>geom_bar()</code>. While both can be used to make bar charts. <code>geom_col()</code> is used when you want to represent values in the data (i.e. the precalculated mean as shown above), whereas <code>geom_bar()</code> makes the height of the bar proportional to the number of cases in each group.</p>
<div id="adding-error-bars" class="section level3" number="17.1.1">
<h3><span class="header-section-number">17.1.1</span> Adding error bars</h3>
<p>Any measurement always has an associated uncertainty/variability. These values are expressed visually via <em>error bars</em> demarcating the minimum and maximum variability and give a general idea of how precise a measurement is. In our <code>sumAtl</code> dataset we’ve calculated the standard deviation as a measure of uncertainty. In our example, we’ve used the standard deviation (<code>sd</code>) as a measure of uncertainty of our calculated annual means.</p>
<p>To plot error bars we use <code>geom_errorbar()</code> and pass the min and max values we want the error bars to be. In our case, the lowest value would be <code>ymin = mean - sd</code>, and the highest would be <code>ymin = mean + sd</code>. Our plotted error bars now indicated plus or minus one standard deviation from the mean.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="visualizations-for-env-chem.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sumAtl, <span class="fu">aes</span>(<span class="at">x =</span> city, <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb218-2"><a href="visualizations-for-env-chem.html#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-3"><a href="visualizations-for-env-chem.html#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> sd, </span>
<span id="cb218-4"><a href="visualizations-for-env-chem.html#cb218-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> sd)) <span class="sc">+</span></span>
<span id="cb218-5"><a href="visualizations-for-env-chem.html#cb218-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
<p>Some of the error bars indicate we could get a <em>negative</em> concentration of NO<sub>2</sub>. This is physically impossible, but it does suggest we should evaluate the distribution of our data (see below). Note that since we’re calculating error bar ranges on the fly, we’ve had to specify new aesthetic arguments to <code>geom_errorbar()</code>.</p>
</div>
<div id="ordering-bar-charts" class="section level3" number="17.1.2">
<h3><span class="header-section-number">17.1.2</span> Ordering bar charts</h3>
<p>Often with bar charts (and similar plots), it’s useful to <em>order</em> the bars to help tell a story or convey information. We can effectuate this using <code>fct_reorder()</code>:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="visualizations-for-env-chem.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sumAtl, </span>
<span id="cb219-2"><a href="visualizations-for-env-chem.html#cb219-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(city, mean),</span>
<span id="cb219-3"><a href="visualizations-for-env-chem.html#cb219-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb219-4"><a href="visualizations-for-env-chem.html#cb219-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb219-5"><a href="visualizations-for-env-chem.html#cb219-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> sd, </span>
<span id="cb219-6"><a href="visualizations-for-env-chem.html#cb219-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> sd)) <span class="sc">+</span></span>
<span id="cb219-7"><a href="visualizations-for-env-chem.html#cb219-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<p>So in our aesthetics call for <code>geom_bar</code> we specified the <code>x</code> variable should be <code>city</code>, but ordered based on their corresponding <code>mean</code> value. Doing this has helped shed some light on trends in NO<sub>2</sub> levels. For one, despite Labrador City having lower mean [NO<sub>2</sub>], we can now easily see that it has a larger variation in [NO<sub>2</sub>] then Corner Brook.</p>
</div>
<div id="grouping-bar-charts" class="section level3" number="17.1.3">
<h3><span class="header-section-number">17.1.3</span> Grouping bar charts</h3>
<p>Sometimes you’ll want to group bar charts as in the concentration of several chemicals in different locations. We can easily group bar charts in ggplot. Let’s go ahead and group our mean annual [NO<sub>2</sub>] by province by simply (1) reordering based on province, and (2) colour bars based on province:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="visualizations-for-env-chem.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sumAtl, </span>
<span id="cb220-2"><a href="visualizations-for-env-chem.html#cb220-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(city, p),</span>
<span id="cb220-3"><a href="visualizations-for-env-chem.html#cb220-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> mean, </span>
<span id="cb220-4"><a href="visualizations-for-env-chem.html#cb220-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> p)) <span class="sc">+</span></span>
<span id="cb220-5"><a href="visualizations-for-env-chem.html#cb220-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb220-6"><a href="visualizations-for-env-chem.html#cb220-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> sd, </span>
<span id="cb220-7"><a href="visualizations-for-env-chem.html#cb220-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> sd)) <span class="sc">+</span></span>
<span id="cb220-8"><a href="visualizations-for-env-chem.html#cb220-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-105-1.png" width="672" /></p>
<p>There are other ways to group your bar charts depending on the story you want to tell and the data you have. Please consult the <a href="https://www.r-graph-gallery.com/48-grouped-barplot-with-ggplot2.html">Grouped, stacked and percent stacked barplot in ggplot2</a> page from the <em>R-graph-gallery</em>.</p>
</div>
</div>
<div id="box-plots" class="section level2" number="17.2">
<h2><span class="header-section-number">17.2</span> Box Plots</h2>
<p>Box plots give a summary of the <em>distribution</em> of a numeric variable through their <em>quartiles</em>. You’ve no doubt seen them before, but they’re often misinterpreted. Let’s create a box-plot using <code>geom_boxplot()</code> and our Atlantic hourly NO<sub>2</sub> measurements, then we’ll break down how to interpret it.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="visualizations-for-env-chem.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atlNO2, </span>
<span id="cb221-2"><a href="visualizations-for-env-chem.html#cb221-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>( <span class="at">x =</span> city, <span class="at">y =</span> conc)) <span class="sc">+</span></span>
<span id="cb221-3"><a href="visualizations-for-env-chem.html#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb221-4"><a href="visualizations-for-env-chem.html#cb221-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
<p>Let’s break down how to interpret <em>one</em> box before tackling the entire set. As previously mentioned, box plots describe data in their <em>quartiles</em>. Quartiles basically arrange the data from the lowest to highest value and split the data at <em>three points</em>:</p>
<ul>
<li><em>The first quartile</em> (Q1) is halfway between the lowest value and the median (50%) of the data. In other words 25% of the data lies <em>below</em> Q1.</li>
<li><em>The second quartile</em> (Q2) is the median. 50% of the data lies below, and 50% lies above this point.</li>
<li><em>The third quartile</em> (Q3) is halfway between the median and the <em>highest</em> value in the data. In other words, 75% of the data lies <em>below</em> Q3.</li>
</ul>
<p>The <em>box</em> in box-plots represents the range between Q1 and Q3. This is known as the <em>inter-quartile range</em> (IQR) and 50% of the total data falls somewhere inside this box. You can estimate the distribution by the symmetry of the box. if Q1 to the median is smaller than the median to Q3, the data has a <em>positive skew</em> (right sided skew), and vice versa.</p>
<p>Rounding it out, <code>geom_boxplot()</code> includes <em>whiskers</em>, the thin lines emanating out from the box. This is used the predict outliers and is calculated as <span class="math inline">\(outliers = \pm 1.5 \times IQR\)</span>. Anything outside the whiskers is considered an “outliers” or an extreme point, and is plotted individually.</p>
<p>Putting this all together, let’s look at the [NO<sub>2</sub>] for St. Johns city:</p>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
<p>Note that we’ve plotted the actual distribution of the data. Prior to the computers, this was incredibly difficult to do, hence the use of box plots which can be drawn knowing only five points. However, the simplicity in calculating box-plots means they can hide trends and observations of your data. On top of that, they aren’t very intuitive (see the score of text needed to explain them). Consequently, we strongly recommend you explore some of the <a href="visualizations-for-env-chem.html#box-plot-alternatives">Box plot alternatives</a> unless you are explicitly asked to create box-plots.</p>
<div id="box-plot-alternatives" class="section level3" number="17.2.1">
<h3><span class="header-section-number">17.2.1</span> Box plot alternatives</h3>
<p>The first alternative to box-plots is the <em>violin plot</em> which is made using <code>geom_violin()</code>. It is similar to the box-plot, but instead of displaying the quartiles, it plots the density within each group and is a bit more intuitive then box-plots. While the example below isn’t the most convincing given the scale of the dataset, violin plots are useful for identifying underlying trends in the distribution of data. For example, in the plot below we can see that some towns such as Marystown principle has days where [NO<sub>2</sub>] = 0 ppb, whereas Grand Falls-Windsor has a large number of days with low, but measurable levels of NO<sub>2</sub>. This might be because of difference in regional ambient levels of NO<sub>2</sub>.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="visualizations-for-env-chem.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atlNO2, </span>
<span id="cb222-2"><a href="visualizations-for-env-chem.html#cb222-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> city, <span class="at">y =</span> conc, <span class="at">fill =</span> p)) <span class="sc">+</span> </span>
<span id="cb222-3"><a href="visualizations-for-env-chem.html#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb222-4"><a href="visualizations-for-env-chem.html#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/atl-violin-1.png" width="672" /></p>
<p>Another alternative is to plot the points overtop of the box-plot. You’ve encountered this example in <a href="r-coding-basics.html#r-coding-basics">R coding basics</a>. Truth be told, there are countless way to visualize distribution.</p>
</div>
<div id="statistical-comparisons-between-groups" class="section level3" number="17.2.2">
<h3><span class="header-section-number">17.2.2</span> Statistical comparisons between groups</h3>
<p>Often box-plots are used to show differences in distributions between two groups (i.e. population in Location A vs. Location B). How you determine this statistically is a different story, but packages such as <code>ggpubr</code> have many built in functionalists to display the results of these outcomes.</p>
<p>From our NO<sub>2</sub> data, St. Johns appears to have the highest levels of NO<sub>2</sub>. Let’s apply a pairwise test against other Newfoundland communities to see if our observation is <em>statistically significant</em> based upon the results of a <em>Wilcoxon test</em>.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="visualizations-for-env-chem.html#cb223-1" aria-hidden="true" tabindex="-1"></a>nfld <span class="ot">&lt;-</span> atlNO2 <span class="sc">%&gt;%</span></span>
<span id="cb223-2"><a href="visualizations-for-env-chem.html#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">==</span> <span class="st">&quot;NL&quot;</span>) <span class="co"># only nfld stations</span></span>
<span id="cb223-3"><a href="visualizations-for-env-chem.html#cb223-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-4"><a href="visualizations-for-env-chem.html#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Code from ggpubr website</span></span>
<span id="cb223-5"><a href="visualizations-for-env-chem.html#cb223-5" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggviolin</span>(nfld, <span class="at">x =</span> <span class="st">&quot;city&quot;</span>, <span class="at">y =</span> <span class="st">&quot;conc&quot;</span>) <span class="sc">+</span></span>
<span id="cb223-6"><a href="visualizations-for-env-chem.html#cb223-6" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">stat_compare_means</span>(<span class="at">ref.group =</span> <span class="st">&quot;St Johns&quot;</span>,</span>
<span id="cb223-7"><a href="visualizations-for-env-chem.html#cb223-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>,</span>
<span id="cb223-8"><a href="visualizations-for-env-chem.html#cb223-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label =</span> <span class="st">&quot;p.signif&quot;</span>) </span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
<p>Based on the results of our test, all other stations in Newfoundland have statistically significant differences in the median NO2 values. Note the validity of this statistical approach to this particular problem is called into question based on the distribution of the data etc. We’ve included it to demonstrate how to label significance on plots, rather than an explicit discussion on statistics.</p>
<p>For more information on <code>ggpubr</code>, adding p-values and significance labels, and different pairwise statistical test please visit <a href="http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/">ggpubr: Publication Ready Plots</a>.</p>
</div>
</div>
<div id="histograms" class="section level2" number="17.3">
<h2><span class="header-section-number">17.3</span> Histograms</h2>
<p>Histograms are an approximate representation of the distributions of numerical data. They’re an approximation because you arbitrarily “bin” your data into groups and then count the number of values inside that bin. The frequency, or count, in each bin is represented by the height of a rectangle whose width equals that of the bin. <code>geom_histogram()</code> is used to create histograms:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="visualizations-for-env-chem.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(atlNO2, <span class="at">city =</span> <span class="st">&quot;St Johns&quot;</span>), </span>
<span id="cb224-2"><a href="visualizations-for-env-chem.html#cb224-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc)) <span class="sc">+</span></span>
<span id="cb224-3"><a href="visualizations-for-env-chem.html#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb224-4"><a href="visualizations-for-env-chem.html#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Distribution of St. Johns&#39; NO2 levels in 2018&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-109-1.png" width="672" />
We can alter the resolution of our histogram by modifying the width of the bins using the <code>binwidth</code> argument or by specifying the number of bins with the <code>bins</code> argument. The former is useful when you don’t know the range of your data, whereas the latter is useful is you do (i.e. numbers between 0 and 100).</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="visualizations-for-env-chem.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(atlNO2, <span class="at">city =</span> <span class="st">&quot;St Johns&quot;</span>), </span>
<span id="cb226-2"><a href="visualizations-for-env-chem.html#cb226-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc)) <span class="sc">+</span></span>
<span id="cb226-3"><a href="visualizations-for-env-chem.html#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb226-4"><a href="visualizations-for-env-chem.html#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Distribution of St. Johns&#39; NO2 levels in 2018, binwidth = 1&quot;</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<div id="multiple-histograms" class="section level3" number="17.3.1">
<h3><span class="header-section-number">17.3.1</span> Multiple histograms</h3>
<p>While you can overlap histograms, it get’s difficult to read with more than a handful of datasets. If we wanted to plot histograms of all the cities in our dataset we would have to use a small multiple via the <code>facet_grid()</code> or <code>facet_wrap()</code> arguments. <code>facet_grid()</code> allows you to arrange many small plots on a grid defined by variables in your dataset (i.e. columns for provinces, and rows for different pollutants). In the example below we’ve used <code>facet_wrap(~city)</code> which creates a 2D layout of histograms of each cities NO<sub>2</sub> values. Note the tilde , <code>~</code>, preceding in <code>~city</code>.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="visualizations-for-env-chem.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atlNO2, </span>
<span id="cb227-2"><a href="visualizations-for-env-chem.html#cb227-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc, <span class="at">fill =</span> p)) <span class="sc">+</span> </span>
<span id="cb227-3"><a href="visualizations-for-env-chem.html#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb227-4"><a href="visualizations-for-env-chem.html#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>city)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
</div>
</div>
<div id="scatter-plots" class="section level2" number="17.4">
<h2><span class="header-section-number">17.4</span> Scatter plots</h2>
<p>Scatter plots display values of two variables, one of which is a <em>continuous</em> variable. Each data point ins plotted as an individual point on.You’ve already made scatter plots in the form of a time series during the Section 1 tutorial exercise. We’ve already touched upon scatter plots during the [Linear Regression] chapter where we also overlaid our linear model over our concentration points. So now we’ll touch upon some things you can do to improve your scatter plots.</p>
<div id="marginal-plots" class="section level3" number="17.4.1">
<h3><span class="header-section-number">17.4.1</span> Marginal plots</h3>
<p>You can easily combine a scatter plot with marginal plot. This is useful to summarize one dimension of our scatter plot. For example, let’s revisit the time series plot we made in <a href="r-coding-basics.html#r-coding-basics">R coding basics</a>. We might want to know the distribution of concentrations of the individual pollutants. using the <code>ggExtra</code> package and the <code>ggMarginal()</code> function we can get the following:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="visualizations-for-env-chem.html#cb228-1" aria-hidden="true" tabindex="-1"></a>torontoAir <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/2018-01-01_60430_Toronto_ON.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## -- Column specification --------------------------------------------------------
## cols(
##   naps = col_double(),
##   city = col_character(),
##   p = col_character(),
##   latitude = col_double(),
##   longitude = col_double(),
##   date.time = col_datetime(format = &quot;&quot;),
##   pollutant = col_character(),
##   concentration = col_double()
## )</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="visualizations-for-env-chem.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note we&#39;re storing our plot in the variable &#39;torPlot&#39;</span></span>
<span id="cb230-2"><a href="visualizations-for-env-chem.html#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and we&#39;re not plotting SO2</span></span>
<span id="cb230-3"><a href="visualizations-for-env-chem.html#cb230-3" aria-hidden="true" tabindex="-1"></a>torPlot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(torontoAir, pollutant <span class="sc">!=</span> <span class="st">&quot;SO2&quot;</span>), </span>
<span id="cb230-4"><a href="visualizations-for-env-chem.html#cb230-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> date.time,</span>
<span id="cb230-5"><a href="visualizations-for-env-chem.html#cb230-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> concentration,</span>
<span id="cb230-6"><a href="visualizations-for-env-chem.html#cb230-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> pollutant)) <span class="sc">+</span></span>
<span id="cb230-7"><a href="visualizations-for-env-chem.html#cb230-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb230-8"><a href="visualizations-for-env-chem.html#cb230-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb230-9"><a href="visualizations-for-env-chem.html#cb230-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-10"><a href="visualizations-for-env-chem.html#cb230-10" aria-hidden="true" tabindex="-1"></a><span class="co"># We&#39;re passing our torPlot to the ggMarginal Function</span></span>
<span id="cb230-11"><a href="visualizations-for-env-chem.html#cb230-11" aria-hidden="true" tabindex="-1"></a>ggExtra<span class="sc">::</span><span class="fu">ggMarginal</span>(torPlot, <span class="at">margins =</span> <span class="st">&quot;y&quot;</span>, <span class="at">groupColour =</span> <span class="cn">TRUE</span>, <span class="at">groupFill =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<p>We can now see the distributions of NO<sub>2</sub> and O<sub>3</sub> overlaid on the vertical axis. note that <code>ggMarginal()</code> only works with scatter plots.</p>
<p>There are plenty of other marginal options scatted about various packages. You can see many of them in action (with beautiful examples) at <a href="http://motioninsocial.com/tufte/#minimal-line-plot">Tufte in R</a> by Lukasz Piwek.</p>
</div>
</div>
<div id="plotting-for-publication" class="section level2" number="17.5">
<h2><span class="header-section-number">17.5</span> Plotting for publication</h2>
<p>Up until now we haven’t payed much attention to the explicit aesthetics of plots beyond what we needed for our exploratory analysis. However, many journals, publications, instructors, etc. will want plots to adhere to certain aesthetic standards. There’s scores of options to play with, so we recommend you consult the <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/master/data-visualization.pdf">ggplot2 Cheat Sheet</a>.</p>
<div id="plot-themes" class="section level3" number="17.5.1">
<h3><span class="header-section-number">17.5.1</span> Plot Themes</h3>
<p>Overall themes can be applied to ggplot. The simple and minimalist <code>theme_classic()</code> is satisfactory for most submissions, but you can peruse the available these in ggplot <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">here</a> or you can explore many more themes in the <a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/"><code>ggthemes</code> package</a>.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="visualizations-for-env-chem.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generating example plot to modify </span></span>
<span id="cb231-2"><a href="visualizations-for-env-chem.html#cb231-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> torPlot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> torontoAir, </span>
<span id="cb231-3"><a href="visualizations-for-env-chem.html#cb231-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> date.time,</span>
<span id="cb231-4"><a href="visualizations-for-env-chem.html#cb231-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> concentration,</span>
<span id="cb231-5"><a href="visualizations-for-env-chem.html#cb231-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> pollutant)) <span class="sc">+</span></span>
<span id="cb231-6"><a href="visualizations-for-env-chem.html#cb231-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb231-7"><a href="visualizations-for-env-chem.html#cb231-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-8"><a href="visualizations-for-env-chem.html#cb231-8" aria-hidden="true" tabindex="-1"></a><span class="co"># default theme</span></span>
<span id="cb231-9"><a href="visualizations-for-env-chem.html#cb231-9" aria-hidden="true" tabindex="-1"></a>default <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Default geom_scatter&quot;</span>)</span>
<span id="cb231-10"><a href="visualizations-for-env-chem.html#cb231-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-11"><a href="visualizations-for-env-chem.html#cb231-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-12"><a href="visualizations-for-env-chem.html#cb231-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Classic theme</span></span>
<span id="cb231-13"><a href="visualizations-for-env-chem.html#cb231-13" aria-hidden="true" tabindex="-1"></a>classic <span class="ot">&lt;-</span> p <span class="sc">+</span> </span>
<span id="cb231-14"><a href="visualizations-for-env-chem.html#cb231-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb231-15"><a href="visualizations-for-env-chem.html#cb231-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;theme_classic()&quot;</span>)</span>
<span id="cb231-16"><a href="visualizations-for-env-chem.html#cb231-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb231-17"><a href="visualizations-for-env-chem.html#cb231-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-18"><a href="visualizations-for-env-chem.html#cb231-18" aria-hidden="true" tabindex="-1"></a><span class="co"># arranging into grid</span></span>
<span id="cb231-19"><a href="visualizations-for-env-chem.html#cb231-19" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(default, classic, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
</div>
<div id="legends" class="section level3" number="17.5.2">
<h3><span class="header-section-number">17.5.2</span> Legends</h3>
<p>You can specify the position of the legend under the <code>theme()</code> option like such:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="visualizations-for-env-chem.html#cb232-1" aria-hidden="true" tabindex="-1"></a>bottom <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb232-2"><a href="visualizations-for-env-chem.html#cb232-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-3"><a href="visualizations-for-env-chem.html#cb232-3" aria-hidden="true" tabindex="-1"></a>inside <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">95</span>, .<span class="dv">95</span>))</span>
<span id="cb232-4"><a href="visualizations-for-env-chem.html#cb232-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-5"><a href="visualizations-for-env-chem.html#cb232-5" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(bottom, inside, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-114-1.png" width="672" />
Other legend positions include: “none,” “left,” “right,” “bottom,” “top,” or a two-element numeric vector to specify the location such as <code>c(0.95, 0.95)</code> for inside the top-right corner. <code>c(0.05, 0.05)</code> would place it inside the bottom right corner. Also note that <code>legend.position = "none"</code> will remove the legend entirely.</p>
</div>
<div id="modifying-labels" class="section level3" number="17.5.3">
<h3><span class="header-section-number">17.5.3</span> Modifying labels</h3>
<p>The labels generated for the plots are derived from the variable names passed along to the <code>ggplot()</code> function. Consequently, variable names that are easy to code become ugly labels on the plot. You can modify labels using the <code>labs()</code> function. Note in the example below that we changed the legend’s title by specifying what <code>aes()</code> option we used to create the legend; in the example below it’s <code>colour</code>.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="visualizations-for-env-chem.html#cb233-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Toronto Air quality&quot;</span>,</span>
<span id="cb233-2"><a href="visualizations-for-env-chem.html#cb233-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;from Jan 1st to 8th, 2018&quot;</span>, </span>
<span id="cb233-3"><a href="visualizations-for-env-chem.html#cb233-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb233-4"><a href="visualizations-for-env-chem.html#cb233-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Concentration (ppb)&quot;</span>,</span>
<span id="cb233-5"><a href="visualizations-for-env-chem.html#cb233-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">&quot;Pollutant&quot;</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-115-1.png" width="672" /></p>
</div>
<div id="modifying-axis" class="section level3" number="17.5.4">
<h3><span class="header-section-number">17.5.4</span> Modifying Axis</h3>
<p>We’ve already talked about labelling axis titles in <a href="visualizations-for-env-chem.html#modifying-labels">Modifying labels</a>, and adding marginal plots in <a href="visualizations-for-env-chem.html#scatter-plots">Scatter plots</a>. So we’ll just briefly touch upon some simple axis modifications.</p>
<div id="transforming-axix" class="section level4" number="17.5.4.1">
<h4><span class="header-section-number">17.5.4.1</span> Transforming axix</h4>
<p>Transformations are largely related to <em>continuous</em> data, and are done using <code>scale_y_continuous()</code> or <code>scale_x_continuous()</code> functions. For example to scale the y-axis of our plot we’d do the following:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="visualizations-for-env-chem.html#cb234-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span></span>
<span id="cb234-2"><a href="visualizations-for-env-chem.html#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="sc">+</span></span>
<span id="cb234-3"><a href="visualizations-for-env-chem.html#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Log10(concentration)&quot;</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
<p>Other useful transformations include “log2” for base-2 logs, “date” for dates, and “hms” for time. The later two are useful if R hasn’t correctly interpreted your dataset. The data type for the <code>data.time</code> column of our dataset was correctly interpreted during our initial importation using <code>read_csv()</code>. Hooray for doing it right the first time.</p>
</div>
<div id="limits" class="section level4" number="17.5.4.2">
<h4><span class="header-section-number">17.5.4.2</span> Limits</h4>
<p>The limits of plots created with <code>ggplot()</code> are automatically assigned, but you can override these using the <code>lims()</code> function. For example we can specify the limits of our example plot to show from 0 to 100 ppb:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="visualizations-for-env-chem.html#cb235-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-117-1.png" width="672" />
#### Axis ticks/labels</p>
<p>Sometimes when you are plotting, the length of the axis labels is unreadable. This is often the case with categorical data, such as the name of cities like we’ve encountered earlier. We addressed this earlier in [Bar charts] by rotating the plot 90<span class="math inline">\(^\circ\)</span> with the <code>coord_flip()</code> function. This is often the best solution as it’s how we read English. Another solution is to rotate the axis labels themselves:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="visualizations-for-env-chem.html#cb236-1" aria-hidden="true" tabindex="-1"></a>basePlot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(sumAtl, p <span class="sc">==</span> <span class="st">&quot;NL&quot;</span>),</span>
<span id="cb236-2"><a href="visualizations-for-env-chem.html#cb236-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> city, </span>
<span id="cb236-3"><a href="visualizations-for-env-chem.html#cb236-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb236-4"><a href="visualizations-for-env-chem.html#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb236-5"><a href="visualizations-for-env-chem.html#cb236-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-6"><a href="visualizations-for-env-chem.html#cb236-6" aria-hidden="true" tabindex="-1"></a>default <span class="ot">&lt;-</span> basePlot <span class="sc">+</span></span>
<span id="cb236-7"><a href="visualizations-for-env-chem.html#cb236-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;default plot&quot;</span>)</span>
<span id="cb236-8"><a href="visualizations-for-env-chem.html#cb236-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-9"><a href="visualizations-for-env-chem.html#cb236-9" aria-hidden="true" tabindex="-1"></a>flip <span class="ot">&lt;-</span> basePlot <span class="sc">+</span></span>
<span id="cb236-10"><a href="visualizations-for-env-chem.html#cb236-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb236-11"><a href="visualizations-for-env-chem.html#cb236-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;coord_flip()&quot;</span>)</span>
<span id="cb236-12"><a href="visualizations-for-env-chem.html#cb236-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-13"><a href="visualizations-for-env-chem.html#cb236-13" aria-hidden="true" tabindex="-1"></a>rotated <span class="ot">&lt;-</span> basePlot <span class="sc">+</span></span>
<span id="cb236-14"><a href="visualizations-for-env-chem.html#cb236-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>)) <span class="sc">+</span></span>
<span id="cb236-15"><a href="visualizations-for-env-chem.html#cb236-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;element_text(angle = 45)&quot;</span>)</span>
<span id="cb236-16"><a href="visualizations-for-env-chem.html#cb236-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-17"><a href="visualizations-for-env-chem.html#cb236-17" aria-hidden="true" tabindex="-1"></a>rotatedHJust <span class="ot">&lt;-</span> basePlot <span class="sc">+</span></span>
<span id="cb236-18"><a href="visualizations-for-env-chem.html#cb236-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb236-19"><a href="visualizations-for-env-chem.html#cb236-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;element_text(angle = 45, hjust = 1)&quot;</span>)</span>
<span id="cb236-20"><a href="visualizations-for-env-chem.html#cb236-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-21"><a href="visualizations-for-env-chem.html#cb236-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-22"><a href="visualizations-for-env-chem.html#cb236-22" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(default, flip, rotated, rotatedHJust, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="summarizing-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-regression-redux.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DavidRossHall/R4EnvChem/visualizations-redux.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R4EnvChem.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

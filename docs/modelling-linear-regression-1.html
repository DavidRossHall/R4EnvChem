<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Modelling: Linear Regression | R for Environmental Chemists</title>
  <meta name="description" content="This is a proof-of-concept for a further full length textbook." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Modelling: Linear Regression | R for Environmental Chemists" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://davidrosshall.github.io/R4EnvChem/" />
  
  <meta property="og:description" content="This is a proof-of-concept for a further full length textbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Modelling: Linear Regression | R for Environmental Chemists" />
  
  <meta name="twitter:description" content="This is a proof-of-concept for a further full length textbook." />
  

<meta name="author" content="David Hall, Steven Kutarna, Kristen Yeh, Hui Peng and Jessica D’eon" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visualizations-for-env-chem.html"/>
<link rel="next" href="non-linear-regression.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Environmental Chemistry</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#providing-feedback"><i class="fa fa-check"></i>Providing Feedback</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors"><i class="fa fa-check"></i>Authors</a></li>
</ul></li>
<li class="part"><span><b>Section 2: Data Analysis in R</b></span></li>
<li class="chapter" data-level="1" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html"><i class="fa fa-check"></i><b>1</b> Intro to Data Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#example-data"><i class="fa fa-check"></i><b>1.1</b> Example Data</a></li>
<li class="chapter" data-level="1.2" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#further-reading"><i class="fa fa-check"></i><b>1.2</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html"><i class="fa fa-check"></i><b>2</b> Modelling: Linear Regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#base-r-linear-model"><i class="fa fa-check"></i><b>2.1</b> Base R Linear Model</a></li>
<li class="chapter" data-level="2.2" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#cleaning-up-model-ouputs"><i class="fa fa-check"></i><b>2.2</b> Cleaning up model ouputs</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#why-we-approach-modelling-this-way"><i class="fa fa-check"></i><b>2.2.1</b> Why we approach modelling this way</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#visualizing-model"><i class="fa fa-check"></i><b>2.3</b> Visualizing model</a></li>
<li class="chapter" data-level="2.4" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#further-reading-1"><i class="fa fa-check"></i><b>2.4</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualizations.html"><a href="visualizations.html"><i class="fa fa-check"></i><b>3</b> Visualizations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualizations.html"><a href="visualizations.html#building-plots-ups"><i class="fa fa-check"></i><b>3.1</b> Building plots ups</a></li>
<li class="chapter" data-level="3.2" data-path="visualizations.html"><a href="visualizations.html#basic-plotting"><i class="fa fa-check"></i><b>3.2</b> Basic plotting</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="visualizations.html"><a href="visualizations.html#changing-plot-labels"><i class="fa fa-check"></i><b>3.2.1</b> Changing plot labels</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="visualizations.html"><a href="visualizations.html#further-reading-2"><i class="fa fa-check"></i><b>3.3</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>Section 3: Data Analysis Toolbox</b></span></li>
<li class="chapter" data-level="4" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>4</b> Introduction</a></li>
<li class="chapter" data-level="5" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>5</b> Summarizing data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="summarizing-data.html"><a href="summarizing-data.html#data-to-play-with"><i class="fa fa-check"></i><b>5.1</b> Data to play with</a></li>
<li class="chapter" data-level="5.2" data-path="summarizing-data.html"><a href="summarizing-data.html#summarizing-data-by-group"><i class="fa fa-check"></i><b>5.2</b> Summarizing data by group</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#further-sumarize-operations"><i class="fa fa-check"></i><b>5.2.1</b> Further sumarize operations</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="summarizing-data.html"><a href="summarizing-data.html#pretty-tables-with-flextable"><i class="fa fa-check"></i><b>5.3</b> Pretty tables with flextable</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#uniting-columns"><i class="fa fa-check"></i><b>5.3.1</b> Uniting columns</a></li>
<li class="chapter" data-level="5.3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#pretty-kables"><i class="fa fa-check"></i><b>5.3.2</b> Pretty kables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html"><i class="fa fa-check"></i><b>6</b> Visualizations for Env Chem</a>
<ul>
<li class="chapter" data-level="" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#discrete-vs.-continuous-variables"><i class="fa fa-check"></i>Discrete vs. continuous variables</a></li>
<li class="chapter" data-level="" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="6.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#bar-chart"><i class="fa fa-check"></i><b>6.1</b> Bar chart</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#adding-error-bars"><i class="fa fa-check"></i><b>6.1.1</b> Adding error bars</a></li>
<li class="chapter" data-level="6.1.2" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#ordering-bar-charts"><i class="fa fa-check"></i><b>6.1.2</b> Ordering bar charts</a></li>
<li class="chapter" data-level="6.1.3" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#grouping-bar-charts"><i class="fa fa-check"></i><b>6.1.3</b> Grouping bar charts</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#box-plots"><i class="fa fa-check"></i><b>6.2</b> Box Plots</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#box-plot-alternatives"><i class="fa fa-check"></i><b>6.2.1</b> Box plot alternatives</a></li>
<li class="chapter" data-level="6.2.2" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#statistical-comparisons-between-groups"><i class="fa fa-check"></i><b>6.2.2</b> Statistical comparisons between groups</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#histograms"><i class="fa fa-check"></i><b>6.3</b> Histograms</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#multiple-histograms"><i class="fa fa-check"></i><b>6.3.1</b> Multiple histograms</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#scatter-plots"><i class="fa fa-check"></i><b>6.4</b> Scatter plots</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#marginal-plots"><i class="fa fa-check"></i><b>6.4.1</b> Marginal plots</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#plotting-for-publication"><i class="fa fa-check"></i><b>6.5</b> Plotting for publication</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#plot-themes"><i class="fa fa-check"></i><b>6.5.1</b> Plot Themes</a></li>
<li class="chapter" data-level="6.5.2" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#legends"><i class="fa fa-check"></i><b>6.5.2</b> Legends</a></li>
<li class="chapter" data-level="6.5.3" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#modifying-labels"><i class="fa fa-check"></i><b>6.5.3</b> Modifying labels</a></li>
<li class="chapter" data-level="6.5.4" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#modifying-axis"><i class="fa fa-check"></i><b>6.5.4</b> Modifying Axis</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#arranging-plots"><i class="fa fa-check"></i><b>6.6</b> Arranging plots</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#anotating-plots"><i class="fa fa-check"></i><b>6.6.1</b> Anotating plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html"><i class="fa fa-check"></i><b>7</b> Modelling: Linear Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#modelling-theory"><i class="fa fa-check"></i><b>7.1</b> Modelling Theory</a></li>
<li class="chapter" data-level="7.2" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#modelling-in-r"><i class="fa fa-check"></i><b>7.2</b> Modelling in R</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#base-r-linear-model-1"><i class="fa fa-check"></i><b>7.2.1</b> Base R Linear Model</a></li>
<li class="chapter" data-level="7.2.2" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#cleaning-up-model-ouputs-1"><i class="fa fa-check"></i><b>7.2.2</b> Cleaning up model ouputs</a></li>
<li class="chapter" data-level="7.2.3" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#glanced-outputs"><i class="fa fa-check"></i><b>7.2.3</b> Glanced outputs</a></li>
<li class="chapter" data-level="7.2.4" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#tidied-outputs"><i class="fa fa-check"></i><b>7.2.4</b> Tidied outputs</a></li>
<li class="chapter" data-level="7.2.5" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#augmented-outputs"><i class="fa fa-check"></i><b>7.2.5</b> Augmented outputs</a></li>
<li class="chapter" data-level="7.2.6" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#why-we-approach-modelling-this-way-1"><i class="fa fa-check"></i><b>7.2.6</b> Why we approach modelling this way</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#visualizing-model-1"><i class="fa fa-check"></i><b>7.3</b> Visualizing model</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#vizualizing-residuals"><i class="fa fa-check"></i><b>7.3.1</b> Vizualizing residuals</a></li>
<li class="chapter" data-level="7.3.2" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#plotting-residuals"><i class="fa fa-check"></i><b>7.3.2</b> Plotting residuals</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#further-reading-3"><i class="fa fa-check"></i><b>7.4</b> Further reading</a></li>
<li class="chapter" data-level="7.5" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#going-deeper-with-modelling"><i class="fa fa-check"></i><b>7.5</b> Going deeper with modelling</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="modelling-linear-regression-1.html"><a href="modelling-linear-regression-1.html#weighing"><i class="fa fa-check"></i><b>7.5.1</b> Weighing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="non-linear-regression.html"><a href="non-linear-regression.html"><i class="fa fa-check"></i><b>8</b> Non-Linear Regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="non-linear-regression.html"><a href="non-linear-regression.html#visually-inspecting-our-data"><i class="fa fa-check"></i><b>8.1</b> Visually inspecting our data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="non-linear-regression.html"><a href="non-linear-regression.html#annotating-maximal-values"><i class="fa fa-check"></i><b>8.1.1</b> Annotating maximal values</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="non-linear-regression.html"><a href="non-linear-regression.html#extracting-maximal-values"><i class="fa fa-check"></i><b>8.2</b> Extracting maximal values</a></li>
<li class="chapter" data-level="8.3" data-path="non-linear-regression.html"><a href="non-linear-regression.html#modelling-sigmoidal-curve"><i class="fa fa-check"></i><b>8.3</b> Modelling Sigmoidal Curve</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="non-linear-regression.html"><a href="non-linear-regression.html#calculating-logistic-regression"><i class="fa fa-check"></i><b>8.3.1</b> Calculating Logistic Regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="non-linear-regression.html"><a href="non-linear-regression.html#extracting-model-parameters"><i class="fa fa-check"></i><b>8.3.2</b> Extracting model parameters</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Environmental Chemists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelling-linear-regression-1" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Modelling: Linear Regression</h1>
<p>Modelling is basically math used to describe some type of system, and they are a forte of R, a language tailor made for statistical computing… Every model has assumptions, limitations, and all around tricky bits to working. There is no shortage of modelling in a myriad of context, but in this chapter we’ll discuss and break down the most common model you’ll encounter, the <em>linear regression model</em>, in the most common context, the <em>linear calibration model</em>, using the most common funciton, <code>lm()</code>.</p>
<p>You have probably encountered the linear regression model under the pseudonmy “trendlines,” most likely geenrated by <em>Excel</em>’s “add trendline option” (as in CHM135). While the models we’ll be constructiong with <code>lm()</code> work much the same <em>mathematically</em>, unlike <em>Excel</em>, R returns <em>alllll</em> of the model outputs. Correspondingly, it’s easy to get lost between juggling R code, the seemingly endless model outputs, and keeping yourself grounded in the real systeyms you’re attempting to model.</p>
<p>To this end, this chapter is broken into the following parts:</p>
<ul>
<li><a href="modelling-linear-regression-1.html#modelling-theory">Modelling theory</a> where we briefly touch opon <em>what</em> model is being calculated.</li>
<li><a href="modelling-linear-regression-1.html#modelling-in-r">Modelling in R</a> where we provide a boilerplate template for <em>how</em> to calculate models in R.</li>
<li>[Understanding and Visualizing Models] where we explore our model results.</li>
<li>[Calculating Concentration] where we use our model to calculate the concentrion.</li>
</ul>
<div id="modelling-theory" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Modelling Theory</h2>
<p>The <em>linear calibration model</em> relates the response of an instrument to the value of the <em>measurand</em>. The measurand is simply what we’re measuring, often the concentration of an analyte. So we use the measurand, which we can control via preparation of standards from reference material as the <em>independent</em> variable, with the instrument output being the <em>dependent</em> variable (as instrument response varies with concentration). Altogether we’re:</p>
<ol style="list-style-type: decimal">
<li>Measuring the instrument response of standards of known concentration and samples of unknown concentration.</li>
<li>Calculating the linear calibratin model (i.e. line of best fit) through our standards.</li>
<li>Using the measurement model to calculate the concentration in our unknown from their respective instrument response.</li>
</ol>
<div class="figure"><span id="fig:reg-plot"></span>
<img src="R4EnvChem_files/figure-html/reg-plot-1.png" alt="Linear calibration model; figure modified from Hibbert and Gooding (2006)." width="672" />
<p class="caption">
Figure 7.1: Linear calibration model; figure modified from Hibbert and Gooding (2006).
</p>
</div>
<p>Before we can calculate concentrations, we need a measurement model. In other words, an equation that relates instrument response to sample concentration (or other factors). For simple linear calibration, we use:</p>
<p><span class="math display">\[ y = a + bx\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(y\)</span> is the instrument response</li>
<li><span class="math inline">\(x\)</span> is the independant variable (i.e. sample concentration)</li>
<li><span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are the coefficients of the model; otherwise known as intercept and slope, respectively.</li>
</ul>
<p>We’ll gloss over some of the more technical aspects of modelling, and discuss other in more detail below. For now, know that:</p>
<ul>
<li>We’re assuming our linear model is correct (i.e. the instruments actually responds linearly to concentration).</li>
<li>All uncertainties resies in the dependant variable <span class="math inline">\(y\)</span> (i.e. no errors in preparation of the standards).</li>
<li>The values of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are determined by minimizing the <em>sum of the residuals squared</em>.
<ul>
<li>The residuals are the difference between the actual measured response and wehre it would be if it were on the calibration line.</li>
</ul></li>
</ul>
<p>Once we have our line of best fit, we can calculate the concentration of our unknown sample <span class="math inline">\(i\)</span>, from it’s measured response <span class="math inline">\(y_i\)</span> by:</p>
<p><span class="math display">\[ x_i = \frac{y_i ~-~b}{a}\]</span></p>
<p>There is more going on under the hood then what we’re describbing here, but this should be enough to get you up and running. If you would like a greater breakdown of linear calibration modelling, we suggest you read Chapter 5 of <em>Data Analysis for Chemistry</em> by Hibbert and Gooding. An online version is accessible via the Univerity of Toronto’s Library. Also there is no reason the instrument response must be linear. In fact, we spend a great deal of time arranging our experiment to that we land in the ‘linear range.’ For details on non-linear modelling in R see <a href="non-linear-regression.html#non-linear-regression">Non-Linear Regression</a></p>
</div>
<div id="modelling-in-r" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Modelling in R</h2>
<p>Now that we have a rough understanding of what we’re trying to do, let’s go over <em>how</em> to calcualte linear regression models in R. Note model is a general term, in this situation we’ll be calculating a <strong>calibration curve</strong>. All calibration curves are models, but not all models are calibration curves.</p>
<p>For our example dataset we’ll import a dataset consisting of four analytical standards of sodium plus a calibration blank all run in triplicate. The standards were measured via flame atomic emission spectroscopy (FAES). Let’s import the FAES calibration results we saw in [Transform: dplyr and data manipulation]. As we’ve already seen, our data is composed of four standards and a blank analyzed in triplicate. Since we’re focusing on modelling, <em>we’ll treat the blank as a standard in our model fitting</em>.
So let’s import our dataset:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="modelling-linear-regression-1.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing using tips from Import chapter</span></span>
<span id="cb1-2"><a href="modelling-linear-regression-1.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="modelling-linear-regression-1.html#cb1-3" aria-hidden="true" tabindex="-1"></a>FAES <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">&quot;data/FAESdata.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="modelling-linear-regression-1.html#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>std_Na_conc,</span>
<span id="cb1-5"><a href="modelling-linear-regression-1.html#cb1-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;replicate&quot;</span>, </span>
<span id="cb1-6"><a href="modelling-linear-regression-1.html#cb1-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;reading_&quot;</span>,</span>
<span id="cb1-7"><a href="modelling-linear-regression-1.html#cb1-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;signal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-8"><a href="modelling-linear-regression-1.html#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> std_Na_conc,</span>
<span id="cb1-9"><a href="modelling-linear-regression-1.html#cb1-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;type&quot;</span>, <span class="st">&quot;conc_Na&quot;</span>, <span class="st">&quot;units&quot;</span>),</span>
<span id="cb1-10"><a href="modelling-linear-regression-1.html#cb1-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">&quot; &quot;</span>,</span>
<span id="cb1-11"><a href="modelling-linear-regression-1.html#cb1-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-12"><a href="modelling-linear-regression-1.html#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">&quot;standard&quot;</span>)</span>
<span id="cb1-13"><a href="modelling-linear-regression-1.html#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="modelling-linear-regression-1.html#cb1-14" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(FAES)</span></code></pre></div>
<div id="htmlwidget-49d141d895905d999285" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-49d141d895905d999285">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard"],[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>type<\/th>\n      <th>conc_Na<\/th>\n      <th>units<\/th>\n      <th>replicate<\/th>\n      <th>signal<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>And let’s quickly plot our data. You should always visualize your data before modelling, especially for linear calibration modelling. Unlike <em>statistical</em> modelling. Vizualing your data is the easiest way to spot trends and gross errors in your data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="modelling-linear-regression-1.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FAES,</span>
<span id="cb2-2"><a href="modelling-linear-regression-1.html#cb2-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc_Na, </span>
<span id="cb2-3"><a href="modelling-linear-regression-1.html#cb2-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> signal)) <span class="sc">+</span></span>
<span id="cb2-4"><a href="modelling-linear-regression-1.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div id="base-r-linear-model-1" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Base R Linear Model</h3>
<p>R’s base <code>lm()</code> function for linear regression is excellent, but it’s outputs have some messy quirks. It’s easier to show that, so let’s calculate the linear relationship between the <code>signal</code> as a function of <code>conc_Na</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="modelling-linear-regression-1.html#cb3-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(signal <span class="sc">~</span> conc_Na, <span class="at">data =</span> FAES)</span>
<span id="cb3-2"><a href="modelling-linear-regression-1.html#cb3-2" aria-hidden="true" tabindex="-1"></a>lm_fit</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = signal ~ conc_Na, data = FAES)
## 
## Coefficients:
## (Intercept)      conc_Na  
##        2615        29707</code></pre>
<p>Reading the code above (recall that we’re reading it from <em>right to left</em> because it’s base R):</p>
<ol style="list-style-type: decimal">
<li>We’re taking the FAES data we created earlier; <code>data = FAES</code></li>
<li>We’re comparing <code>signal</code> (the dependent, y, variable) to <code>conc_Na</code> (the independent, x, variable) via the tilde <code>~</code>. The way to read this is: <em>“Signal depends on concentration”</em>.</li>
<li>We’re comparing these two variables using the <code>lm()</code> function for generalized linear models.</li>
<li>All of the model outputs are stored in the <code>lm_fit</code> variable.</li>
</ol>
<p>As we can see, the model outputs are pretty brief and not much more than <em>Excel</em>’s outputs. We can use <code>summary()</code> to extract more information to better understand our model:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="modelling-linear-regression-1.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = signal ~ conc_Na, data = FAES)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2112.78 -1528.53    70.51   821.50  2718.20 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2615.1      665.2   3.931  0.00172 ** 
## conc_Na      29707.2     1304.5  22.772 7.34e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1824 on 13 degrees of freedom
## Multiple R-squared:  0.9755, Adjusted R-squared:  0.9737 
## F-statistic: 518.6 on 1 and 13 DF,  p-value: 7.341e-12</code></pre>
<p>Now we have a lot more information from our model (don’t worry about what everything means, it’s discussed further in Section 3. For now, understand that it’s a hot mess.</p>
</div>
<div id="cleaning-up-model-ouputs-1" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Cleaning up model ouputs</h3>
<p><code>summary()</code> provides a decent overview of our model’s performance, but the outputs are difficult to work with. Let’s turn to the <code>broom()</code> package to clean up our model outputs.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="modelling-linear-regression-1.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb7-2"><a href="modelling-linear-regression-1.html#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="modelling-linear-regression-1.html#cb7-3" aria-hidden="true" tabindex="-1"></a>calCurve <span class="ot">&lt;-</span> FAES <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="modelling-linear-regression-1.html#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="modelling-linear-regression-1.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="modelling-linear-regression-1.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(signal <span class="sc">~</span> conc_Na, <span class="at">data =</span> .x)),</span>
<span id="cb7-7"><a href="modelling-linear-regression-1.html#cb7-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(fit, tidy),</span>
<span id="cb7-8"><a href="modelling-linear-regression-1.html#cb7-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(fit, glance),</span>
<span id="cb7-9"><a href="modelling-linear-regression-1.html#cb7-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">augmented =</span> <span class="fu">map</span>(fit, augment)</span>
<span id="cb7-10"><a href="modelling-linear-regression-1.html#cb7-10" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb7-11"><a href="modelling-linear-regression-1.html#cb7-11" aria-hidden="true" tabindex="-1"></a>calCurve</span></code></pre></div>
<pre><code>## # A tibble: 1 x 6
## # Groups:   type [1]
##   type     data            fit    tidied         glanced         augmented      
##   &lt;chr&gt;    &lt;list&gt;          &lt;list&gt; &lt;list&gt;         &lt;list&gt;          &lt;list&gt;         
## 1 standard &lt;tibble [15 x ~ &lt;lm&gt;   &lt;tibble [2 x ~ &lt;tibble [1 x 1~ &lt;tibble [15 x ~</code></pre>
<p>Things look a bit more complicated than our earlier example, so let’s break down our code line by line:</p>
<ol style="list-style-type: decimal">
<li>We’re taking the <code>FAES</code> dataset that we created earlier.</li>
<li><code>group_by(type)</code> groups all rows by <code>type</code>, in this situation we have only one type: <code>standard</code>.</li>
<li><code>nest()</code> collapses everything other than the <code>type</code> column into smaller dataframes. In this situation, all other information is stored as a <code>tibble</code> under the <code>data</code> column; this is the data used to calculate the linear model.</li>
<li>Withing the <code>mutate</code> function, we’ve created four columns: <code>fit</code>, <code>tidied</code>, <code>glanced</code>, and <code>augmented</code>.</li>
</ol>
<p>And it’s these columns that contain our cleaned up model outputs. <code>fit</code> contains the raw output from the linear regression model for <code>signal</code> as a function of <code>conc_Na</code> using the <code>lm()</code> function. The output is in the form of a list, similar to what <code>summary()</code> gave us above. Again, this is exceptionally messy, hence why we used the <code>tidy()</code>, <code>glance()</code>, and <code>augment()</code> functions from the <code>broom</code> package . <code>map()</code> just means we’re applying the function <code>tidy()</code> to the individual output list created by <code>lm()</code> and stored in the <code>fit</code> column. Note that the <code>tidy()</code>, <code>glanced()</code>, and <code>augmented</code> outputs are tibbles. So we now have a tibble containing specific model output values (i.e. <code>(Intercept)</code>), lists (i.e. <code>fit</code>), and tibbles (<code>tidied</code>). This is known as **nested data*. We’re no longer in Kansas anymore…</p>
<p>We’ll break down what each function did below. Keep in mind however that <code>lm()</code> is used for a variety of statistical tests, and consequently has many assoscaited outputs. Some are essential, others are useful, and some are useless for linear calibration. There are also many ways to use these additional model ouputs to calcualte outliers, etc. but you shouldn’t have any outliers in your calibration model. Don’t rely on statistics to bail you out of poor chemical technique.</p>
</div>
<div id="glanced-outputs" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Glanced outputs</h3>
<p>Anyways, let’s take a look at our model results. The <code>glanced</code> tibble contains “…a concise one-row summary of the model. This typically contains values such as R^2, adjusted R^2, and residual standard error that are computed once for the entire mode”[^linear-regression-1] Because the data is nested, we’ll need to use <code>unnest()</code> to flatten it back out into regular columns:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="modelling-linear-regression-1.html#cb9-1" aria-hidden="true" tabindex="-1"></a>glanced <span class="ot">&lt;-</span> calCurve <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="modelling-linear-regression-1.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced)</span>
<span id="cb9-3"><a href="modelling-linear-regression-1.html#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="modelling-linear-regression-1.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># DT is to make interactive tables for the book.</span></span>
<span id="cb9-5"><a href="modelling-linear-regression-1.html#cb9-5" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(glanced, </span>
<span id="cb9-6"><a href="modelling-linear-regression-1.html#cb9-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-242e9d0e099898a41eca" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-242e9d0e099898a41eca">{"x":{"filter":"none","data":[["1"],["standard"],[{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]}],[{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}}],[{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]}],[0.97554405684884],[0.973662830452597],[1824.49550164636],[518.568131298315],[7.34136427734617e-12],[1],[-132.846703525965],[271.69340705193],[273.817557655237],[43274189.8618612],[13],[15],[{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],".fitted":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],".resid":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895706,67.7219358895709,81.6022358895707,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067485,-1524.59608834356,-1485.76568834356,-1532.46298834356],".hat":[0.132924335378323,0.132924335378323,0.132924335378323,0.101226993865031,0.101226993865031,0.101226993865031,0.0797546012269938,0.0797546012269938,0.0797546012269938,0.0766871165644172,0.0766871165644172,0.0766871165644172,0.276073619631902,0.276073619631902,0.276073619631902],".sigma":[1782.46163668191,1792.40688772048,1791.28426955355,1898.87376608049,1898.88315991191,1898.83255703024,1882.22283642461,1883.43702369471,1884.60151525631,1714.44630933863,1721.01555011448,1719.26274669082,1827.18762677432,1830.86607653877,1826.42990681136],".cooksd":[0.118545101068118,0.108721086887008,0.10983275666137,9.35679566599039e-05,8.63255667509451e-05,0.000125338596339971,0.00990699202624536,0.00919275145802792,0.00850731147887237,0.0998323868643691,0.0964537658351039,0.0973565126360697,0.183920490448031,0.174671143521548,0.185823443067267],".std.resid":[-1.24360670078708,-1.190962646706,-1.19703593962396,0.040761993067928,0.0391526856217498,0.0471774270160556,0.478145263401568,0.460587036576349,0.44308303125866,1.55047214605552,1.52401006601312,1.53112534571032,-0.982120559987251,-0.957106633686311,-0.987188291888465]}]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>type<\/th>\n      <th>data<\/th>\n      <th>fit<\/th>\n      <th>tidied<\/th>\n      <th>r.squared<\/th>\n      <th>adj.r.squared<\/th>\n      <th>sigma<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>df<\/th>\n      <th>logLik<\/th>\n      <th>AIC<\/th>\n      <th>BIC<\/th>\n      <th>deviance<\/th>\n      <th>df.residual<\/th>\n      <th>nobs<\/th>\n      <th>augmented<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[5,6,7,8,9,10,11,12,13,14,15,16]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>What you see here is a bit more than what you’d get from <em>Excel</em>’s ‘line-of-best fit’ output. In brief, :</p>
<ul>
<li><code>type</code>, <code>data</code>, <code>fit</code>, <code>tidied</code>, and <code>augmented</code> are columns we’ve created earlier.</li>
<li><code>r.squared</code> is a statistical mesure of fit that indicates how muich variation of a depdendent bvariable is explained by the independent variable. The closer <code>r.squared</code> is to 1, the more variance is captured by the model.</li>
<li><code>adj.r.squared</code> is the same as <code>r.squared</code> in this situation. This is because <code>r.squared</code> will always increase if we add more exploratory variables to our model; the <code>adj.r.squared</code> accounts for the number of exploratory variables used in the model.
<ul>
<li>In our case we only have one exploratory variable, hence they’re aproximately the same.</li>
</ul></li>
<li>The other columns are different measurements of goodness-of-fit and hypothesis testing of the model. See <a href="modelling-linear-regression-1.html#further-reading-3">Further reading</a>.</li>
</ul>
</div>
<div id="tidied-outputs" class="section level3" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Tidied outputs</h3>
<p>But what about the slope and the intercept? After all, that’s what we need to calculate the concentration in our unknowns. Let’s take a look at <code>tidied</code> from the <code>tidy()</code> function which constructs a tibble that summarizes the model’s statistical findings. This includes coefficients and p-values for each term in a regression:]</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="modelling-linear-regression-1.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># storing because we&#39;ll use it later on. </span></span>
<span id="cb10-2"><a href="modelling-linear-regression-1.html#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="modelling-linear-regression-1.html#cb10-3" aria-hidden="true" tabindex="-1"></a>tidied <span class="ot">&lt;-</span> calCurve <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="modelling-linear-regression-1.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied)</span>
<span id="cb10-5"><a href="modelling-linear-regression-1.html#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="modelling-linear-regression-1.html#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># DT is to make interactive tables for the book.</span></span>
<span id="cb10-7"><a href="modelling-linear-regression-1.html#cb10-7" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(tidied, </span>
<span id="cb10-8"><a href="modelling-linear-regression-1.html#cb10-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-73a6ea1db3df36b000d2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-73a6ea1db3df36b000d2">{"x":{"filter":"none","data":[["1","2"],["standard","standard"],[{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]}],[{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}}],["(Intercept)","conc_Na"],[2615.11945030675,29707.1701380368],[665.188979881384,1304.54291870848],[3.93139322718947,22.7720910611721],[0.00172095293125651,7.34136427734617e-12],[{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]}],[{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],".fitted":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],".resid":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895706,67.7219358895709,81.6022358895707,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067485,-1524.59608834356,-1485.76568834356,-1532.46298834356],".hat":[0.132924335378323,0.132924335378323,0.132924335378323,0.101226993865031,0.101226993865031,0.101226993865031,0.0797546012269938,0.0797546012269938,0.0797546012269938,0.0766871165644172,0.0766871165644172,0.0766871165644172,0.276073619631902,0.276073619631902,0.276073619631902],".sigma":[1782.46163668191,1792.40688772048,1791.28426955355,1898.87376608049,1898.88315991191,1898.83255703024,1882.22283642461,1883.43702369471,1884.60151525631,1714.44630933863,1721.01555011448,1719.26274669082,1827.18762677432,1830.86607653877,1826.42990681136],".cooksd":[0.118545101068118,0.108721086887008,0.10983275666137,9.35679566599039e-05,8.63255667509451e-05,0.000125338596339971,0.00990699202624536,0.00919275145802792,0.00850731147887237,0.0998323868643691,0.0964537658351039,0.0973565126360697,0.183920490448031,0.174671143521548,0.185823443067267],".std.resid":[-1.24360670078708,-1.190962646706,-1.19703593962396,0.040761993067928,0.0391526856217498,0.0471774270160556,0.478145263401568,0.460587036576349,0.44308303125866,1.55047214605552,1.52401006601312,1.53112534571032,-0.982120559987251,-0.957106633686311,-0.987188291888465]},{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],".fitted":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],".resid":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895706,67.7219358895709,81.6022358895707,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067485,-1524.59608834356,-1485.76568834356,-1532.46298834356],".hat":[0.132924335378323,0.132924335378323,0.132924335378323,0.101226993865031,0.101226993865031,0.101226993865031,0.0797546012269938,0.0797546012269938,0.0797546012269938,0.0766871165644172,0.0766871165644172,0.0766871165644172,0.276073619631902,0.276073619631902,0.276073619631902],".sigma":[1782.46163668191,1792.40688772048,1791.28426955355,1898.87376608049,1898.88315991191,1898.83255703024,1882.22283642461,1883.43702369471,1884.60151525631,1714.44630933863,1721.01555011448,1719.26274669082,1827.18762677432,1830.86607653877,1826.42990681136],".cooksd":[0.118545101068118,0.108721086887008,0.10983275666137,9.35679566599039e-05,8.63255667509451e-05,0.000125338596339971,0.00990699202624536,0.00919275145802792,0.00850731147887237,0.0998323868643691,0.0964537658351039,0.0973565126360697,0.183920490448031,0.174671143521548,0.185823443067267],".std.resid":[-1.24360670078708,-1.190962646706,-1.19703593962396,0.040761993067928,0.0391526856217498,0.0471774270160556,0.478145263401568,0.460587036576349,0.44308303125866,1.55047214605552,1.52401006601312,1.53112534571032,-0.982120559987251,-0.957106633686311,-0.987188291888465]}]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>type<\/th>\n      <th>data<\/th>\n      <th>fit<\/th>\n      <th>term<\/th>\n      <th>estimate<\/th>\n      <th>std.error<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>glanced<\/th>\n      <th>augmented<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[5,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Again, a lot more to unpack compared to <em>Excel</em>. That’s because the <code>lm()</code> function in R calculates a generalized linear model. <code>lm()</code> performs a linear regression model, which we normally think of as an equation of the form <span class="math inline">\(y= a + bx\)</span> as discussed earlier. But, regression models can be expanded to account for multiple variables (hence <em>multiple linear regression</em>) of the form:</p>
<p><span class="math display">\[y = \beta _{0} + \beta _{1} x_{1} + \beta _{2} x_{2} ... \beta _{p} x_{p}\]</span>]</p>
<p>where,</p>
<ul>
<li><span class="math inline">\(y\)</span> = dependent variable</li>
<li><span class="math inline">\(x\)</span> = exploratory variable; there’s no limit how many you can input</li>
<li><span class="math inline">\(\beta _{0}\)</span> = y-intercept (constant term)</li>
<li><span class="math inline">\(\beta _{p}\)</span> = slope coefficient for each explanatory variable</li>
</ul>
<p>With our linear calibration model, we only have one input variable for our model (<code>conc</code>), so the above formula collapses down to <span class="math inline">\(y = \beta _{0} + \beta _{1} x_{1}\)</span>. So looking at our tidied model outputs:</p>
<ul>
<li>each row corresponds to a model coefficient (under the <code>term</code> column).</li>
<li>For each modelling parameter, we’re provided an estimate of it’s numerical value: <code>estimate</code>. These are the values we’ll use to calculate concentration.</li>
<li><code>std.error</code> measures how precicely the model estimates the coefficient’s unknown value; smaller is better.</li>
<li><code>p.value</code> is a indication of the significance of a model coefficient; the closer to zero the better.
<ul>
<li>If we were to use multiple parameters in our model (eg. concentration and temprature) we could use the <code>p.value</code> to determine if a given coefficient was useful for our model.</li>
</ul></li>
</ul>
<p>We can extract the value of the model coefficients for subsequent calculations as follows:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="modelling-linear-regression-1.html#cb11-1" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tidied[<span class="dv">1</span>,<span class="dv">5</span>])</span>
<span id="cb11-2"><a href="modelling-linear-regression-1.html#cb11-2" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tidied[<span class="dv">2</span>,<span class="dv">5</span>])</span>
<span id="cb11-3"><a href="modelling-linear-regression-1.html#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="modelling-linear-regression-1.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;The equation of our calibration curve is: y = &quot;</span>, slope, <span class="st">&quot;x + &quot;</span>, intercept, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The equation of our calibration curve is: y = 29707.1701380368x + 2615.11945030675&quot;</code></pre>
</div>
<div id="augmented-outputs" class="section level3" number="7.2.5">
<h3><span class="header-section-number">7.2.5</span> Augmented outputs</h3>
<p>Finally let’s take a look at the outputs of the <code>augment</code> function:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="modelling-linear-regression-1.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># storing because we&#39;ll use it later on. </span></span>
<span id="cb13-2"><a href="modelling-linear-regression-1.html#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="modelling-linear-regression-1.html#cb13-3" aria-hidden="true" tabindex="-1"></a>augmented <span class="ot">&lt;-</span> calCurve <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="modelling-linear-regression-1.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(augmented)</span>
<span id="cb13-5"><a href="modelling-linear-regression-1.html#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="modelling-linear-regression-1.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># DT is to make interactive tables for the book.</span></span>
<span id="cb13-7"><a href="modelling-linear-regression-1.html#cb13-7" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(augmented, </span>
<span id="cb13-8"><a href="modelling-linear-regression-1.html#cb13-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-f132465e28feaeeb137d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f132465e28feaeeb137d">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard"],[{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]}],[{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.11945030675,29707.1701380368],"residuals":[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895713,67.7219358895715,81.6022358895714,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067484,-1524.59608834356,-1485.76568834356,-1532.46298834356],"effects":[-51548.2491541052,41547.5777041897,-1330.08835094244,679.712183812707,676.928583812707,690.808883812707,1351.70421856786,1320.97331856786,1290.33731856786,2949.94282283331,2903.55102283331,2916.02512283331,-1764.68030339093,-1725.84990339093,-1772.54720339093],"rank":2,"fitted.values":[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],"assign":[0,1],"qr":{"qr":[[-3.87298334620742,-1.39427400463467],[0.258198889747161,1.39857069896377],[0.258198889747161,0.204582639687241],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.133081070210566],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,0.061579500733891],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.152925207696135],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511],[0.258198889747161,-0.510433055079511]],"qraux":[1.25819888974716,1.20458263968724],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}}],[{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.11945030675,29707.1701380368],"std.error":[665.188979881384,1304.54291870848],"statistic":[3.93139322718947,22.7720910611721],"p.value":[0.00172095293125651,7.34136427734617e-12]}],[{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]},{"r.squared":[0.97554405684884],"adj.r.squared":[0.973662830452597],"sigma":[1824.49550164636],"statistic":[518.568131298315],"p.value":[7.34136427734617e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.817557655237],"deviance":[43274189.8618612],"df.residual":[13],"nobs":[15]}],[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.6858,9332.0498,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],[2615.11945030675,2615.11945030675,2615.11945030675,5585.83646411043,5585.83646411043,5585.83646411043,8556.55347791411,8556.55347791411,8556.55347791411,17468.7045193252,17468.7045193252,17468.7045193252,32322.2895883436,32322.2895883436,32322.2895883436],[-2112.78035030675,-2023.34265030675,-2033.66065030675,70.5055358895706,67.7219358895709,81.6022358895707,836.863222085889,806.132322085889,775.49632208589,2718.19878067485,2671.80698067485,2684.28108067485,-1524.59608834356,-1485.76568834356,-1532.46298834356],[0.132924335378323,0.132924335378323,0.132924335378323,0.101226993865031,0.101226993865031,0.101226993865031,0.0797546012269938,0.0797546012269938,0.0797546012269938,0.0766871165644172,0.0766871165644172,0.0766871165644172,0.276073619631902,0.276073619631902,0.276073619631902],[1782.46163668191,1792.40688772048,1791.28426955355,1898.87376608049,1898.88315991191,1898.83255703024,1882.22283642461,1883.43702369471,1884.60151525631,1714.44630933863,1721.01555011448,1719.26274669082,1827.18762677432,1830.86607653877,1826.42990681136],[0.118545101068118,0.108721086887008,0.10983275666137,9.35679566599039e-05,8.63255667509451e-05,0.000125338596339971,0.00990699202624536,0.00919275145802792,0.00850731147887237,0.0998323868643691,0.0964537658351039,0.0973565126360697,0.183920490448031,0.174671143521548,0.185823443067267],[-1.24360670078708,-1.190962646706,-1.19703593962396,0.040761993067928,0.0391526856217498,0.0471774270160556,0.478145263401568,0.460587036576349,0.44308303125866,1.55047214605552,1.52401006601312,1.53112534571032,-0.982120559987251,-0.957106633686311,-0.987188291888465]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>type<\/th>\n      <th>data<\/th>\n      <th>fit<\/th>\n      <th>tidied<\/th>\n      <th>glanced<\/th>\n      <th>signal<\/th>\n      <th>conc_Na<\/th>\n      <th>.fitted<\/th>\n      <th>.resid<\/th>\n      <th>.hat<\/th>\n      <th>.sigma<\/th>\n      <th>.cooksd<\/th>\n      <th>.std.resid<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>As you can see, <code>augment()</code> adds columns to the orignal data that was modeled. For our purposes we’re interested:</p>
<ul>
<li><code>signal</code> and <code>conc_Na</code>, the original data used in our model.</li>
<li><code>.fitted</code>, the predicted value of the point according to our calcualted model.</li>
<li><code>.resid</code>, the residiuals of that point (different between measured and fitted values.)</li>
<li>The other parameters are different measuremmtns of the influence of each point on the model fitting. They can be used to detect outliers; see <a href="modelling-linear-regression-1.html#further-reading-3">Further reading</a></li>
</ul>
</div>
<div id="why-we-approach-modelling-this-way-1" class="section level3" number="7.2.6">
<h3><span class="header-section-number">7.2.6</span> Why we approach modelling this way</h3>
<p>You may be wondering why we’ve seemingly overcomplicated a simple enough procedure. Fair enough, we’ve showcased an analysis with a simple data set. However, as you progress in your studies you’ll be quantifying <em>many</em> compounds, often at the same time in the same instrument runs. If you organize your data in a tidy format, you can plot calibration curves for <em>all</em> of your compounds with the same block of code. Essentially you use <code>group_by()</code> to group your data by compound/element. Subsequently, the same code is expandable from 1 compound to as many as you can ever hope to quantify in one shot. So for upper year labs where you’re analyzing tens of compounds (<em>cough</em> CHM410 Dust Lab) you can generate calibration curves for all your compounds at once.</p>
</div>
</div>
<div id="visualizing-model-1" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Visualizing model</h2>
<p>At the top of the chapter we plotted out standards to visualize a linear trend. Visualizations is an essential component when calculating calibration curves, and indeed our standards apepared to follow a linear trend, which was corroborated by the model we calculated above. However, for publications/reports you’ll need to create a plot with both your standards <em>and</em> model with the displayed equation, so below is a bit of stock code you can use as a starting point to create these plots. Note that it requires the <code>ggpmisc</code> package to display the equation:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="modelling-linear-regression-1.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FAES,</span>
<span id="cb14-2"><a href="modelling-linear-regression-1.html#cb14-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc_Na, </span>
<span id="cb14-3"><a href="modelling-linear-regression-1.html#cb14-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> signal)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="modelling-linear-regression-1.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-5"><a href="modelling-linear-regression-1.html#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb14-6"><a href="modelling-linear-regression-1.html#cb14-6" aria-hidden="true" tabindex="-1"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_poly_eq</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="co"># formula uses aesthetic names</span></span>
<span id="cb14-7"><a href="modelling-linear-regression-1.html#cb14-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">rr.digits =</span> <span class="dv">4</span>, <span class="co"># reported digits of r-squared</span></span>
<span id="cb14-8"><a href="modelling-linear-regression-1.html#cb14-8" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..eq.label.., ..rr.label.., <span class="at">sep =</span> <span class="st">&quot;~~~&quot;</span>)), </span>
<span id="cb14-9"><a href="modelling-linear-regression-1.html#cb14-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) </span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div id="vizualizing-residuals" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Vizualizing residuals</h3>
<p>As stated earlier, residuals are the difference between measured and fitted values. They’re often overlooked in linear calibration and folks are hot to plot a straight line through their data. This has the unintended effect of fooling your eyes into thinking your data is linear. Consequently, it is always a good idea to plot the residuals of your model as this will magnify any trends or discrepencies of your calibration model. A good linear model will have the residuals randomly distributed about zero. Other examples of patterns in residuals are shown below:</p>
<div class="figure"><span id="fig:unnamed-chunk-8"></span>
<img src="R4EnvChem_files/figure-html/unnamed-chunk-8-1.png" alt="Example residual patterns; figure adapted from Hibbert and Gooding (2006). " width="672" />
<p class="caption">
Figure 7.2: Example residual patterns; figure adapted from Hibbert and Gooding (2006).
</p>
</div>
<ul>
<li>Normally distrubuted residuals is satisfactory for linear modelling. Note the relatieyl small magnitute of the reisudals.</li>
<li>Curvatuyre throught range results from an isntrument become saturated. Consequently, the linear model will ‘cut’ thourgh the curve. This is a good indication that you’ll need to either breakdown your calibration curve into two or more parts or utilize a non-linear model.</li>
<li>Heteroscedasticity means the variance of the response is proportional to the concentration. This is often the case in instrumental analysis. See <a href="modelling-linear-regression-1.html#weighing">Weighing</a> below.</li>
<li>Outliers shouldn’t exist in your calibration plot, nevertheless, a plot of residuals can readily highlight an outlier point.</li>
</ul>
</div>
<div id="plotting-residuals" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Plotting residuals</h3>
<p>To plot residuals, we use our <code>augmented</code> dataset from above, and simply create a plot of the independant variable vs. the residuals. Here we plot the FAES calibration model and it’s residuals. Note that the residuals indicate curbature throughout the range. We may have over extended our calibration range <em>outisde</em> of the linear range of our instrument.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="modelling-linear-regression-1.html#cb16-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> FAES,</span>
<span id="cb16-2"><a href="modelling-linear-regression-1.html#cb16-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc_Na, </span>
<span id="cb16-3"><a href="modelling-linear-regression-1.html#cb16-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> signal)) <span class="sc">+</span></span>
<span id="cb16-4"><a href="modelling-linear-regression-1.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-5"><a href="modelling-linear-regression-1.html#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb16-6"><a href="modelling-linear-regression-1.html#cb16-6" aria-hidden="true" tabindex="-1"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_poly_eq</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="co"># formula uses aesthetic names</span></span>
<span id="cb16-7"><a href="modelling-linear-regression-1.html#cb16-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">rr.digits =</span> <span class="dv">4</span>, <span class="co"># reported digits of r-squared</span></span>
<span id="cb16-8"><a href="modelling-linear-regression-1.html#cb16-8" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..eq.label.., ..rr.label.., <span class="at">sep =</span> <span class="st">&quot;~~~&quot;</span>)), </span>
<span id="cb16-9"><a href="modelling-linear-regression-1.html#cb16-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) </span>
<span id="cb16-10"><a href="modelling-linear-regression-1.html#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="modelling-linear-regression-1.html#cb16-11" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> augmented, </span>
<span id="cb16-12"><a href="modelling-linear-regression-1.html#cb16-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc_Na, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb16-13"><a href="modelling-linear-regression-1.html#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb16-14"><a href="modelling-linear-regression-1.html#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="modelling-linear-regression-1.html#cb16-15" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(a, b, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="figure"><span id="fig:unnamed-chunk-9"></span>
<img src="R4EnvChem_files/figure-html/unnamed-chunk-9-1.png" alt="(A) linear calibration model and (B) plot of model residuals." width="672" />
<p class="caption">
Figure 7.3: (A) linear calibration model and (B) plot of model residuals.
</p>
</div>
</div>
</div>
<div id="further-reading-3" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Further reading</h2>
<p>As previously stated, we highly recomend reading Chapter 5: Calibration from <em>Data Analysis for Chemistry</em> by Hibbert and Gooding for a more in-depth discussion of linear calibration modelling. The book can be accessed online via the University of Toronto’s Library.</p>
<p>For a greater disucssion on modelling in R, see <a href="https://r4ds.had.co.nz/model-intro.html">Modelling</a> in <a href="https://r4ds.had.co.nz/index.html"><em>R for Data Science</em></a>.</p>
</div>
<div id="going-deeper-with-modelling" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Going deeper with modelling</h2>
<div id="weighing" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Weighing</h3>
<p>As shown above, you’ll often find that your calibration data is <em>heteroscedastic</em>, meaning the variance increases with the concentration. This leads to <em>leverage</em> of your line-of-best fit, as it is ‘pulled’ by one way or another by the higher concentration standards then the lower. You can assign ‘weights’ (how much a point impacts the model) in R, although you’ll need to justify the validity of your approach. A common approach however, is to weight each standard by <span class="math inline">\(\frac{1}{x^2}\)</span>. This ensures that samples with higher concentration impact the line less, and vice-versa weith low-concentration standards.</p>
<p>To utilize weight in R, we need to calculate the weigh prior to modelling, and subsequently specify the weights column</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="modelling-linear-regression-1.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note that our blank has a concentration of 0, hence infinite weight. </span></span>
<span id="cb18-2"><a href="modelling-linear-regression-1.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we need to remove it to weight our data. </span></span>
<span id="cb18-3"><a href="modelling-linear-regression-1.html#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="modelling-linear-regression-1.html#cb18-4" aria-hidden="true" tabindex="-1"></a>FAESweighed <span class="ot">&lt;-</span> FAES <span class="sc">%&gt;%</span> </span>
<span id="cb18-5"><a href="modelling-linear-regression-1.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(conc_Na <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="modelling-linear-regression-1.html#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wght =</span> <span class="dv">1</span><span class="sc">/</span>(conc_Na<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb18-7"><a href="modelling-linear-regression-1.html#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="modelling-linear-regression-1.html#cb18-8" aria-hidden="true" tabindex="-1"></a>weightedCalCurve <span class="ot">&lt;-</span> FAESweighed <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="modelling-linear-regression-1.html#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="modelling-linear-regression-1.html#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="modelling-linear-regression-1.html#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(signal <span class="sc">~</span> conc_Na, <span class="at">data =</span> .x, <span class="at">weights =</span> wght)),</span>
<span id="cb18-12"><a href="modelling-linear-regression-1.html#cb18-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(fit, tidy),</span>
<span id="cb18-13"><a href="modelling-linear-regression-1.html#cb18-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(fit, glance),</span>
<span id="cb18-14"><a href="modelling-linear-regression-1.html#cb18-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">augmented =</span> <span class="fu">map</span>(fit, augment)</span>
<span id="cb18-15"><a href="modelling-linear-regression-1.html#cb18-15" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="modelling-linear-regression-1.html#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(augmented)</span>
<span id="cb18-17"><a href="modelling-linear-regression-1.html#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="modelling-linear-regression-1.html#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> weightedCalCurve, </span>
<span id="cb18-19"><a href="modelling-linear-regression-1.html#cb18-19" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc_Na, <span class="at">y =</span> signal)) <span class="sc">+</span></span>
<span id="cb18-20"><a href="modelling-linear-regression-1.html#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-21"><a href="modelling-linear-regression-1.html#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se=</span>F, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">label =</span> <span class="st">&quot;unweighed&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-22"><a href="modelling-linear-regression-1.html#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se=</span>F, <span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb18-23"><a href="modelling-linear-regression-1.html#cb18-23" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">weight=</span><span class="st">`</span><span class="at">(weights)</span><span class="st">`</span>, <span class="at">label =</span> <span class="st">&quot;weighed&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: label</code></pre>
<pre><code>## Warning: Ignoring unknown aesthetics: label</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="visualizations-for-env-chem.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="non-linear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DavidRossHall/R4EnvChem/linear-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R4EnvChem.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

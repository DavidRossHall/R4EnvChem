<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 20 Augmented Outputs and Evaluating Your Model | R for Environmental Chemistry</title>
  <meta name="description" content="This is a proof-of-concept for a further full length textbook." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 20 Augmented Outputs and Evaluating Your Model | R for Environmental Chemistry" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a proof-of-concept for a further full length textbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 20 Augmented Outputs and Evaluating Your Model | R for Environmental Chemistry" />
  
  <meta name="twitter:description" content="This is a proof-of-concept for a further full length textbook." />
  

<meta name="author" content="David Hall, Steven Kutarna, Kristen Yeh, Hui Peng, Chaerin Song, and Jessica D’eon" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelling-linear-regression.html"/>
<link rel="next" href="modelling-non-linear-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.32/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Environmental Chemistry</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#providing-feedback"><i class="fa fa-check"></i>Providing Feedback</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowlegements"><i class="fa fa-check"></i>Acknowlegements</a></li>
</ul></li>
<li class="part"><span><b>Part 1: Getting Started in R</b></span></li>
<li class="chapter" data-level="1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Intro to R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#r-language"><i class="fa fa-check"></i><b>1.1</b> R Language</a></li>
<li class="chapter" data-level="1.2" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#setting-up-your-environment"><i class="fa fa-check"></i><b>1.3</b> Setting Up Your Environment</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#working-remotely-recommended-for-coursework"><i class="fa fa-check"></i><b>1.3.1</b> Working Remotely (Recommended for Coursework)</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#working-locally"><i class="fa fa-check"></i><b>1.3.2</b> Working Locally</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#using-rstudio"><i class="fa fa-check"></i><b>1.4</b> Using RStudio</a></li>
<li class="chapter" data-level="1.5" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#running-r-code"><i class="fa fa-check"></i><b>1.5</b> Running R Code</a></li>
<li class="chapter" data-level="1.6" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#customizing-rstudio"><i class="fa fa-check"></i><b>1.6</b> Customizing RStudio</a></li>
<li class="chapter" data-level="1.7" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#where-to-get-help"><i class="fa fa-check"></i><b>1.7</b> Where to get help</a></li>
<li class="chapter" data-level="1.8" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#summary"><i class="fa fa-check"></i><b>1.8</b> Summary</a></li>
<li class="chapter" data-level="1.9" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#exercise"><i class="fa fa-check"></i><b>1.9</b> Exercise</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#setup"><i class="fa fa-check"></i><b>1.9.1</b> Setup</a></li>
<li class="chapter" data-level="1.9.2" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#basic-r-commands"><i class="fa fa-check"></i><b>1.9.2</b> Basic R Commands</a></li>
<li class="chapter" data-level="1.9.3" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#using-the-help-command"><i class="fa fa-check"></i><b>1.9.3</b> Using the Help Command (<code>?</code>)</a></li>
<li class="chapter" data-level="1.9.4" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#reflection"><i class="fa fa-check"></i><b>1.9.4</b> Reflection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio-projects.html"><a href="rstudio-projects.html"><i class="fa fa-check"></i><b>2</b> RStudio Projects</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rstudio-projects.html"><a href="rstudio-projects.html#uploading-files-to-rstudio-server-on-jupyterhub"><i class="fa fa-check"></i><b>2.1</b> Uploading Files to RStudio server on JupyterHub</a></li>
<li class="chapter" data-level="2.2" data-path="rstudio-projects.html"><a href="rstudio-projects.html#paths-and-directories"><i class="fa fa-check"></i><b>2.2</b> Paths and Directories</a></li>
<li class="chapter" data-level="2.3" data-path="rstudio-projects.html"><a href="rstudio-projects.html#importing-a-project"><i class="fa fa-check"></i><b>2.3</b> Importing a Project</a></li>
<li class="chapter" data-level="2.4" data-path="rstudio-projects.html"><a href="rstudio-projects.html#creating-an-rstudio-project"><i class="fa fa-check"></i><b>2.4</b> Creating an RStudio Project</a></li>
<li class="chapter" data-level="2.5" data-path="rstudio-projects.html"><a href="rstudio-projects.html#a-sneak-peek-at-.rmd-files"><i class="fa fa-check"></i><b>2.5</b> A Sneak Peek at <code>.Rmd</code> Files</a></li>
<li class="chapter" data-level="2.6" data-path="rstudio-projects.html"><a href="rstudio-projects.html#summary-1"><i class="fa fa-check"></i><b>2.6</b> Summary</a></li>
<li class="chapter" data-level="2.7" data-path="rstudio-projects.html"><a href="rstudio-projects.html#exercise-1"><i class="fa fa-check"></i><b>2.7</b> Exercise</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="rstudio-projects.html"><a href="rstudio-projects.html#get-started"><i class="fa fa-check"></i><b>2.7.1</b> Get Started</a></li>
<li class="chapter" data-level="2.7.2" data-path="rstudio-projects.html"><a href="rstudio-projects.html#confirm-your-working-directory"><i class="fa fa-check"></i><b>2.7.2</b> Confirm Your Working Directory</a></li>
<li class="chapter" data-level="2.7.3" data-path="rstudio-projects.html"><a href="rstudio-projects.html#creating-your-own-project"><i class="fa fa-check"></i><b>2.7.3</b> Creating Your Own Project</a></li>
<li class="chapter" data-level="2.7.4" data-path="rstudio-projects.html"><a href="rstudio-projects.html#create-your-rmd-file"><i class="fa fa-check"></i><b>2.7.4</b> Create Your Rmd File</a></li>
<li class="chapter" data-level="2.7.5" data-path="rstudio-projects.html"><a href="rstudio-projects.html#upload-a-file-from-your-computer"><i class="fa fa-check"></i><b>2.7.5</b> Upload a file from your computer</a></li>
<li class="chapter" data-level="2.7.6" data-path="rstudio-projects.html"><a href="rstudio-projects.html#reflection-1"><i class="fa fa-check"></i><b>2.7.6</b> Reflection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html"><i class="fa fa-check"></i><b>3</b> How to Use This Textbook</a>
<ul>
<li class="chapter" data-level="3.1" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#useful-features"><i class="fa fa-check"></i><b>3.1</b> Useful Features</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#searching-the-textbook"><i class="fa fa-check"></i><b>3.1.1</b> Searching the Textbook</a></li>
<li class="chapter" data-level="3.1.2" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#original-r-markdown-of-the-textbook-chapters"><i class="fa fa-check"></i><b>3.1.2</b> Original R Markdown of the Textbook Chapters</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#end-of-chapter-exercises"><i class="fa fa-check"></i><b>3.2</b> End-of-Chapter Exercises</a></li>
</ul></li>
<li class="part"><span><b>Part 2: How to Code in R</b></span></li>
<li class="chapter" data-level="4" data-path="r-coding-basics.html"><a href="r-coding-basics.html"><i class="fa fa-check"></i><b>4</b> R Coding Basics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#variables"><i class="fa fa-check"></i><b>4.1</b> Variables</a></li>
<li class="chapter" data-level="4.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-types"><i class="fa fa-check"></i><b>4.2</b> Data Types</a></li>
<li class="chapter" data-level="4.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-structures"><i class="fa fa-check"></i><b>4.3</b> Data Structures</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-frames"><i class="fa fa-check"></i><b>4.3.1</b> Data Frames</a></li>
<li class="chapter" data-level="4.3.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#accessing-data-in-subfolders"><i class="fa fa-check"></i><b>4.3.2</b> Accessing Data in Subfolders</a></li>
<li class="chapter" data-level="4.3.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#other-data-structures"><i class="fa fa-check"></i><b>4.3.3</b> Other Data Structures</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="r-coding-basics.html"><a href="r-coding-basics.html#conditional-statements"><i class="fa fa-check"></i><b>4.4</b> Conditional Statements</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#understanding-r-syntax"><i class="fa fa-check"></i><b>4.4.1</b> Understanding R Syntax</a></li>
<li class="chapter" data-level="4.4.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#the-basic-if-statement"><i class="fa fa-check"></i><b>4.4.2</b> The Basic <code>if</code> Statement</a></li>
<li class="chapter" data-level="4.4.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#expanding-with-else-and-else-if"><i class="fa fa-check"></i><b>4.4.3</b> Expanding with <code>else</code> and <code>else if</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="r-coding-basics.html"><a href="r-coding-basics.html#r-built-in-functions"><i class="fa fa-check"></i><b>4.5</b> R built-in Functions</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#exploring-more-built-in-functions"><i class="fa fa-check"></i><b>4.5.1</b> Exploring More Built-In Functions</a></li>
<li class="chapter" data-level="4.5.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#function-documentation"><i class="fa fa-check"></i><b>4.5.2</b> Function Documentation</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="r-coding-basics.html"><a href="r-coding-basics.html#summary-2"><i class="fa fa-check"></i><b>4.6</b> Summary</a></li>
<li class="chapter" data-level="4.7" data-path="r-coding-basics.html"><a href="r-coding-basics.html#exercise-2"><i class="fa fa-check"></i><b>4.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html"><i class="fa fa-check"></i><b>5</b> Workflows for R Coding</a>
<ul>
<li class="chapter" data-level="5.1" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#creating-or-opening-an-r-markdown-document"><i class="fa fa-check"></i><b>5.1</b> Creating or opening an R Markdown document</a></li>
<li class="chapter" data-level="5.2" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#workspace-and-whats-real"><i class="fa fa-check"></i><b>5.2</b> Workspace and What’s Real</a></li>
<li class="chapter" data-level="5.3" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#saving-r-markdown"><i class="fa fa-check"></i><b>5.3</b> Saving R Markdown</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#what-should-i-save"><i class="fa fa-check"></i><b>5.3.1</b> What Should I Save?</a></li>
<li class="chapter" data-level="5.3.2" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#saving-data-frames"><i class="fa fa-check"></i><b>5.3.2</b> Saving Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#script-formatting"><i class="fa fa-check"></i><b>5.4</b> Script formatting</a></li>
<li class="chapter" data-level="5.5" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#viewing-data-and-code-simultaneously"><i class="fa fa-check"></i><b>5.5</b> Viewing Data and Code Simultaneously</a></li>
<li class="chapter" data-level="5.6" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#troubleshooting-error-messages"><i class="fa fa-check"></i><b>5.6</b> Troubleshooting Error Messages</a></li>
<li class="chapter" data-level="5.7" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#summary-3"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
<li class="chapter" data-level="5.8" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#exercise-3"><i class="fa fa-check"></i><b>5.8</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="using-r-markdown.html"><a href="using-r-markdown.html"><i class="fa fa-check"></i><b>6</b> Using R Markdown</a>
<ul>
<li class="chapter" data-level="6.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#getting-started-with-r-markdown"><i class="fa fa-check"></i><b>6.1</b> Getting Started with R Markdown</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#understanding-r-markdown"><i class="fa fa-check"></i><b>6.1.1</b> Understanding R Markdown</a></li>
<li class="chapter" data-level="6.1.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#running-code-in-r-markdown"><i class="fa fa-check"></i><b>6.1.2</b> Running Code in R Markdown</a></li>
<li class="chapter" data-level="6.1.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#headings-and-subheadings"><i class="fa fa-check"></i><b>6.1.3</b> Headings and Subheadings</a></li>
<li class="chapter" data-level="6.1.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#latex-basics"><i class="fa fa-check"></i><b>6.1.4</b> LaTeX Basics</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#compiling-your-final-report"><i class="fa fa-check"></i><b>6.2</b> Compiling your final report</a></li>
<li class="chapter" data-level="6.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#authoring-with-r-markdown"><i class="fa fa-check"></i><b>6.3</b> Authoring with R Markdown</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-markdown-syntax"><i class="fa fa-check"></i><b>6.3.1</b> R Markdown Syntax</a></li>
<li class="chapter" data-level="6.3.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-code-chunk-options"><i class="fa fa-check"></i><b>6.3.2</b> R Code Chunk Options</a></li>
<li class="chapter" data-level="6.3.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#inserting-images"><i class="fa fa-check"></i><b>6.3.3</b> Inserting images</a></li>
<li class="chapter" data-level="6.3.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#generating-tables"><i class="fa fa-check"></i><b>6.3.4</b> Generating tables</a></li>
<li class="chapter" data-level="6.3.5" data-path="using-r-markdown.html"><a href="using-r-markdown.html#spellcheck-in-r-markdown"><i class="fa fa-check"></i><b>6.3.5</b> Spellcheck in R Markdown</a></li>
<li class="chapter" data-level="6.3.6" data-path="using-r-markdown.html"><a href="using-r-markdown.html#exporting-r-markdown-documents"><i class="fa fa-check"></i><b>6.3.6</b> Exporting R Markdown documents</a></li>
<li class="chapter" data-level="6.3.7" data-path="using-r-markdown.html"><a href="using-r-markdown.html#rstudio-tips-and-tricks"><i class="fa fa-check"></i><b>6.3.7</b> RStudio tips and tricks</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-markdown-resources"><i class="fa fa-check"></i><b>6.4</b> R Markdown resources</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>7</b> R Packages</a>
<ul>
<li class="chapter" data-level="7.1" data-path="r-packages.html"><a href="r-packages.html#what-are-r-packages"><i class="fa fa-check"></i><b>7.1</b> What are R packages?</a></li>
<li class="chapter" data-level="7.2" data-path="r-packages.html"><a href="r-packages.html#how-to-use-r-packages"><i class="fa fa-check"></i><b>7.2</b> How to use R packages</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="r-packages.html"><a href="r-packages.html#how-to-install-packages"><i class="fa fa-check"></i><b>7.2.1</b> How to install packages</a></li>
<li class="chapter" data-level="7.2.2" data-path="r-packages.html"><a href="r-packages.html#how-to-load-packages"><i class="fa fa-check"></i><b>7.2.2</b> How to load packages</a></li>
<li class="chapter" data-level="7.2.3" data-path="r-packages.html"><a href="r-packages.html#calling-specific-functions"><i class="fa fa-check"></i><b>7.2.3</b> Calling specific functions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="r-packages.html"><a href="r-packages.html#tidyverse-the-golden-toolbox-of-r"><i class="fa fa-check"></i><b>7.3</b> Tidyverse: The Golden Toolbox of R</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="r-packages.html"><a href="r-packages.html#loading-the-tidyverse"><i class="fa fa-check"></i><b>7.3.1</b> Loading the Tidyverse</a></li>
<li class="chapter" data-level="7.3.2" data-path="r-packages.html"><a href="r-packages.html#data-visualization"><i class="fa fa-check"></i><b>7.3.2</b> Data Visualization</a></li>
<li class="chapter" data-level="7.3.3" data-path="r-packages.html"><a href="r-packages.html#data-manipulation"><i class="fa fa-check"></i><b>7.3.3</b> Data Manipulation</a></li>
<li class="chapter" data-level="7.3.4" data-path="r-packages.html"><a href="r-packages.html#efficient-data-reading"><i class="fa fa-check"></i><b>7.3.4</b> Efficient Data Reading</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="r-packages.html"><a href="r-packages.html#summary-4"><i class="fa fa-check"></i><b>7.4</b> Summary</a></li>
<li class="chapter" data-level="7.5" data-path="r-packages.html"><a href="r-packages.html#exercise-4"><i class="fa fa-check"></i><b>7.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="loops-and-functions-in-r.html"><a href="loops-and-functions-in-r.html"><i class="fa fa-check"></i><b>8</b> Loops and Functions in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="loops-and-functions-in-r.html"><a href="loops-and-functions-in-r.html#loops"><i class="fa fa-check"></i><b>8.1</b> Loops</a></li>
<li class="chapter" data-level="8.2" data-path="loops-and-functions-in-r.html"><a href="loops-and-functions-in-r.html#writing-custom-functions-in-r"><i class="fa fa-check"></i><b>8.2</b> Writing custom functions in R</a></li>
<li class="chapter" data-level="8.3" data-path="loops-and-functions-in-r.html"><a href="loops-and-functions-in-r.html#further_reading_chapter8"><i class="fa fa-check"></i><b>8.3</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>Part 3: Data Analysis in R</b></span></li>
<li class="chapter" data-level="9" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html"><i class="fa fa-check"></i><b>9</b> Intro to Data Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#example-data"><i class="fa fa-check"></i><b>9.1</b> Example Data</a></li>
<li class="chapter" data-level="9.2" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#sneak-peek-at-data-analysis"><i class="fa fa-check"></i><b>9.2</b> Sneak Peek at Data Analysis</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#setting-up"><i class="fa fa-check"></i><b>9.2.1</b> Setting Up</a></li>
<li class="chapter" data-level="9.2.2" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#tidying-our-data"><i class="fa fa-check"></i><b>9.2.2</b> Tidying Our Data</a></li>
<li class="chapter" data-level="9.2.3" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#investigating-storm-patterns"><i class="fa fa-check"></i><b>9.2.3</b> Investigating Storm Patterns</a></li>
<li class="chapter" data-level="9.2.4" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#visualization-geographical-distribution"><i class="fa fa-check"></i><b>9.2.4</b> Visualization: Geographical Distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#further_reading_chapter9"><i class="fa fa-check"></i><b>9.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html"><i class="fa fa-check"></i><b>10</b> Importing Your Data Into R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#csv-files"><i class="fa fa-check"></i><b>10.1</b> csv files</a></li>
<li class="chapter" data-level="10.2" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#read_csv"><i class="fa fa-check"></i><b>10.2</b> <code>read_csv</code></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#tibbles-vs.-data-frames"><i class="fa fa-check"></i><b>10.2.1</b> Tibbles vs. data frames</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#importing-other-data-types"><i class="fa fa-check"></i><b>10.3</b> Importing other data types</a></li>
<li class="chapter" data-level="10.4" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#saving-data"><i class="fa fa-check"></i><b>10.4</b> Saving data</a></li>
<li class="chapter" data-level="10.5" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#further_reading_chapter10"><i class="fa fa-check"></i><b>10.5</b> Further Reading</a></li>
<li class="chapter" data-level="10.6" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#exercise-5"><i class="fa fa-check"></i><b>10.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="tidying-your-data.html"><a href="tidying-your-data.html"><i class="fa fa-check"></i><b>11</b> Tidying Your Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="tidying-your-data.html"><a href="tidying-your-data.html#what-is-tidy-data"><i class="fa fa-check"></i><b>11.1</b> What is tidy data?</a></li>
<li class="chapter" data-level="11.2" data-path="tidying-your-data.html"><a href="tidying-your-data.html#tools-to-tidy-your-data"><i class="fa fa-check"></i><b>11.2</b> Tools to tidy your data</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="tidying-your-data.html"><a href="tidying-your-data.html#selection-helpers"><i class="fa fa-check"></i><b>11.2.1</b> Selection helpers</a></li>
<li class="chapter" data-level="11.2.2" data-path="tidying-your-data.html"><a href="tidying-your-data.html#separating-columns"><i class="fa fa-check"></i><b>11.2.2</b> Separating columns</a></li>
<li class="chapter" data-level="11.2.3" data-path="tidying-your-data.html"><a href="tidying-your-data.html#unitingcombining-columns"><i class="fa fa-check"></i><b>11.2.3</b> Uniting/combining columns</a></li>
<li class="chapter" data-level="11.2.4" data-path="tidying-your-data.html"><a href="tidying-your-data.html#renaming-columnsheaders"><i class="fa fa-check"></i><b>11.2.4</b> Renaming columns/headers</a></li>
<li class="chapter" data-level="11.2.5" data-path="tidying-your-data.html"><a href="tidying-your-data.html#chaining-multiple-operations"><i class="fa fa-check"></i><b>11.2.5</b> Chaining multiple operations</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="tidying-your-data.html"><a href="tidying-your-data.html#tips-for-recording-data"><i class="fa fa-check"></i><b>11.3</b> Tips for recording data</a></li>
<li class="chapter" data-level="11.4" data-path="tidying-your-data.html"><a href="tidying-your-data.html#further_reading_chapter11"><i class="fa fa-check"></i><b>11.4</b> Further reading</a></li>
<li class="chapter" data-level="11.5" data-path="tidying-your-data.html"><a href="tidying-your-data.html#chapter-references"><i class="fa fa-check"></i><b>11.5</b> Chapter References</a></li>
<li class="chapter" data-level="11.6" data-path="tidying-your-data.html"><a href="tidying-your-data.html#exercise-6"><i class="fa fa-check"></i><b>11.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html"><i class="fa fa-check"></i><b>12</b> Transform: Data Manipulation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#selecting-by-row-or-value"><i class="fa fa-check"></i><b>12.1</b> Selecting by row or value</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#logical-operators"><i class="fa fa-check"></i><b>12.1.1</b> Logical operators</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#arranging-rows"><i class="fa fa-check"></i><b>12.2</b> Arranging rows</a></li>
<li class="chapter" data-level="12.3" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#selecting-column-name"><i class="fa fa-check"></i><b>12.3</b> Selecting column name</a></li>
<li class="chapter" data-level="12.4" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#deleting-columns-or-rows"><i class="fa fa-check"></i><b>12.4</b> Deleting Columns or Rows</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#deleting-columns"><i class="fa fa-check"></i><b>12.4.1</b> Deleting columns</a></li>
<li class="chapter" data-level="12.4.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#deleting-rows"><i class="fa fa-check"></i><b>12.4.2</b> Deleting rows</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#adding-new-variables"><i class="fa fa-check"></i><b>12.5</b> Adding new variables</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#mutate-with-a-condition"><i class="fa fa-check"></i><b>12.5.1</b> Mutate with a condition</a></li>
<li class="chapter" data-level="12.5.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#useful-mutate-function"><i class="fa fa-check"></i><b>12.5.2</b> Useful mutate function</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#group-and-summarize-data"><i class="fa fa-check"></i><b>12.6</b> Group and summarize data</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#useful-summarize-functions"><i class="fa fa-check"></i><b>12.6.1</b> Useful summarize functions</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#the-pipe-chaining-functions-together"><i class="fa fa-check"></i><b>12.7</b> The Pipe: Chaining Functions Together</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#notes-on-piping"><i class="fa fa-check"></i><b>12.7.1</b> Notes on piping</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#further_reading_chapter12"><i class="fa fa-check"></i><b>12.8</b> Further reading</a></li>
<li class="chapter" data-level="12.9" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#exercise-7"><i class="fa fa-check"></i><b>12.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html"><i class="fa fa-check"></i><b>13</b> Ggplot Basic Visualizations</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#building-plots-ups"><i class="fa fa-check"></i><b>13.1</b> Building plots ups</a></li>
<li class="chapter" data-level="13.2" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#basic-plotting"><i class="fa fa-check"></i><b>13.2</b> Basic plotting</a></li>
<li class="chapter" data-level="13.3" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#changing-plot-labels"><i class="fa fa-check"></i><b>13.3</b> Changing plot labels</a></li>
<li class="chapter" data-level="13.4" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#small-multiples"><i class="fa fa-check"></i><b>13.4</b> Small Multiples</a></li>
<li class="chapter" data-level="13.5" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#plotting-subsets-of-data"><i class="fa fa-check"></i><b>13.5</b> Plotting subsets of data</a></li>
<li class="chapter" data-level="13.6" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#exercise-8"><i class="fa fa-check"></i><b>13.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>14</b> Summarizing Data</a>
<ul>
<li class="chapter" data-level="14.1" data-path="summarizing-data.html"><a href="summarizing-data.html#data-to-play-with"><i class="fa fa-check"></i><b>14.1</b> Data to Play With</a></li>
<li class="chapter" data-level="14.2" data-path="summarizing-data.html"><a href="summarizing-data.html#summarizing-data-by-group"><i class="fa fa-check"></i><b>14.2</b> Summarizing Data by Group</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#further-summarize-operations"><i class="fa fa-check"></i><b>14.2.1</b> Further Summarize Operations</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="summarizing-data.html"><a href="summarizing-data.html#pretty-tables-with-flextable"><i class="fa fa-check"></i><b>14.3</b> Pretty Tables with Flextable</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#uniting-columns"><i class="fa fa-check"></i><b>14.3.1</b> Uniting columns</a></li>
<li class="chapter" data-level="14.3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#pretty-tables"><i class="fa fa-check"></i><b>14.3.2</b> Pretty tables</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="summarizing-data.html"><a href="summarizing-data.html#exercise-9"><i class="fa fa-check"></i><b>14.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html"><i class="fa fa-check"></i><b>15</b> Restructuring Your Data</a>
<ul>
<li class="chapter" data-level="15.1" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#long-vs-wide-data"><i class="fa fa-check"></i><b>15.1</b> Long vs Wide Data</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#long-data"><i class="fa fa-check"></i><b>15.1.1</b> Long Data</a></li>
<li class="chapter" data-level="15.1.2" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#wide-data"><i class="fa fa-check"></i><b>15.1.2</b> Wide Data</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#making-data-longer"><i class="fa fa-check"></i><b>15.2</b> Making Data Longer</a></li>
<li class="chapter" data-level="15.3" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#making-data-wider"><i class="fa fa-check"></i><b>15.3</b> Making Data Wider</a></li>
<li class="chapter" data-level="15.4" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#summary-5"><i class="fa fa-check"></i><b>15.4</b> Summary</a></li>
<li class="chapter" data-level="15.5" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#further_reading_chapter15"><i class="fa fa-check"></i><b>15.5</b> Further reading</a></li>
<li class="chapter" data-level="15.6" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#exercise-10"><i class="fa fa-check"></i><b>15.6</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>Part 4: Visualization in R</b></span></li>
<li class="chapter" data-level="16" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html"><i class="fa fa-check"></i><b>16</b> Visualizations for Env Chem</a>
<ul>
<li class="chapter" data-level="16.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#discrete-vs.-continuous-variables"><i class="fa fa-check"></i><b>16.1</b> Discrete vs. Continuous variables</a></li>
<li class="chapter" data-level="16.2" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#prerequisites"><i class="fa fa-check"></i><b>16.2</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html"><i class="fa fa-check"></i><b>17</b> Common Types of Graphs</a>
<ul>
<li class="chapter" data-level="17.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#bar-charts"><i class="fa fa-check"></i><b>17.1</b> Bar Charts</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#adding-error-bars"><i class="fa fa-check"></i><b>17.1.1</b> Adding Error Bars</a></li>
<li class="chapter" data-level="17.1.2" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#ordering-bar-charts"><i class="fa fa-check"></i><b>17.1.2</b> Ordering Bar Charts</a></li>
<li class="chapter" data-level="17.1.3" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#grouping-bar-charts"><i class="fa fa-check"></i><b>17.1.3</b> Grouping Bar Charts</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#box-plots"><i class="fa fa-check"></i><b>17.2</b> Box Plots</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#violin-plots"><i class="fa fa-check"></i><b>17.2.1</b> Violin Plots</a></li>
<li class="chapter" data-level="17.2.2" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#statistical-comparisons-between-groups"><i class="fa fa-check"></i><b>17.2.2</b> Statistical Comparisons Between Groups</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#histograms"><i class="fa fa-check"></i><b>17.3</b> Histograms</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#multiple-histograms"><i class="fa fa-check"></i><b>17.3.1</b> Multiple histograms</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#scatter-plots"><i class="fa fa-check"></i><b>17.4</b> Scatter Plots</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#marginal-plots"><i class="fa fa-check"></i><b>17.4.1</b> Marginal plots</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#exercise-11"><i class="fa fa-check"></i><b>17.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html"><i class="fa fa-check"></i><b>18</b> Customizing your plots</a>
<ul>
<li class="chapter" data-level="18.1" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#interactive-plots"><i class="fa fa-check"></i><b>18.1</b> Interactive Plots</a></li>
<li class="chapter" data-level="18.2" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#plot-themes"><i class="fa fa-check"></i><b>18.2</b> Plot Themes</a></li>
<li class="chapter" data-level="18.3" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#legends"><i class="fa fa-check"></i><b>18.3</b> Legends</a></li>
<li class="chapter" data-level="18.4" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#modifying-labels"><i class="fa fa-check"></i><b>18.4</b> Modifying labels</a></li>
<li class="chapter" data-level="18.5" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#modifying-axis"><i class="fa fa-check"></i><b>18.5</b> Modifying Axis</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#transforming-axis"><i class="fa fa-check"></i><b>18.5.1</b> Transforming axis</a></li>
<li class="chapter" data-level="18.5.2" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>18.5.2</b> Axis limits</a></li>
<li class="chapter" data-level="18.5.3" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#axis-tickslabels"><i class="fa fa-check"></i><b>18.5.3</b> Axis ticks/labels</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#arranging-plots"><i class="fa fa-check"></i><b>18.6</b> Arranging plots</a></li>
<li class="chapter" data-level="18.7" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#exercise-12"><i class="fa fa-check"></i><b>18.7</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>Part 5: Modelling in R</b></span></li>
<li class="chapter" data-level="19" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html"><i class="fa fa-check"></i><b>19</b> Modelling: Linear Regression</a>
<ul>
<li class="chapter" data-level="19.1" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#modelling-theory"><i class="fa fa-check"></i><b>19.1</b> Modelling Theory</a></li>
<li class="chapter" data-level="19.2" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#linear-regression-in-r"><i class="fa fa-check"></i><b>19.2</b> Linear Regression in R</a></li>
<li class="chapter" data-level="19.3" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#building-multiple-linear-regressions"><i class="fa fa-check"></i><b>19.3</b> Building Multiple Linear Regressions</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#dataset"><i class="fa fa-check"></i><b>19.3.1</b> Dataset</a></li>
<li class="chapter" data-level="19.3.2" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#building-a-linear-regression-for-each-analyte"><i class="fa fa-check"></i><b>19.3.2</b> Building a Linear Regression for Each Analyte</a></li>
<li class="chapter" data-level="19.3.3" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#table-with-slopes-intercepts-and-r2"><i class="fa fa-check"></i><b>19.3.3</b> Table with Slopes, Intercepts, and <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#calculating-concentration-using-the-regression-variables"><i class="fa fa-check"></i><b>19.4</b> Calculating Concentration Using the Regression Variables</a></li>
<li class="chapter" data-level="19.5" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#conclusion"><i class="fa fa-check"></i><b>19.5</b> Conclusion</a></li>
<li class="chapter" data-level="19.6" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#further_reading_chapter19"><i class="fa fa-check"></i><b>19.6</b> Further reading</a></li>
<li class="chapter" data-level="19.7" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#exercise-13"><i class="fa fa-check"></i><b>19.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html"><i class="fa fa-check"></i><b>20</b> Augmented Outputs and Evaluating Your Model</a>
<ul>
<li class="chapter" data-level="20.1" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#cleaning-up-model-ouputs"><i class="fa fa-check"></i><b>20.1</b> Cleaning up Model Ouputs</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#glanced-outputs"><i class="fa fa-check"></i><b>20.1.1</b> Glanced Outputs</a></li>
<li class="chapter" data-level="20.1.2" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#tidied-outputs"><i class="fa fa-check"></i><b>20.1.2</b> Tidied Outputs</a></li>
<li class="chapter" data-level="20.1.3" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#augmented-outputs"><i class="fa fa-check"></i><b>20.1.3</b> Augmented Outputs</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#incorporating-weights-into-your-model"><i class="fa fa-check"></i><b>20.2</b> Incorporating Weights into your Model</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#why-we-approach-modelling-this-way"><i class="fa fa-check"></i><b>20.2.1</b> Why we approach modelling this way</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#visualizing-models"><i class="fa fa-check"></i><b>20.3</b> Visualizing models</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#visualizing-residuals"><i class="fa fa-check"></i><b>20.3.1</b> Visualizing residuals</a></li>
<li class="chapter" data-level="20.3.2" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#plotting-residuals"><i class="fa fa-check"></i><b>20.3.2</b> Plotting residuals</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#calculating-concentrations-from-the-augmented-outputs"><i class="fa fa-check"></i><b>20.4</b> Calculating Concentrations from the Augmented Outputs</a></li>
<li class="chapter" data-level="20.5" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#exercise-14"><i class="fa fa-check"></i><b>20.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html"><i class="fa fa-check"></i><b>21</b> Modelling: Non-Linear Regression</a>
<ul>
<li class="chapter" data-level="21.1" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#experimental-background"><i class="fa fa-check"></i><b>21.1</b> Experimental Background</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#annotating-maximal-values"><i class="fa fa-check"></i><b>21.1.1</b> Annotating maximal values</a></li>
<li class="chapter" data-level="21.1.2" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#extracting-maximal-values"><i class="fa fa-check"></i><b>21.1.2</b> Extracting maximal values</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#modelling-sigmoid-curve"><i class="fa fa-check"></i><b>21.2</b> Modelling Sigmoid Curve</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#calculating-logistic-regression"><i class="fa fa-check"></i><b>21.2.1</b> Calculating Logistic Regression</a></li>
<li class="chapter" data-level="21.2.2" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#extracting-model-parameters"><i class="fa fa-check"></i><b>21.2.2</b> Extracting model parameters</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#summary-6"><i class="fa fa-check"></i><b>21.3</b> Summary</a></li>
<li class="chapter" data-level="21.4" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#exercise-15"><i class="fa fa-check"></i><b>21.4</b> Exercise</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Environmental Chemistry</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="augmented-outputs-and-evaluating-your-model" class="section level1 hasAnchor" number="20">
<h1><span class="header-section-number">Chapter 20</span> Augmented Outputs and Evaluating Your Model<a href="augmented-outputs-and-evaluating-your-model.html#augmented-outputs-and-evaluating-your-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this section we’ll discuss how to get more out of the model outputs and how you can evaluate the goodness of your fit beyond the use of <span class="math inline">\(R^2\)</span>.</p>
<div id="cleaning-up-model-ouputs" class="section level2 hasAnchor" number="20.1">
<h2><span class="header-section-number">20.1</span> Cleaning up Model Ouputs<a href="augmented-outputs-and-evaluating-your-model.html#cleaning-up-model-ouputs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>summary()</code> function provides a decent overview of our model’s performance, but the outputs are difficult to work with. Let’s turn to the <code>broom()</code> package to clean up our model outputs.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb275-1" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb275-2"><a href="augmented-outputs-and-evaluating-your-model.html#cb275-2" tabindex="-1"></a></span>
<span id="cb275-3"><a href="augmented-outputs-and-evaluating-your-model.html#cb275-3" tabindex="-1"></a>calCurve <span class="ot">&lt;-</span> FAES <span class="sc">%&gt;%</span></span>
<span id="cb275-4"><a href="augmented-outputs-and-evaluating-your-model.html#cb275-4" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb275-5"><a href="augmented-outputs-and-evaluating-your-model.html#cb275-5" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb275-6"><a href="augmented-outputs-and-evaluating-your-model.html#cb275-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(signal <span class="sc">~</span> conc_Na, <span class="at">data =</span> .x)),</span>
<span id="cb275-7"><a href="augmented-outputs-and-evaluating-your-model.html#cb275-7" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(fit, tidy),</span>
<span id="cb275-8"><a href="augmented-outputs-and-evaluating-your-model.html#cb275-8" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(fit, glance),</span>
<span id="cb275-9"><a href="augmented-outputs-and-evaluating-your-model.html#cb275-9" tabindex="-1"></a>         <span class="at">augmented =</span> <span class="fu">map</span>(fit, augment)</span>
<span id="cb275-10"><a href="augmented-outputs-and-evaluating-your-model.html#cb275-10" tabindex="-1"></a>         )</span>
<span id="cb275-11"><a href="augmented-outputs-and-evaluating-your-model.html#cb275-11" tabindex="-1"></a>calCurve</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
## # Groups:   type [1]
##   type     data              fit    tidied           glanced           augmented
##   &lt;chr&gt;    &lt;list&gt;            &lt;list&gt; &lt;list&gt;           &lt;list&gt;            &lt;list&gt;   
## 1 standard &lt;tibble [15 × 4]&gt; &lt;lm&gt;   &lt;tibble [2 × 5]&gt; &lt;tibble [1 × 12]&gt; &lt;tibble&gt;</code></pre>
<p>Things look a bit more complicated than our earlier example, so let’s break down our code line by line:</p>
<ol style="list-style-type: decimal">
<li>We’re taking the <code>FAES</code> dataset that we created earlier.</li>
<li><code>group_by(type)</code> groups all rows by <code>type</code>, in this situation we have only one type: <code>standard</code>.</li>
<li><code>nest()</code> collapses everything other than the <code>type</code> column into smaller data-frames. In this situation, all other information is stored as a <code>tibble</code> under the <code>data</code> column; this is the data used to calculate the linear model.</li>
<li>With the <code>mutate</code> function, we’ve created four columns: <code>fit</code>, <code>tidied</code>, <code>glanced</code>, and <code>augmented</code>.</li>
</ol>
<p>It’s these columns that contain our cleaned up model outputs. <code>fit</code> contains the raw output from the linear regression model for <code>signal</code> as a function of <code>conc_Na</code> using the <code>lm()</code> function. The output is in the form of a list, similar to what <code>summary()</code> gave us above. Again, this is exceptionally messy, hence why we used the <code>tidy()</code>, <code>glance()</code>, and <code>augment()</code> functions from the <code>broom</code> package . <code>map()</code> just means we’re applying the function <code>tidy()</code> to the individual output list created by <code>lm()</code> and stored in the <code>fit</code> column. Note that the <code>tidy()</code>, <code>glanced()</code>, and <code>augmented</code> outputs are tibbles. So we now have a tibble containing specific model output values (i.e. <code>(Intercept)</code>), lists (i.e. <code>fit</code>), and tibbles (<code>tidied</code>). This is known as **nested data*. We’re no longer in Kansas anymore…</p>
<p>We’ll break down what each function did below. Keep in mind however that <code>lm()</code> is used for a variety of statistical tests, and consequently has many associated outputs. Some are essential, others are useful, and some are useless for linear calibration. There are also many ways to use these additional model outputs to calculate outliers, etc. but you shouldn’t have any outliers in your calibration model. Don’t rely on statistics to bail you out of poor chemical technique.</p>
<div id="glanced-outputs" class="section level3 hasAnchor" number="20.1.1">
<h3><span class="header-section-number">20.1.1</span> Glanced Outputs<a href="augmented-outputs-and-evaluating-your-model.html#glanced-outputs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s take a look at our model results. The <code>glanced</code> tibble contains “…a concise one-row summary of the model. This typically contains values such as R^2, adjusted R^2, and residual standard error that are computed once for the entire model”<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Because the data is nested, we’ll need to use <code>unnest()</code> to flatten it back out into regular columns:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb277-1" tabindex="-1"></a>glanced <span class="ot">&lt;-</span> calCurve <span class="sc">%&gt;%</span></span>
<span id="cb277-2"><a href="augmented-outputs-and-evaluating-your-model.html#cb277-2" tabindex="-1"></a>  <span class="fu">unnest</span>(glanced)</span>
<span id="cb277-3"><a href="augmented-outputs-and-evaluating-your-model.html#cb277-3" tabindex="-1"></a></span>
<span id="cb277-4"><a href="augmented-outputs-and-evaluating-your-model.html#cb277-4" tabindex="-1"></a><span class="co"># DT is to make interactive tables for the book.</span></span>
<span id="cb277-5"><a href="augmented-outputs-and-evaluating-your-model.html#cb277-5" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(glanced, </span>
<span id="cb277-6"><a href="augmented-outputs-and-evaluating-your-model.html#cb277-6" tabindex="-1"></a>              <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-43a5dda00b7ca66a7eed" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-43a5dda00b7ca66a7eed">{"x":{"filter":"none","vertical":false,"data":[["1"],["standard"],[{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]}],[{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}}],[{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]}],[0.9755440568488399],[0.9736628304525968],[1824.495501646355],[518.5681312983147],[7.341364277346169e-12],[1],[-132.846703525965],[271.69340705193],[273.8175576552366],[43274189.86186122],[13],[15],[{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],".fitted":[2615.119450306747,2615.119450306747,2615.119450306747,5585.836464110429,5585.836464110429,5585.836464110429,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],".resid":[-2112.780350306747,-2023.342650306747,-2033.660650306747,70.50553588957064,67.72193588957089,81.60223588957069,836.863222085889,806.1323220858885,775.4963220858899,2718.198780674848,2671.806980674846,2684.281080674846,-1524.596088343558,-1485.765688343559,-1532.462988343559],".hat":[0.1329243353783231,0.1329243353783231,0.1329243353783231,0.1012269938650307,0.1012269938650307,0.1012269938650307,0.07975460122699385,0.07975460122699385,0.07975460122699385,0.07668711656441718,0.07668711656441718,0.07668711656441718,0.2760736196319019,0.2760736196319019,0.2760736196319019],".sigma":[1782.461636681907,1792.406887720477,1791.284269553551,1898.873766080493,1898.883159911906,1898.832557030242,1882.22283642461,1883.437023694713,1884.601515256309,1714.446309338632,1721.015550114476,1719.262746690816,1827.187626774323,1830.866076538774,1826.429906811357],".cooksd":[0.1185451010681178,0.1087210868870077,0.1098327566613702,9.356795665990394e-05,8.632556675094507e-05,0.0001253385963399713,0.009906992026245356,0.009192751458027922,0.008507311478872374,0.09983238686436907,0.09645376583510391,0.09735651263606972,0.1839204904480307,0.1746711435215482,0.1858234430672667],".std.resid":[-1.243606700787078,-1.190962646706001,-1.197035939623959,0.040761993067928,0.03915268562174976,0.04717742701605555,0.4781452634015676,0.4605870365763488,0.4430830312586598,1.550472146055519,1.524010066013116,1.531125345710324,-0.9821205599872512,-0.9571066336863108,-0.9871882918884651]}]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>type<\/th>\n      <th>data<\/th>\n      <th>fit<\/th>\n      <th>tidied<\/th>\n      <th>r.squared<\/th>\n      <th>adj.r.squared<\/th>\n      <th>sigma<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>df<\/th>\n      <th>logLik<\/th>\n      <th>AIC<\/th>\n      <th>BIC<\/th>\n      <th>deviance<\/th>\n      <th>df.residual<\/th>\n      <th>nobs<\/th>\n      <th>augmented<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[5,6,7,8,9,10,11,12,13,14,15,16]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"type","targets":1},{"name":"data","targets":2},{"name":"fit","targets":3},{"name":"tidied","targets":4},{"name":"r.squared","targets":5},{"name":"adj.r.squared","targets":6},{"name":"sigma","targets":7},{"name":"statistic","targets":8},{"name":"p.value","targets":9},{"name":"df","targets":10},{"name":"logLik","targets":11},{"name":"AIC","targets":12},{"name":"BIC","targets":13},{"name":"deviance","targets":14},{"name":"df.residual","targets":15},{"name":"nobs","targets":16},{"name":"augmented","targets":17}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>What you see here is a bit more than what you’d get from <em>Excel</em>’s ‘line-of-best fit’ output. In brief, :</p>
<ul>
<li><code>type</code>, <code>data</code>, <code>fit</code>, <code>tidied</code>, and <code>augmented</code> are columns we’ve created earlier.</li>
<li><code>r.squared</code> is a statistical measure of fit that indicates how much variation of a dependent variable is explained by the independent variable. The closer <code>r.squared</code> is to 1, the more variance is captured by the model.</li>
<li><code>adj.r.squared</code> is the same as <code>r.squared</code> in this situation. This is because <code>r.squared</code> will always increase if we add more exploratory variables to our model; the <code>adj.r.squared</code> accounts for the number of exploratory variables used in the model.
<ul>
<li>In our case we only have one exploratory variable, hence they’re approximately the same.</li>
</ul></li>
<li>The other columns are different measurements of goodness-of-fit and hypothesis testing of the model. See <a href="modelling-linear-regression.html#further_reading_chapter19">Further reading</a>.</li>
</ul>
</div>
<div id="tidied-outputs" class="section level3 hasAnchor" number="20.1.2">
<h3><span class="header-section-number">20.1.2</span> Tidied Outputs<a href="augmented-outputs-and-evaluating-your-model.html#tidied-outputs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>But what about the slope and the intercept? After all, that’s what we need to calculate the concentration in our unknowns. Let’s take a look at <code>tidied</code> from the <code>tidy()</code> function which constructs a tibble that summarizes the model’s statistical findings. This includes coefficients and p-values for each term in a regression:<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb278-1" tabindex="-1"></a><span class="co"># storing because we&#39;ll use it later on. </span></span>
<span id="cb278-2"><a href="augmented-outputs-and-evaluating-your-model.html#cb278-2" tabindex="-1"></a></span>
<span id="cb278-3"><a href="augmented-outputs-and-evaluating-your-model.html#cb278-3" tabindex="-1"></a>tidied <span class="ot">&lt;-</span> calCurve <span class="sc">%&gt;%</span> </span>
<span id="cb278-4"><a href="augmented-outputs-and-evaluating-your-model.html#cb278-4" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied)</span>
<span id="cb278-5"><a href="augmented-outputs-and-evaluating-your-model.html#cb278-5" tabindex="-1"></a></span>
<span id="cb278-6"><a href="augmented-outputs-and-evaluating-your-model.html#cb278-6" tabindex="-1"></a><span class="co"># DT is to make interactive tables for the book.</span></span>
<span id="cb278-7"><a href="augmented-outputs-and-evaluating-your-model.html#cb278-7" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(tidied, </span>
<span id="cb278-8"><a href="augmented-outputs-and-evaluating-your-model.html#cb278-8" tabindex="-1"></a>              <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-873513cbe87887c5f51c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-873513cbe87887c5f51c">{"x":{"filter":"none","vertical":false,"data":[["1","2"],["standard","standard"],[{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]}],[{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}}],["(Intercept)","conc_Na"],[2615.119450306747,29707.17013803681],[665.1889798813839,1304.542918708483],[3.931393227189472,22.77209106117211],[0.001720952931256512,7.341364277346169e-12],[{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]}],[{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],".fitted":[2615.119450306747,2615.119450306747,2615.119450306747,5585.836464110429,5585.836464110429,5585.836464110429,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],".resid":[-2112.780350306747,-2023.342650306747,-2033.660650306747,70.50553588957064,67.72193588957089,81.60223588957069,836.863222085889,806.1323220858885,775.4963220858899,2718.198780674848,2671.806980674846,2684.281080674846,-1524.596088343558,-1485.765688343559,-1532.462988343559],".hat":[0.1329243353783231,0.1329243353783231,0.1329243353783231,0.1012269938650307,0.1012269938650307,0.1012269938650307,0.07975460122699385,0.07975460122699385,0.07975460122699385,0.07668711656441718,0.07668711656441718,0.07668711656441718,0.2760736196319019,0.2760736196319019,0.2760736196319019],".sigma":[1782.461636681907,1792.406887720477,1791.284269553551,1898.873766080493,1898.883159911906,1898.832557030242,1882.22283642461,1883.437023694713,1884.601515256309,1714.446309338632,1721.015550114476,1719.262746690816,1827.187626774323,1830.866076538774,1826.429906811357],".cooksd":[0.1185451010681178,0.1087210868870077,0.1098327566613702,9.356795665990394e-05,8.632556675094507e-05,0.0001253385963399713,0.009906992026245356,0.009192751458027922,0.008507311478872374,0.09983238686436907,0.09645376583510391,0.09735651263606972,0.1839204904480307,0.1746711435215482,0.1858234430672667],".std.resid":[-1.243606700787078,-1.190962646706001,-1.197035939623959,0.040761993067928,0.03915268562174976,0.04717742701605555,0.4781452634015676,0.4605870365763488,0.4430830312586598,1.550472146055519,1.524010066013116,1.531125345710324,-0.9821205599872512,-0.9571066336863108,-0.9871882918884651]},{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],".fitted":[2615.119450306747,2615.119450306747,2615.119450306747,5585.836464110429,5585.836464110429,5585.836464110429,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],".resid":[-2112.780350306747,-2023.342650306747,-2033.660650306747,70.50553588957064,67.72193588957089,81.60223588957069,836.863222085889,806.1323220858885,775.4963220858899,2718.198780674848,2671.806980674846,2684.281080674846,-1524.596088343558,-1485.765688343559,-1532.462988343559],".hat":[0.1329243353783231,0.1329243353783231,0.1329243353783231,0.1012269938650307,0.1012269938650307,0.1012269938650307,0.07975460122699385,0.07975460122699385,0.07975460122699385,0.07668711656441718,0.07668711656441718,0.07668711656441718,0.2760736196319019,0.2760736196319019,0.2760736196319019],".sigma":[1782.461636681907,1792.406887720477,1791.284269553551,1898.873766080493,1898.883159911906,1898.832557030242,1882.22283642461,1883.437023694713,1884.601515256309,1714.446309338632,1721.015550114476,1719.262746690816,1827.187626774323,1830.866076538774,1826.429906811357],".cooksd":[0.1185451010681178,0.1087210868870077,0.1098327566613702,9.356795665990394e-05,8.632556675094507e-05,0.0001253385963399713,0.009906992026245356,0.009192751458027922,0.008507311478872374,0.09983238686436907,0.09645376583510391,0.09735651263606972,0.1839204904480307,0.1746711435215482,0.1858234430672667],".std.resid":[-1.243606700787078,-1.190962646706001,-1.197035939623959,0.040761993067928,0.03915268562174976,0.04717742701605555,0.4781452634015676,0.4605870365763488,0.4430830312586598,1.550472146055519,1.524010066013116,1.531125345710324,-0.9821205599872512,-0.9571066336863108,-0.9871882918884651]}]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>type<\/th>\n      <th>data<\/th>\n      <th>fit<\/th>\n      <th>term<\/th>\n      <th>estimate<\/th>\n      <th>std.error<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>glanced<\/th>\n      <th>augmented<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"type","targets":1},{"name":"data","targets":2},{"name":"fit","targets":3},{"name":"term","targets":4},{"name":"estimate","targets":5},{"name":"std.error","targets":6},{"name":"statistic","targets":7},{"name":"p.value","targets":8},{"name":"glanced","targets":9},{"name":"augmented","targets":10}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>Again, a lot more to unpack compared to <em>Excel</em>. That’s because the <code>lm()</code> function in R calculates a generalized linear model. <code>lm()</code> performs a linear regression model, which we normally think of as an equation of the form <span class="math inline">\(y= a + bx\)</span> as discussed earlier. But, regression models can be expanded to account for multiple variables (hence <em>multiple linear regression</em>) of the form:</p>
<p><span class="math display">\[y = \beta _{0} + \beta _{1} x_{1} + \beta _{2} x_{2} ... \beta _{p} x_{p}\]</span></p>
<p>where,</p>
<ul>
<li><span class="math inline">\(y\)</span> = dependent variable</li>
<li><span class="math inline">\(x\)</span> = exploratory variable; there’s no limit how many you can input</li>
<li><span class="math inline">\(\beta _{0}\)</span> = y-intercept (constant term)</li>
<li><span class="math inline">\(\beta _{p}\)</span> = slope coefficient for each explanatory variable</li>
</ul>
<p>With our linear calibration model, we only have one input variable for our model (<code>conc</code>), so the above formula collapses down to <span class="math inline">\(y = \beta _{0} + \beta _{1} x_{1}\)</span>. So looking at our tidied model outputs:</p>
<ul>
<li>each row corresponds to a model coefficient (under the <code>term</code> column).</li>
<li>For each modelling parameter, we’re provided an estimate of its numerical value: <code>estimate</code>. These are the values we’ll use to calculate concentration.</li>
<li><code>std.error</code> measures how precisely the model estimates the coefficient’s unknown value; smaller is better.</li>
<li><code>p.value</code> is an indication of the significance of a model coefficient; the closer to zero the better.
<ul>
<li>If we were to use multiple parameters in our model (e.g. concentration and temperature) we could use the <code>p.value</code> to determine if a given coefficient was useful for our model.</li>
</ul></li>
</ul>
<p>We can extract the value of the model coefficients for subsequent calculations as follows:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb279-1" tabindex="-1"></a><span class="co"># intercept</span></span>
<span id="cb279-2"><a href="augmented-outputs-and-evaluating-your-model.html#cb279-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tidied[<span class="dv">1</span>,<span class="dv">5</span>])</span>
<span id="cb279-3"><a href="augmented-outputs-and-evaluating-your-model.html#cb279-3" tabindex="-1"></a></span>
<span id="cb279-4"><a href="augmented-outputs-and-evaluating-your-model.html#cb279-4" tabindex="-1"></a><span class="co"># slope </span></span>
<span id="cb279-5"><a href="augmented-outputs-and-evaluating-your-model.html#cb279-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tidied[<span class="dv">2</span>,<span class="dv">5</span>])</span>
<span id="cb279-6"><a href="augmented-outputs-and-evaluating-your-model.html#cb279-6" tabindex="-1"></a></span>
<span id="cb279-7"><a href="augmented-outputs-and-evaluating-your-model.html#cb279-7" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;The equation of our calibration curve is: y = &quot;</span>, a, <span class="st">&quot; + &quot;</span>, b,<span class="st">&quot;x&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The equation of our calibration curve is: y = 2615.11945030675 + 29707.1701380368x&quot;</code></pre>
</div>
<div id="augmented-outputs" class="section level3 hasAnchor" number="20.1.3">
<h3><span class="header-section-number">20.1.3</span> Augmented Outputs<a href="augmented-outputs-and-evaluating-your-model.html#augmented-outputs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, let’s take a look at the outputs of the <code>augment</code> function:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb281-1" tabindex="-1"></a><span class="co"># storing because we&#39;ll use it later on. </span></span>
<span id="cb281-2"><a href="augmented-outputs-and-evaluating-your-model.html#cb281-2" tabindex="-1"></a></span>
<span id="cb281-3"><a href="augmented-outputs-and-evaluating-your-model.html#cb281-3" tabindex="-1"></a>augmented <span class="ot">&lt;-</span> calCurve <span class="sc">%&gt;%</span> </span>
<span id="cb281-4"><a href="augmented-outputs-and-evaluating-your-model.html#cb281-4" tabindex="-1"></a>  <span class="fu">unnest</span>(augmented)</span>
<span id="cb281-5"><a href="augmented-outputs-and-evaluating-your-model.html#cb281-5" tabindex="-1"></a></span>
<span id="cb281-6"><a href="augmented-outputs-and-evaluating-your-model.html#cb281-6" tabindex="-1"></a><span class="co"># DT is to make interactive tables for the book.</span></span>
<span id="cb281-7"><a href="augmented-outputs-and-evaluating-your-model.html#cb281-7" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(augmented, </span>
<span id="cb281-8"><a href="augmented-outputs-and-evaluating-your-model.html#cb281-8" tabindex="-1"></a>              <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-316d4e058a481830a8c4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-316d4e058a481830a8c4">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard"],[{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]},{"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],"units":["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],"replicate":["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]}],[{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}},{"coefficients":[2615.119450306747,29707.17013803681],"residuals":[-2112.78035030675,-2023.342650306748,-2033.660650306747,70.50553588957126,67.72193588957151,81.60223588957138,836.8632220858892,806.1323220858887,775.4963220858901,2718.198780674847,2671.806980674845,2684.281080674845,-1524.596088343557,-1485.765688343558,-1532.462988343558],"effects":[-51548.24915410519,41547.57770418969,-1330.088350942444,679.7121838127068,676.9285838127071,690.8088838127069,1351.704218567857,1320.973318567857,1290.337318567858,2949.942822833313,2903.551022833311,2916.025122833311,-1764.680303390927,-1725.849903390928,-1772.547203390928],"rank":2,"fitted.values":[2615.11945030675,2615.119450306748,2615.119450306747,5585.836464110428,5585.836464110428,5585.836464110428,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],"assign":[0,1],"qr":{"qr":[[-3.872983346207417,-1.39427400463467],[0.2581988897471611,1.398570698963767],[0.2581988897471611,0.2045826396872415],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.1330810702105663],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,0.06157950073389103],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.1529252076961346],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106],[0.2581988897471611,-0.5104330550795106]],"qraux":[1.258198889747161,1.204582639687241],"pivot":[1,2],"tol":1e-07,"rank":2},"df.residual":13,"xlevels":{},"call":{},"terms":{},"model":{"signal":[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],"conc_Na":[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1]}}],[{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]},{"term":["(Intercept)","conc_Na"],"estimate":[2615.119450306747,29707.17013803681],"std.error":[665.1889798813839,1304.542918708483],"statistic":[3.931393227189472,22.77209106117211],"p.value":[0.001720952931256512,7.341364277346169e-12]}],[{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]},{"r.squared":[0.9755440568488399],"adj.r.squared":[0.9736628304525968],"sigma":[1824.495501646355],"statistic":[518.5681312983147],"p.value":[7.341364277346169e-12],"df":[1],"logLik":[-132.846703525965],"AIC":[271.69340705193],"BIC":[273.8175576552366],"deviance":[43274189.86186122],"df.residual":[13],"nobs":[15]}],[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266],[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],[2615.119450306747,2615.119450306747,2615.119450306747,5585.836464110429,5585.836464110429,5585.836464110429,8556.553477914111,8556.553477914111,8556.553477914111,17468.70451932515,17468.70451932515,17468.70451932515,32322.28958834356,32322.28958834356,32322.28958834356],[-2112.780350306747,-2023.342650306747,-2033.660650306747,70.50553588957064,67.72193588957089,81.60223588957069,836.863222085889,806.1323220858885,775.4963220858899,2718.198780674848,2671.806980674846,2684.281080674846,-1524.596088343558,-1485.765688343559,-1532.462988343559],[0.1329243353783231,0.1329243353783231,0.1329243353783231,0.1012269938650307,0.1012269938650307,0.1012269938650307,0.07975460122699385,0.07975460122699385,0.07975460122699385,0.07668711656441718,0.07668711656441718,0.07668711656441718,0.2760736196319019,0.2760736196319019,0.2760736196319019],[1782.461636681907,1792.406887720477,1791.284269553551,1898.873766080493,1898.883159911906,1898.832557030242,1882.22283642461,1883.437023694713,1884.601515256309,1714.446309338632,1721.015550114476,1719.262746690816,1827.187626774323,1830.866076538774,1826.429906811357],[0.1185451010681178,0.1087210868870077,0.1098327566613702,9.356795665990394e-05,8.632556675094507e-05,0.0001253385963399713,0.009906992026245356,0.009192751458027922,0.008507311478872374,0.09983238686436907,0.09645376583510391,0.09735651263606972,0.1839204904480307,0.1746711435215482,0.1858234430672667],[-1.243606700787078,-1.190962646706001,-1.197035939623959,0.040761993067928,0.03915268562174976,0.04717742701605555,0.4781452634015676,0.4605870365763488,0.4430830312586598,1.550472146055519,1.524010066013116,1.531125345710324,-0.9821205599872512,-0.9571066336863108,-0.9871882918884651]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>type<\/th>\n      <th>data<\/th>\n      <th>fit<\/th>\n      <th>tidied<\/th>\n      <th>glanced<\/th>\n      <th>signal<\/th>\n      <th>conc_Na<\/th>\n      <th>.fitted<\/th>\n      <th>.resid<\/th>\n      <th>.hat<\/th>\n      <th>.sigma<\/th>\n      <th>.cooksd<\/th>\n      <th>.std.resid<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"type","targets":1},{"name":"data","targets":2},{"name":"fit","targets":3},{"name":"tidied","targets":4},{"name":"glanced","targets":5},{"name":"signal","targets":6},{"name":"conc_Na","targets":7},{"name":".fitted","targets":8},{"name":".resid","targets":9},{"name":".hat","targets":10},{"name":".sigma","targets":11},{"name":".cooksd","targets":12},{"name":".std.resid","targets":13}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>As you can see, <code>augment()</code> adds columns to the original data that was modelled. For our purposes we’re interested:</p>
<ul>
<li><code>signal</code> and <code>conc_Na</code>, the original data used in our model.</li>
<li><code>.fitted</code>, the predicted value of the point according to our calculated model.</li>
<li><code>.resid</code>, the residuals of that point (different between measured and fitted values.)</li>
<li>The other parameters are different measurements of the influence of each point on the model fitting. They can be used to detect outliers; see <a href="modelling-linear-regression.html#further_reading_chapter19">Further reading</a></li>
</ul>
</div>
</div>
<div id="incorporating-weights-into-your-model" class="section level2 hasAnchor" number="20.2">
<h2><span class="header-section-number">20.2</span> Incorporating Weights into your Model<a href="augmented-outputs-and-evaluating-your-model.html#incorporating-weights-into-your-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You’ll often find that your calibration data is <em>heteroscedastic</em>, meaning the variance increases with the concentration. This leads to <em>leverage</em> of your line-of-best fit, as it is ‘pulled’ by one way or another by the higher concentration standards than the lower. You can assign ‘weights’ (how much a point impacts the model) in R, although you’ll need to justify the validity of your approach. A common approach, however, is to weight each standard by <span class="math inline">\(\frac{1}{x^2}\)</span>. This ensures that samples with higher concentration impact the line less, and vice-versa with low-concentration standards.</p>
<p>To utilize weight in R, we need to calculate the weight prior to modelling, and subsequently specify the weights column</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-1" tabindex="-1"></a><span class="co"># note that our blank has a concentration of 0, hence infinite weight. </span></span>
<span id="cb282-2"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-2" tabindex="-1"></a><span class="co"># we need to remove it to weight our data. </span></span>
<span id="cb282-3"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-3" tabindex="-1"></a></span>
<span id="cb282-4"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-4" tabindex="-1"></a>FAESweighed <span class="ot">&lt;-</span> FAES <span class="sc">%&gt;%</span> </span>
<span id="cb282-5"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-5" tabindex="-1"></a>  <span class="fu">filter</span>(conc_Na <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb282-6"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wght =</span> <span class="dv">1</span><span class="sc">/</span>(conc_Na<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb282-7"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-7" tabindex="-1"></a></span>
<span id="cb282-8"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-8" tabindex="-1"></a>weightedCalCurve <span class="ot">&lt;-</span> FAESweighed <span class="sc">%&gt;%</span></span>
<span id="cb282-9"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-9" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb282-10"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-10" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb282-11"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(signal <span class="sc">~</span> conc_Na, <span class="at">data =</span> .x, <span class="at">weights =</span> wght)),</span>
<span id="cb282-12"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-12" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(fit, tidy),</span>
<span id="cb282-13"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-13" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(fit, glance),</span>
<span id="cb282-14"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-14" tabindex="-1"></a>         <span class="at">augmented =</span> <span class="fu">map</span>(fit, augment)</span>
<span id="cb282-15"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-15" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb282-16"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-16" tabindex="-1"></a>  <span class="fu">unnest</span>(augmented)</span>
<span id="cb282-17"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-17" tabindex="-1"></a></span>
<span id="cb282-18"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-18" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> weightedCalCurve, </span>
<span id="cb282-19"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-19" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc_Na, <span class="at">y =</span> signal)) <span class="sc">+</span></span>
<span id="cb282-20"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-20" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb282-21"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-21" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se=</span>F, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">label =</span> <span class="st">&quot;unweighed&quot;</span>) <span class="sc">+</span></span>
<span id="cb282-22"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-22" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se=</span>F, <span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb282-23"><a href="augmented-outputs-and-evaluating-your-model.html#cb282-23" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">weight=</span><span class="st">`</span><span class="at">(weights)</span><span class="st">`</span>, <span class="at">label =</span> <span class="st">&quot;weighed&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning in geom_smooth(method = &quot;lm&quot;, se = F, colour = &quot;red&quot;, label =
## &quot;unweighed&quot;): Ignoring unknown parameters: `label`</code></pre>
<pre><code>## Warning in geom_smooth(method = &quot;lm&quot;, se = F, colour = &quot;blue&quot;, aes(weight =
## `(weights)`, : Ignoring unknown aesthetics: label</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;
## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
<div id="why-we-approach-modelling-this-way" class="section level3 hasAnchor" number="20.2.1">
<h3><span class="header-section-number">20.2.1</span> Why we approach modelling this way<a href="augmented-outputs-and-evaluating-your-model.html#why-we-approach-modelling-this-way" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You may be wondering why we’ve seemingly overcomplicated a simple enough procedure. Fair enough, we’ve showcased an analysis with a simple data set. However, as you progress in your studies you’ll be quantifying <em>many</em> compounds, often at the same time in the same instrument runs. If you organize your data in a tidy format, you can plot calibration curves for <em>all</em> of your compounds with the same block of code. Essentially you use <code>group_by()</code> to group your data by compound/element. Subsequently, the same code is expandable from 1 compound to as many as you can ever hope to quantify in one shot. So for upper year labs where you’re analyzing tens of compounds (<em>cough</em> the CHM410 labs) you can generate calibration curves for all your compounds at once.</p>
</div>
</div>
<div id="visualizing-models" class="section level2 hasAnchor" number="20.3">
<h2><span class="header-section-number">20.3</span> Visualizing models<a href="augmented-outputs-and-evaluating-your-model.html#visualizing-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At the top of the chapter we plotted out standards to visualize a linear trend. Visualization is an essential component when calculating calibration curves, and indeed our standards appeared to follow a linear trend, which was corroborated by the model we calculated above. However, for publications/reports you’ll need to create a plot with both your standards <em>and</em> model with the displayed equation, so below is a bit of stock code you can use as a starting point to create these plots. Note that it requires the <code>ggpmisc</code> package to display the equation:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb286-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FAES,</span>
<span id="cb286-2"><a href="augmented-outputs-and-evaluating-your-model.html#cb286-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc_Na, </span>
<span id="cb286-3"><a href="augmented-outputs-and-evaluating-your-model.html#cb286-3" tabindex="-1"></a>           <span class="at">y =</span> signal)) <span class="sc">+</span></span>
<span id="cb286-4"><a href="augmented-outputs-and-evaluating-your-model.html#cb286-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb286-5"><a href="augmented-outputs-and-evaluating-your-model.html#cb286-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb286-6"><a href="augmented-outputs-and-evaluating-your-model.html#cb286-6" tabindex="-1"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_poly_eq</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="co"># formula uses aesthetic names</span></span>
<span id="cb286-7"><a href="augmented-outputs-and-evaluating-your-model.html#cb286-7" tabindex="-1"></a>                        <span class="at">rr.digits =</span> <span class="dv">4</span>, <span class="co"># reported digits of r-squared</span></span>
<span id="cb286-8"><a href="augmented-outputs-and-evaluating-your-model.html#cb286-8" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..eq.label.., ..rr.label.., <span class="at">sep =</span> <span class="st">&quot;~~~&quot;</span>)), </span>
<span id="cb286-9"><a href="augmented-outputs-and-evaluating-your-model.html#cb286-9" tabindex="-1"></a>                        <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) </span></code></pre></div>
<pre><code>## Registered S3 methods overwritten by &#39;ggpp&#39;:
##   method                  from   
##   heightDetails.titleGrob ggplot2
##   widthDetails.titleGrob  ggplot2</code></pre>
<pre><code>## Warning in .recacheSubclasses(def@className, def, env): undefined subclass
## &quot;ndiMatrix&quot; of class &quot;replValueSp&quot;; definition not updated</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;ggpmisc&#39;:
##   method                  from   
##   as.character.polynomial polynom</code></pre>
<pre><code>## Warning: The dot-dot notation (`..eq.label..`) was deprecated in ggplot2 3.4.0.
## ℹ Please use `after_stat(eq.label)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-172-1.png" width="672" /></p>
<div id="visualizing-residuals" class="section level3 hasAnchor" number="20.3.1">
<h3><span class="header-section-number">20.3.1</span> Visualizing residuals<a href="augmented-outputs-and-evaluating-your-model.html#visualizing-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As discussed in the <a href="modelling-linear-regression.html#modelling-theory">Modelling Theory</a> section, residuals are the difference between measured and fitted values. They’re often overlooked in linear calibration and folks are hot to plot a straight line through their data. This has the unintended effect of fooling your eyes into thinking your data is linear. Consequently, it is always a good idea to plot the residuals of your model as this will magnify any trends or discrepancies of your calibration model. A good linear model will have the residuals randomly distributed about zero. Other examples of patterns in residuals are shown below:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-173"></span>
<img src="R4EnvChem_files/figure-html/unnamed-chunk-173-1.png" alt="Example residual patterns; figure adapted from Hibbert and Gooding (2006). " width="672" />
<p class="caption">
Figure 20.1: Example residual patterns; figure adapted from Hibbert and Gooding (2006).
</p>
</div>
<ul>
<li>Normally distributed residuals are satisfactory for linear modelling. Note the relatively small magnitude of the residuals.</li>
<li>Curvature throughout range results from an instrument becoming saturated. Consequently, the linear model will ‘cut’ through the curve. This is a good indication that you’ll need to either breakdown your calibration curve into two or more parts or utilize a non-linear model.</li>
<li>Heteroscedasticity means the variance of the response is proportional to the concentration. This is often the case in instrumental analysis. See [Weighing] above.</li>
<li>Outliers shouldn’t exist in your calibration plot, nevertheless, a plot of residuals can readily highlight an outlier point.</li>
</ul>
</div>
<div id="plotting-residuals" class="section level3 hasAnchor" number="20.3.2">
<h3><span class="header-section-number">20.3.2</span> Plotting residuals<a href="augmented-outputs-and-evaluating-your-model.html#plotting-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To plot residuals, we use our <code>augmented</code> dataset from above, and simply create a plot of the independent variable vs. the residuals. Here we plot the FAES calibration model and its residuals. Note that the residuals indicate curvature throughout the range. We may have overextended our calibration range <em>outside</em> of the linear range of our instrument.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> FAES,</span>
<span id="cb292-2"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc_Na, </span>
<span id="cb292-3"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-3" tabindex="-1"></a>           <span class="at">y =</span> signal)) <span class="sc">+</span></span>
<span id="cb292-4"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb292-5"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb292-6"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-6" tabindex="-1"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_poly_eq</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="co"># formula uses aesthetic names</span></span>
<span id="cb292-7"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-7" tabindex="-1"></a>                        <span class="at">rr.digits =</span> <span class="dv">4</span>, <span class="co"># reported digits of r-squared</span></span>
<span id="cb292-8"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-8" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..eq.label.., ..rr.label.., <span class="at">sep =</span> <span class="st">&quot;~~~&quot;</span>)), </span>
<span id="cb292-9"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-9" tabindex="-1"></a>                        <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) </span>
<span id="cb292-10"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-10" tabindex="-1"></a></span>
<span id="cb292-11"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-11" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> augmented, </span>
<span id="cb292-12"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-12" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc_Na, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb292-13"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-13" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb292-14"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-14" tabindex="-1"></a></span>
<span id="cb292-15"><a href="augmented-outputs-and-evaluating-your-model.html#cb292-15" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(a, b, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-174"></span>
<img src="R4EnvChem_files/figure-html/unnamed-chunk-174-1.png" alt="(A) linear calibration model and (B) plot of model residuals." width="672" />
<p class="caption">
Figure 20.2: (A) linear calibration model and (B) plot of model residuals.
</p>
</div>
</div>
</div>
<div id="calculating-concentrations-from-the-augmented-outputs" class="section level2 hasAnchor" number="20.4">
<h2><span class="header-section-number">20.4</span> Calculating Concentrations from the Augmented Outputs<a href="augmented-outputs-and-evaluating-your-model.html#calculating-concentrations-from-the-augmented-outputs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In <a href="augmented-outputs-and-evaluating-your-model.html#tidied-outputs">Tidied outputs</a> we extracted our model coefficients (slope and intercept):</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb294-1" tabindex="-1"></a><span class="co"># intercept</span></span>
<span id="cb294-2"><a href="augmented-outputs-and-evaluating-your-model.html#cb294-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tidied[<span class="dv">1</span>,<span class="dv">5</span>])</span>
<span id="cb294-3"><a href="augmented-outputs-and-evaluating-your-model.html#cb294-3" tabindex="-1"></a></span>
<span id="cb294-4"><a href="augmented-outputs-and-evaluating-your-model.html#cb294-4" tabindex="-1"></a><span class="co"># slope</span></span>
<span id="cb294-5"><a href="augmented-outputs-and-evaluating-your-model.html#cb294-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tidied[<span class="dv">2</span>,<span class="dv">5</span>])</span>
<span id="cb294-6"><a href="augmented-outputs-and-evaluating-your-model.html#cb294-6" tabindex="-1"></a></span>
<span id="cb294-7"><a href="augmented-outputs-and-evaluating-your-model.html#cb294-7" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;The equation of our calibration curve is: y = &quot;</span>, a, <span class="st">&quot; + &quot;</span>, b,<span class="st">&quot;x&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The equation of our calibration curve is: y = 2615.11945030675 + 29707.1701380368x&quot;</code></pre>
<p>Now that we have our coefficients, we can calculate the sample concentration as described in <a href="modelling-linear-regression.html#modelling-theory">Modelling Theory</a>. Let’s import the FAES unknown dataset first:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb296-1" tabindex="-1"></a>FAESsamples <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">&quot;data/FAESUnknowns.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb296-2"><a href="augmented-outputs-and-evaluating-your-model.html#cb296-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(sample, <span class="st">`</span><span class="at">dilution factor</span><span class="st">`</span>), </span>
<span id="cb296-3"><a href="augmented-outputs-and-evaluating-your-model.html#cb296-3" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;replicate&quot;</span>,</span>
<span id="cb296-4"><a href="augmented-outputs-and-evaluating-your-model.html#cb296-4" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;reading_&quot;</span>,</span>
<span id="cb296-5"><a href="augmented-outputs-and-evaluating-your-model.html#cb296-5" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;signal&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 3 Columns: 5
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (1): sample
## dbl (4): dilution factor, reading_1, reading_2, reading_3
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb298-1" tabindex="-1"></a>FAESsamples</span></code></pre></div>
<pre><code>## # A tibble: 9 × 4
##   sample    `dilution factor` replicate signal
##   &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
## 1 wine                     10 1         12775.
## 2 wine                     10 2         12651.
## 3 wine                     10 3         12746.
## 4 tap-water                10 1          8014.
## 5 tap-water                10 2          7200.
## 6 tap-water                10 3          7203.
## 7 fish-tank               100 1         12085.
## 8 fish-tank               100 2         12073.
## 9 fish-tank               100 3         12156.</code></pre>
<p>Now it’s simply a matter of calculating the concentration of the sample analyzed by the instrument, and correcting for the dilution factor to find the concentration in the parent sample:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb300-1" tabindex="-1"></a>FAESsamples <span class="ot">&lt;-</span> FAESsamples <span class="sc">%&gt;%</span></span>
<span id="cb300-2"><a href="augmented-outputs-and-evaluating-your-model.html#cb300-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;instConc&quot;</span> <span class="ot">=</span> (signal <span class="sc">-</span> a)<span class="sc">/</span>b,</span>
<span id="cb300-3"><a href="augmented-outputs-and-evaluating-your-model.html#cb300-3" tabindex="-1"></a>         <span class="st">&quot;sampleConc&quot;</span> <span class="ot">=</span> instConc <span class="sc">*</span> <span class="st">`</span><span class="at">dilution factor</span><span class="st">`</span>)</span>
<span id="cb300-4"><a href="augmented-outputs-and-evaluating-your-model.html#cb300-4" tabindex="-1"></a></span>
<span id="cb300-5"><a href="augmented-outputs-and-evaluating-your-model.html#cb300-5" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(FAESsamples, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-a5442cc97559a4fcafe3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a5442cc97559a4fcafe3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9"],["wine","wine","wine","tap-water","tap-water","tap-water","fish-tank","fish-tank","fish-tank"],[10,10,10,10,10,10,100,100,100],["1","2","3","1","2","3","1","2","3"],[12775.1255,12650.6561,12745.6284,8013.9588,7199.6695,7203.2021,12085.29012,12073.45137,12155.61549],[0.3420051793046577,0.3378153019308909,0.3410122506661189,0.1817352283844978,0.1543246976534878,0.1544436117063439,0.3187840048610933,0.3183854899589673,0.3211512909295147],[3.420051793046577,3.378153019308909,3.410122506661189,1.817352283844978,1.543246976534878,1.544436117063439,31.87840048610933,31.83854899589673,32.11512909295147]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sample<\/th>\n      <th>dilution factor<\/th>\n      <th>replicate<\/th>\n      <th>signal<\/th>\n      <th>instConc<\/th>\n      <th>sampleConc<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"sample","targets":1},{"name":"dilution factor","targets":2},{"name":"replicate","targets":3},{"name":"signal","targets":4},{"name":"instConc","targets":5},{"name":"sampleConc","targets":6}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>And let’s summarize our results using code from the <a href="summarizing-data.html#summarizing-data">Summarizing data</a> chapter:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="augmented-outputs-and-evaluating-your-model.html#cb301-1" tabindex="-1"></a>FAESsamples <span class="sc">%&gt;%</span></span>
<span id="cb301-2"><a href="augmented-outputs-and-evaluating-your-model.html#cb301-2" tabindex="-1"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span></span>
<span id="cb301-3"><a href="augmented-outputs-and-evaluating-your-model.html#cb301-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(sampleConc),</span>
<span id="cb301-4"><a href="augmented-outputs-and-evaluating-your-model.html#cb301-4" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(sampleConc),</span>
<span id="cb301-5"><a href="augmented-outputs-and-evaluating-your-model.html#cb301-5" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##   sample     mean     sd     n
##   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;
## 1 fish-tank 31.9  0.150      3
## 2 tap-water  1.64 0.158      3
## 3 wine       3.40 0.0219     3</code></pre>
<p>And there we go. See the <a href="summarizing-data.html#summarizing-data">Summarizing data</a> and <a href="visualizations-for-env-chem.html#visualizations-for-env-chem">Visualizations for Env Chem</a> chapters for assisting in making prettier tables and visualizations, respectively.</p>
</div>
<div id="exercise-14" class="section level2 hasAnchor" number="20.5">
<h2><span class="header-section-number">20.5</span> Exercise<a href="augmented-outputs-and-evaluating-your-model.html#exercise-14" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There is a set of exercises available for this chapter!</p>
<p><strong>Not sure how to access and work on the exercise Rmd files? </strong></p>
<ul>
<li><p>Refer to Chapter 3.2 for step-by-step instructions on accessing the exercises and working within the UofT JupyterHub’s RStudio environment.</p></li>
<li><p>Alternatively, if you’d like to simply access the individual files, you can download them directly from this <a href="https://github.com/UofTChem-Teaching/R4EnvChem-Exercises">repository</a>.</p></li>
</ul>
<p>Always remember to save your progress regularly and consult the textbook’s guidelines for submitting your completed exercises.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>From the <em>broom</em> package vignette.<a href="augmented-outputs-and-evaluating-your-model.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>From the <em>broom</em> package vignette.<a href="augmented-outputs-and-evaluating-your-model.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelling-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelling-non-linear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/UofTChem-Teaching/R4EnvChem/edit/main/src/05-modelling-in-r/02-multiple-linear-models.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/UofTChem-Teaching/R4EnvChem/blob/main/src/05-modelling-in-r/02-multiple-linear-models.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

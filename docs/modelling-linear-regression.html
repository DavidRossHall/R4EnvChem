<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 19 Modelling: Linear Regression | R for Environmental Chemistry</title>
  <meta name="description" content="This is a proof-of-concept for a further full length textbook." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 19 Modelling: Linear Regression | R for Environmental Chemistry" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a proof-of-concept for a further full length textbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 19 Modelling: Linear Regression | R for Environmental Chemistry" />
  
  <meta name="twitter:description" content="This is a proof-of-concept for a further full length textbook." />
  

<meta name="author" content="David Hall, Steven Kutarna, Kristen Yeh, Hui Peng, Chaerin Song, and Jessica D’eon" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="customizing-your-plots.html"/>
<link rel="next" href="augmented-outputs-and-evaluating-your-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.32/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Environmental Chemistry</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#providing-feedback"><i class="fa fa-check"></i>Providing Feedback</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowlegements"><i class="fa fa-check"></i>Acknowlegements</a></li>
</ul></li>
<li class="part"><span><b>Part 1: Getting Started in R</b></span></li>
<li class="chapter" data-level="1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Intro to R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#r-language"><i class="fa fa-check"></i><b>1.1</b> R Language</a></li>
<li class="chapter" data-level="1.2" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#setting-up-your-environment"><i class="fa fa-check"></i><b>1.3</b> Setting Up Your Environment</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#working-remotely-recommended-for-coursework"><i class="fa fa-check"></i><b>1.3.1</b> Working Remotely (Recommended for Coursework)</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#working-locally"><i class="fa fa-check"></i><b>1.3.2</b> Working Locally</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#using-rstudio"><i class="fa fa-check"></i><b>1.4</b> Using RStudio</a></li>
<li class="chapter" data-level="1.5" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#running-r-code"><i class="fa fa-check"></i><b>1.5</b> Running R Code</a></li>
<li class="chapter" data-level="1.6" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#customizing-rstudio"><i class="fa fa-check"></i><b>1.6</b> Customizing RStudio</a></li>
<li class="chapter" data-level="1.7" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#where-to-get-help"><i class="fa fa-check"></i><b>1.7</b> Where to get help</a></li>
<li class="chapter" data-level="1.8" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#summary"><i class="fa fa-check"></i><b>1.8</b> Summary</a></li>
<li class="chapter" data-level="1.9" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#exercise"><i class="fa fa-check"></i><b>1.9</b> Exercise</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#setup"><i class="fa fa-check"></i><b>1.9.1</b> Setup</a></li>
<li class="chapter" data-level="1.9.2" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#basic-r-commands"><i class="fa fa-check"></i><b>1.9.2</b> Basic R Commands</a></li>
<li class="chapter" data-level="1.9.3" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#using-the-help-command"><i class="fa fa-check"></i><b>1.9.3</b> Using the Help Command (<code>?</code>)</a></li>
<li class="chapter" data-level="1.9.4" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#reflection"><i class="fa fa-check"></i><b>1.9.4</b> Reflection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio-projects.html"><a href="rstudio-projects.html"><i class="fa fa-check"></i><b>2</b> RStudio Projects</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rstudio-projects.html"><a href="rstudio-projects.html#uploading-files-to-rstudio-server-on-jupyterhub"><i class="fa fa-check"></i><b>2.1</b> Uploading Files to RStudio server on JupyterHub</a></li>
<li class="chapter" data-level="2.2" data-path="rstudio-projects.html"><a href="rstudio-projects.html#paths-and-directories"><i class="fa fa-check"></i><b>2.2</b> Paths and Directories</a></li>
<li class="chapter" data-level="2.3" data-path="rstudio-projects.html"><a href="rstudio-projects.html#importing-a-project"><i class="fa fa-check"></i><b>2.3</b> Importing a Project</a></li>
<li class="chapter" data-level="2.4" data-path="rstudio-projects.html"><a href="rstudio-projects.html#creating-an-rstudio-project"><i class="fa fa-check"></i><b>2.4</b> Creating an RStudio Project</a></li>
<li class="chapter" data-level="2.5" data-path="rstudio-projects.html"><a href="rstudio-projects.html#a-sneak-peek-at-.rmd-files"><i class="fa fa-check"></i><b>2.5</b> A Sneak Peek at <code>.Rmd</code> Files</a></li>
<li class="chapter" data-level="2.6" data-path="rstudio-projects.html"><a href="rstudio-projects.html#summary-1"><i class="fa fa-check"></i><b>2.6</b> Summary</a></li>
<li class="chapter" data-level="2.7" data-path="rstudio-projects.html"><a href="rstudio-projects.html#exercise-1"><i class="fa fa-check"></i><b>2.7</b> Exercise</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="rstudio-projects.html"><a href="rstudio-projects.html#get-started"><i class="fa fa-check"></i><b>2.7.1</b> Get Started</a></li>
<li class="chapter" data-level="2.7.2" data-path="rstudio-projects.html"><a href="rstudio-projects.html#confirm-your-working-directory"><i class="fa fa-check"></i><b>2.7.2</b> Confirm Your Working Directory</a></li>
<li class="chapter" data-level="2.7.3" data-path="rstudio-projects.html"><a href="rstudio-projects.html#creating-your-own-project"><i class="fa fa-check"></i><b>2.7.3</b> Creating Your Own Project</a></li>
<li class="chapter" data-level="2.7.4" data-path="rstudio-projects.html"><a href="rstudio-projects.html#create-your-rmd-file"><i class="fa fa-check"></i><b>2.7.4</b> Create Your Rmd File</a></li>
<li class="chapter" data-level="2.7.5" data-path="rstudio-projects.html"><a href="rstudio-projects.html#upload-a-file-from-your-computer"><i class="fa fa-check"></i><b>2.7.5</b> Upload a file from your computer</a></li>
<li class="chapter" data-level="2.7.6" data-path="rstudio-projects.html"><a href="rstudio-projects.html#reflection-1"><i class="fa fa-check"></i><b>2.7.6</b> Reflection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html"><i class="fa fa-check"></i><b>3</b> How to Use This Textbook</a>
<ul>
<li class="chapter" data-level="3.1" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#useful-features"><i class="fa fa-check"></i><b>3.1</b> Useful Features</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#searching-the-textbook"><i class="fa fa-check"></i><b>3.1.1</b> Searching the Textbook</a></li>
<li class="chapter" data-level="3.1.2" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#original-r-markdown-of-the-textbook-chapters"><i class="fa fa-check"></i><b>3.1.2</b> Original R Markdown of the Textbook Chapters</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#end-of-chapter-exercises"><i class="fa fa-check"></i><b>3.2</b> End-of-Chapter Exercises</a></li>
</ul></li>
<li class="part"><span><b>Part 2: How to Code in R</b></span></li>
<li class="chapter" data-level="4" data-path="r-coding-basics.html"><a href="r-coding-basics.html"><i class="fa fa-check"></i><b>4</b> R Coding Basics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#variables"><i class="fa fa-check"></i><b>4.1</b> Variables</a></li>
<li class="chapter" data-level="4.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-types"><i class="fa fa-check"></i><b>4.2</b> Data Types</a></li>
<li class="chapter" data-level="4.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-structures"><i class="fa fa-check"></i><b>4.3</b> Data Structures</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-frames"><i class="fa fa-check"></i><b>4.3.1</b> Data Frames</a></li>
<li class="chapter" data-level="4.3.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#accessing-data-in-subfolders"><i class="fa fa-check"></i><b>4.3.2</b> Accessing Data in Subfolders</a></li>
<li class="chapter" data-level="4.3.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#other-data-structures"><i class="fa fa-check"></i><b>4.3.3</b> Other Data Structures</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="r-coding-basics.html"><a href="r-coding-basics.html#conditional-statements"><i class="fa fa-check"></i><b>4.4</b> Conditional Statements</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#understanding-r-syntax"><i class="fa fa-check"></i><b>4.4.1</b> Understanding R Syntax</a></li>
<li class="chapter" data-level="4.4.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#the-basic-if-statement"><i class="fa fa-check"></i><b>4.4.2</b> The Basic <code>if</code> Statement</a></li>
<li class="chapter" data-level="4.4.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#expanding-with-else-and-else-if"><i class="fa fa-check"></i><b>4.4.3</b> Expanding with <code>else</code> and <code>else if</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="r-coding-basics.html"><a href="r-coding-basics.html#r-built-in-functions"><i class="fa fa-check"></i><b>4.5</b> R built-in Functions</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#exploring-more-built-in-functions"><i class="fa fa-check"></i><b>4.5.1</b> Exploring More Built-In Functions</a></li>
<li class="chapter" data-level="4.5.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#function-documentation"><i class="fa fa-check"></i><b>4.5.2</b> Function Documentation</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="r-coding-basics.html"><a href="r-coding-basics.html#summary-2"><i class="fa fa-check"></i><b>4.6</b> Summary</a></li>
<li class="chapter" data-level="4.7" data-path="r-coding-basics.html"><a href="r-coding-basics.html#exercise-2"><i class="fa fa-check"></i><b>4.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html"><i class="fa fa-check"></i><b>5</b> Workflows for R Coding</a>
<ul>
<li class="chapter" data-level="5.1" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#creating-or-opening-an-r-markdown-document"><i class="fa fa-check"></i><b>5.1</b> Creating or opening an R Markdown document</a></li>
<li class="chapter" data-level="5.2" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#workspace-and-whats-real"><i class="fa fa-check"></i><b>5.2</b> Workspace and What’s Real</a></li>
<li class="chapter" data-level="5.3" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#saving-r-markdown"><i class="fa fa-check"></i><b>5.3</b> Saving R Markdown</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#what-should-i-save"><i class="fa fa-check"></i><b>5.3.1</b> What Should I Save?</a></li>
<li class="chapter" data-level="5.3.2" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#saving-data-frames"><i class="fa fa-check"></i><b>5.3.2</b> Saving Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#script-formatting"><i class="fa fa-check"></i><b>5.4</b> Script formatting</a></li>
<li class="chapter" data-level="5.5" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#viewing-data-and-code-simultaneously"><i class="fa fa-check"></i><b>5.5</b> Viewing Data and Code Simultaneously</a></li>
<li class="chapter" data-level="5.6" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#troubleshooting-error-messages"><i class="fa fa-check"></i><b>5.6</b> Troubleshooting Error Messages</a></li>
<li class="chapter" data-level="5.7" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#summary-3"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
<li class="chapter" data-level="5.8" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#exercise-3"><i class="fa fa-check"></i><b>5.8</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="using-r-markdown.html"><a href="using-r-markdown.html"><i class="fa fa-check"></i><b>6</b> Using R Markdown</a>
<ul>
<li class="chapter" data-level="6.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#getting-started-with-r-markdown"><i class="fa fa-check"></i><b>6.1</b> Getting Started with R Markdown</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#understanding-r-markdown"><i class="fa fa-check"></i><b>6.1.1</b> Understanding R Markdown</a></li>
<li class="chapter" data-level="6.1.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#running-code-in-r-markdown"><i class="fa fa-check"></i><b>6.1.2</b> Running Code in R Markdown</a></li>
<li class="chapter" data-level="6.1.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#headings-and-subheadings"><i class="fa fa-check"></i><b>6.1.3</b> Headings and Subheadings</a></li>
<li class="chapter" data-level="6.1.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#latex-basics"><i class="fa fa-check"></i><b>6.1.4</b> LaTeX Basics</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#compiling-your-final-report"><i class="fa fa-check"></i><b>6.2</b> Compiling your final report</a></li>
<li class="chapter" data-level="6.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#authoring-with-r-markdown"><i class="fa fa-check"></i><b>6.3</b> Authoring with R Markdown</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-markdown-syntax"><i class="fa fa-check"></i><b>6.3.1</b> R Markdown Syntax</a></li>
<li class="chapter" data-level="6.3.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-code-chunk-options"><i class="fa fa-check"></i><b>6.3.2</b> R Code Chunk Options</a></li>
<li class="chapter" data-level="6.3.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#inserting-images"><i class="fa fa-check"></i><b>6.3.3</b> Inserting images</a></li>
<li class="chapter" data-level="6.3.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#generating-tables"><i class="fa fa-check"></i><b>6.3.4</b> Generating tables</a></li>
<li class="chapter" data-level="6.3.5" data-path="using-r-markdown.html"><a href="using-r-markdown.html#spellcheck-in-r-markdown"><i class="fa fa-check"></i><b>6.3.5</b> Spellcheck in R Markdown</a></li>
<li class="chapter" data-level="6.3.6" data-path="using-r-markdown.html"><a href="using-r-markdown.html#exporting-r-markdown-documents"><i class="fa fa-check"></i><b>6.3.6</b> Exporting R Markdown documents</a></li>
<li class="chapter" data-level="6.3.7" data-path="using-r-markdown.html"><a href="using-r-markdown.html#rstudio-tips-and-tricks"><i class="fa fa-check"></i><b>6.3.7</b> RStudio tips and tricks</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-markdown-resources"><i class="fa fa-check"></i><b>6.4</b> R Markdown resources</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>7</b> R Packages</a>
<ul>
<li class="chapter" data-level="7.1" data-path="r-packages.html"><a href="r-packages.html#what-are-r-packages"><i class="fa fa-check"></i><b>7.1</b> What are R packages?</a></li>
<li class="chapter" data-level="7.2" data-path="r-packages.html"><a href="r-packages.html#how-to-use-r-packages"><i class="fa fa-check"></i><b>7.2</b> How to use R packages</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="r-packages.html"><a href="r-packages.html#how-to-install-packages"><i class="fa fa-check"></i><b>7.2.1</b> How to install packages</a></li>
<li class="chapter" data-level="7.2.2" data-path="r-packages.html"><a href="r-packages.html#how-to-load-packages"><i class="fa fa-check"></i><b>7.2.2</b> How to load packages</a></li>
<li class="chapter" data-level="7.2.3" data-path="r-packages.html"><a href="r-packages.html#calling-specific-functions"><i class="fa fa-check"></i><b>7.2.3</b> Calling specific functions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="r-packages.html"><a href="r-packages.html#tidyverse-the-golden-toolbox-of-r"><i class="fa fa-check"></i><b>7.3</b> Tidyverse: The Golden Toolbox of R</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="r-packages.html"><a href="r-packages.html#loading-the-tidyverse"><i class="fa fa-check"></i><b>7.3.1</b> Loading the Tidyverse</a></li>
<li class="chapter" data-level="7.3.2" data-path="r-packages.html"><a href="r-packages.html#data-visualization"><i class="fa fa-check"></i><b>7.3.2</b> Data Visualization</a></li>
<li class="chapter" data-level="7.3.3" data-path="r-packages.html"><a href="r-packages.html#data-manipulation"><i class="fa fa-check"></i><b>7.3.3</b> Data Manipulation</a></li>
<li class="chapter" data-level="7.3.4" data-path="r-packages.html"><a href="r-packages.html#efficient-data-reading"><i class="fa fa-check"></i><b>7.3.4</b> Efficient Data Reading</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="r-packages.html"><a href="r-packages.html#summary-4"><i class="fa fa-check"></i><b>7.4</b> Summary</a></li>
<li class="chapter" data-level="7.5" data-path="r-packages.html"><a href="r-packages.html#exercise-4"><i class="fa fa-check"></i><b>7.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="loops-and-functions-in-r.html"><a href="loops-and-functions-in-r.html"><i class="fa fa-check"></i><b>8</b> Loops and Functions in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="loops-and-functions-in-r.html"><a href="loops-and-functions-in-r.html#loops"><i class="fa fa-check"></i><b>8.1</b> Loops</a></li>
<li class="chapter" data-level="8.2" data-path="loops-and-functions-in-r.html"><a href="loops-and-functions-in-r.html#writing-custom-functions-in-r"><i class="fa fa-check"></i><b>8.2</b> Writing custom functions in R</a></li>
<li class="chapter" data-level="8.3" data-path="loops-and-functions-in-r.html"><a href="loops-and-functions-in-r.html#further_reading_chapter8"><i class="fa fa-check"></i><b>8.3</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>Part 3: Data Analysis in R</b></span></li>
<li class="chapter" data-level="9" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html"><i class="fa fa-check"></i><b>9</b> Intro to Data Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#example-data"><i class="fa fa-check"></i><b>9.1</b> Example Data</a></li>
<li class="chapter" data-level="9.2" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#sneak-peek-at-data-analysis"><i class="fa fa-check"></i><b>9.2</b> Sneak Peek at Data Analysis</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#setting-up"><i class="fa fa-check"></i><b>9.2.1</b> Setting Up</a></li>
<li class="chapter" data-level="9.2.2" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#tidying-our-data"><i class="fa fa-check"></i><b>9.2.2</b> Tidying Our Data</a></li>
<li class="chapter" data-level="9.2.3" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#investigating-storm-patterns"><i class="fa fa-check"></i><b>9.2.3</b> Investigating Storm Patterns</a></li>
<li class="chapter" data-level="9.2.4" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#visualization-geographical-distribution"><i class="fa fa-check"></i><b>9.2.4</b> Visualization: Geographical Distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#further_reading_chapter9"><i class="fa fa-check"></i><b>9.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html"><i class="fa fa-check"></i><b>10</b> Importing Your Data Into R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#csv-files"><i class="fa fa-check"></i><b>10.1</b> csv files</a></li>
<li class="chapter" data-level="10.2" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#read_csv"><i class="fa fa-check"></i><b>10.2</b> <code>read_csv</code></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#tibbles-vs.-data-frames"><i class="fa fa-check"></i><b>10.2.1</b> Tibbles vs. data frames</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#importing-other-data-types"><i class="fa fa-check"></i><b>10.3</b> Importing other data types</a></li>
<li class="chapter" data-level="10.4" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#saving-data"><i class="fa fa-check"></i><b>10.4</b> Saving data</a></li>
<li class="chapter" data-level="10.5" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#further_reading_chapter10"><i class="fa fa-check"></i><b>10.5</b> Further Reading</a></li>
<li class="chapter" data-level="10.6" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#exercise-5"><i class="fa fa-check"></i><b>10.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="tidying-your-data.html"><a href="tidying-your-data.html"><i class="fa fa-check"></i><b>11</b> Tidying Your Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="tidying-your-data.html"><a href="tidying-your-data.html#what-is-tidy-data"><i class="fa fa-check"></i><b>11.1</b> What is tidy data?</a></li>
<li class="chapter" data-level="11.2" data-path="tidying-your-data.html"><a href="tidying-your-data.html#tools-to-tidy-your-data"><i class="fa fa-check"></i><b>11.2</b> Tools to tidy your data</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="tidying-your-data.html"><a href="tidying-your-data.html#selection-helpers"><i class="fa fa-check"></i><b>11.2.1</b> Selection helpers</a></li>
<li class="chapter" data-level="11.2.2" data-path="tidying-your-data.html"><a href="tidying-your-data.html#separating-columns"><i class="fa fa-check"></i><b>11.2.2</b> Separating columns</a></li>
<li class="chapter" data-level="11.2.3" data-path="tidying-your-data.html"><a href="tidying-your-data.html#unitingcombining-columns"><i class="fa fa-check"></i><b>11.2.3</b> Uniting/combining columns</a></li>
<li class="chapter" data-level="11.2.4" data-path="tidying-your-data.html"><a href="tidying-your-data.html#renaming-columnsheaders"><i class="fa fa-check"></i><b>11.2.4</b> Renaming columns/headers</a></li>
<li class="chapter" data-level="11.2.5" data-path="tidying-your-data.html"><a href="tidying-your-data.html#chaining-multiple-operations"><i class="fa fa-check"></i><b>11.2.5</b> Chaining multiple operations</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="tidying-your-data.html"><a href="tidying-your-data.html#tips-for-recording-data"><i class="fa fa-check"></i><b>11.3</b> Tips for recording data</a></li>
<li class="chapter" data-level="11.4" data-path="tidying-your-data.html"><a href="tidying-your-data.html#further_reading_chapter11"><i class="fa fa-check"></i><b>11.4</b> Further reading</a></li>
<li class="chapter" data-level="11.5" data-path="tidying-your-data.html"><a href="tidying-your-data.html#chapter-references"><i class="fa fa-check"></i><b>11.5</b> Chapter References</a></li>
<li class="chapter" data-level="11.6" data-path="tidying-your-data.html"><a href="tidying-your-data.html#exercise-6"><i class="fa fa-check"></i><b>11.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html"><i class="fa fa-check"></i><b>12</b> Transform: Data Manipulation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#selecting-by-row-or-value"><i class="fa fa-check"></i><b>12.1</b> Selecting by row or value</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#logical-operators"><i class="fa fa-check"></i><b>12.1.1</b> Logical operators</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#arranging-rows"><i class="fa fa-check"></i><b>12.2</b> Arranging rows</a></li>
<li class="chapter" data-level="12.3" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#selecting-column-name"><i class="fa fa-check"></i><b>12.3</b> Selecting column name</a></li>
<li class="chapter" data-level="12.4" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#deleting-columns-or-rows"><i class="fa fa-check"></i><b>12.4</b> Deleting Columns or Rows</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#deleting-columns"><i class="fa fa-check"></i><b>12.4.1</b> Deleting columns</a></li>
<li class="chapter" data-level="12.4.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#deleting-rows"><i class="fa fa-check"></i><b>12.4.2</b> Deleting rows</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#adding-new-variables"><i class="fa fa-check"></i><b>12.5</b> Adding new variables</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#mutate-with-a-condition"><i class="fa fa-check"></i><b>12.5.1</b> Mutate with a condition</a></li>
<li class="chapter" data-level="12.5.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#useful-mutate-function"><i class="fa fa-check"></i><b>12.5.2</b> Useful mutate function</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#group-and-summarize-data"><i class="fa fa-check"></i><b>12.6</b> Group and summarize data</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#useful-summarize-functions"><i class="fa fa-check"></i><b>12.6.1</b> Useful summarize functions</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#the-pipe-chaining-functions-together"><i class="fa fa-check"></i><b>12.7</b> The Pipe: Chaining Functions Together</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#notes-on-piping"><i class="fa fa-check"></i><b>12.7.1</b> Notes on piping</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#further_reading_chapter12"><i class="fa fa-check"></i><b>12.8</b> Further reading</a></li>
<li class="chapter" data-level="12.9" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#exercise-7"><i class="fa fa-check"></i><b>12.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html"><i class="fa fa-check"></i><b>13</b> Ggplot Basic Visualizations</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#building-plots-ups"><i class="fa fa-check"></i><b>13.1</b> Building plots ups</a></li>
<li class="chapter" data-level="13.2" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#basic-plotting"><i class="fa fa-check"></i><b>13.2</b> Basic plotting</a></li>
<li class="chapter" data-level="13.3" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#changing-plot-labels"><i class="fa fa-check"></i><b>13.3</b> Changing plot labels</a></li>
<li class="chapter" data-level="13.4" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#small-multiples"><i class="fa fa-check"></i><b>13.4</b> Small Multiples</a></li>
<li class="chapter" data-level="13.5" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#plotting-subsets-of-data"><i class="fa fa-check"></i><b>13.5</b> Plotting subsets of data</a></li>
<li class="chapter" data-level="13.6" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#exercise-8"><i class="fa fa-check"></i><b>13.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>14</b> Summarizing Data</a>
<ul>
<li class="chapter" data-level="14.1" data-path="summarizing-data.html"><a href="summarizing-data.html#data-to-play-with"><i class="fa fa-check"></i><b>14.1</b> Data to Play With</a></li>
<li class="chapter" data-level="14.2" data-path="summarizing-data.html"><a href="summarizing-data.html#summarizing-data-by-group"><i class="fa fa-check"></i><b>14.2</b> Summarizing Data by Group</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#further-summarize-operations"><i class="fa fa-check"></i><b>14.2.1</b> Further Summarize Operations</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="summarizing-data.html"><a href="summarizing-data.html#pretty-tables-with-flextable"><i class="fa fa-check"></i><b>14.3</b> Pretty Tables with Flextable</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#uniting-columns"><i class="fa fa-check"></i><b>14.3.1</b> Uniting columns</a></li>
<li class="chapter" data-level="14.3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#pretty-tables"><i class="fa fa-check"></i><b>14.3.2</b> Pretty tables</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="summarizing-data.html"><a href="summarizing-data.html#exercise-9"><i class="fa fa-check"></i><b>14.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html"><i class="fa fa-check"></i><b>15</b> Restructuring Your Data</a>
<ul>
<li class="chapter" data-level="15.1" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#long-vs-wide-data"><i class="fa fa-check"></i><b>15.1</b> Long vs Wide Data</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#long-data"><i class="fa fa-check"></i><b>15.1.1</b> Long Data</a></li>
<li class="chapter" data-level="15.1.2" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#wide-data"><i class="fa fa-check"></i><b>15.1.2</b> Wide Data</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#making-data-longer"><i class="fa fa-check"></i><b>15.2</b> Making Data Longer</a></li>
<li class="chapter" data-level="15.3" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#making-data-wider"><i class="fa fa-check"></i><b>15.3</b> Making Data Wider</a></li>
<li class="chapter" data-level="15.4" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#summary-5"><i class="fa fa-check"></i><b>15.4</b> Summary</a></li>
<li class="chapter" data-level="15.5" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#further_reading_chapter15"><i class="fa fa-check"></i><b>15.5</b> Further reading</a></li>
<li class="chapter" data-level="15.6" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#exercise-10"><i class="fa fa-check"></i><b>15.6</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>Part 4: Visualization in R</b></span></li>
<li class="chapter" data-level="16" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html"><i class="fa fa-check"></i><b>16</b> Visualizations for Env Chem</a>
<ul>
<li class="chapter" data-level="16.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#discrete-vs.-continuous-variables"><i class="fa fa-check"></i><b>16.1</b> Discrete vs. Continuous variables</a></li>
<li class="chapter" data-level="16.2" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#prerequisites"><i class="fa fa-check"></i><b>16.2</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html"><i class="fa fa-check"></i><b>17</b> Common Types of Graphs</a>
<ul>
<li class="chapter" data-level="17.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#bar-charts"><i class="fa fa-check"></i><b>17.1</b> Bar Charts</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#adding-error-bars"><i class="fa fa-check"></i><b>17.1.1</b> Adding Error Bars</a></li>
<li class="chapter" data-level="17.1.2" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#ordering-bar-charts"><i class="fa fa-check"></i><b>17.1.2</b> Ordering Bar Charts</a></li>
<li class="chapter" data-level="17.1.3" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#grouping-bar-charts"><i class="fa fa-check"></i><b>17.1.3</b> Grouping Bar Charts</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#box-plots"><i class="fa fa-check"></i><b>17.2</b> Box Plots</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#violin-plots"><i class="fa fa-check"></i><b>17.2.1</b> Violin Plots</a></li>
<li class="chapter" data-level="17.2.2" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#statistical-comparisons-between-groups"><i class="fa fa-check"></i><b>17.2.2</b> Statistical Comparisons Between Groups</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#histograms"><i class="fa fa-check"></i><b>17.3</b> Histograms</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#multiple-histograms"><i class="fa fa-check"></i><b>17.3.1</b> Multiple histograms</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#scatter-plots"><i class="fa fa-check"></i><b>17.4</b> Scatter Plots</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#marginal-plots"><i class="fa fa-check"></i><b>17.4.1</b> Marginal plots</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#exercise-11"><i class="fa fa-check"></i><b>17.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html"><i class="fa fa-check"></i><b>18</b> Customizing your plots</a>
<ul>
<li class="chapter" data-level="18.1" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#interactive-plots"><i class="fa fa-check"></i><b>18.1</b> Interactive Plots</a></li>
<li class="chapter" data-level="18.2" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#plot-themes"><i class="fa fa-check"></i><b>18.2</b> Plot Themes</a></li>
<li class="chapter" data-level="18.3" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#legends"><i class="fa fa-check"></i><b>18.3</b> Legends</a></li>
<li class="chapter" data-level="18.4" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#modifying-labels"><i class="fa fa-check"></i><b>18.4</b> Modifying labels</a></li>
<li class="chapter" data-level="18.5" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#modifying-axis"><i class="fa fa-check"></i><b>18.5</b> Modifying Axis</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#transforming-axis"><i class="fa fa-check"></i><b>18.5.1</b> Transforming axis</a></li>
<li class="chapter" data-level="18.5.2" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#limits"><i class="fa fa-check"></i><b>18.5.2</b> Limits</a></li>
<li class="chapter" data-level="18.5.3" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#axis-tickslabels"><i class="fa fa-check"></i><b>18.5.3</b> Axis ticks/labels</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#arranging-plots"><i class="fa fa-check"></i><b>18.6</b> Arranging plots</a></li>
<li class="chapter" data-level="18.7" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#exercise-12"><i class="fa fa-check"></i><b>18.7</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>Part 5: Modelling in R</b></span></li>
<li class="chapter" data-level="19" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html"><i class="fa fa-check"></i><b>19</b> Modelling: Linear Regression</a>
<ul>
<li class="chapter" data-level="19.1" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#modelling-theory"><i class="fa fa-check"></i><b>19.1</b> Modelling Theory</a></li>
<li class="chapter" data-level="19.2" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#linear-regression-in-r"><i class="fa fa-check"></i><b>19.2</b> Linear Regression in R</a></li>
<li class="chapter" data-level="19.3" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#building-multiple-linear-regressions"><i class="fa fa-check"></i><b>19.3</b> Building Multiple Linear Regressions</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#dataset"><i class="fa fa-check"></i><b>19.3.1</b> Dataset</a></li>
<li class="chapter" data-level="19.3.2" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#building-a-linear-regression-for-each-analyte"><i class="fa fa-check"></i><b>19.3.2</b> Building a Linear Regression for Each Analyte</a></li>
<li class="chapter" data-level="19.3.3" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#table-with-slopes-intercepts-and-r2"><i class="fa fa-check"></i><b>19.3.3</b> Table with Slopes, Intercepts, and <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#calculating-concentration-using-the-regression-variables"><i class="fa fa-check"></i><b>19.4</b> Calculating Concentration Using the Regression Variables</a></li>
<li class="chapter" data-level="19.5" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#conclusion"><i class="fa fa-check"></i><b>19.5</b> Conclusion</a></li>
<li class="chapter" data-level="19.6" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#further_reading_chapter19"><i class="fa fa-check"></i><b>19.6</b> Further reading</a></li>
<li class="chapter" data-level="19.7" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#exercise-13"><i class="fa fa-check"></i><b>19.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html"><i class="fa fa-check"></i><b>20</b> Augmented Outputs and Evaluating Your Model</a>
<ul>
<li class="chapter" data-level="20.1" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#cleaning-up-model-ouputs"><i class="fa fa-check"></i><b>20.1</b> Cleaning up Model Ouputs</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#glanced-outputs"><i class="fa fa-check"></i><b>20.1.1</b> Glanced Outputs</a></li>
<li class="chapter" data-level="20.1.2" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#tidied-outputs"><i class="fa fa-check"></i><b>20.1.2</b> Tidied Outputs</a></li>
<li class="chapter" data-level="20.1.3" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#augmented-outputs"><i class="fa fa-check"></i><b>20.1.3</b> Augmented Outputs</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#incorporating-weights-into-your-model"><i class="fa fa-check"></i><b>20.2</b> Incorporating Weights into your Model</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#why-we-approach-modelling-this-way"><i class="fa fa-check"></i><b>20.2.1</b> Why we approach modelling this way</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#visualizing-models"><i class="fa fa-check"></i><b>20.3</b> Visualizing models</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#visualizing-residuals"><i class="fa fa-check"></i><b>20.3.1</b> Visualizing residuals</a></li>
<li class="chapter" data-level="20.3.2" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#plotting-residuals"><i class="fa fa-check"></i><b>20.3.2</b> Plotting residuals</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#calculating-concentrations-from-the-augmented-outputs"><i class="fa fa-check"></i><b>20.4</b> Calculating Concentrations from the Augmented Outputs</a></li>
<li class="chapter" data-level="20.5" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#exercise-14"><i class="fa fa-check"></i><b>20.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html"><i class="fa fa-check"></i><b>21</b> Modelling: Non-Linear Regression</a>
<ul>
<li class="chapter" data-level="21.1" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#experimental-background"><i class="fa fa-check"></i><b>21.1</b> Experimental Background</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#annotating-maximal-values"><i class="fa fa-check"></i><b>21.1.1</b> Annotating maximal values</a></li>
<li class="chapter" data-level="21.1.2" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#extracting-maximal-values"><i class="fa fa-check"></i><b>21.1.2</b> Extracting maximal values</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#modelling-sigmoid-curve"><i class="fa fa-check"></i><b>21.2</b> Modelling Sigmoid Curve</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#calculating-logistic-regression"><i class="fa fa-check"></i><b>21.2.1</b> Calculating Logistic Regression</a></li>
<li class="chapter" data-level="21.2.2" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#extracting-model-parameters"><i class="fa fa-check"></i><b>21.2.2</b> Extracting model parameters</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#summary-6"><i class="fa fa-check"></i><b>21.3</b> Summary</a></li>
<li class="chapter" data-level="21.4" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#exercise-15"><i class="fa fa-check"></i><b>21.4</b> Exercise</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Environmental Chemistry</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelling-linear-regression" class="section level1 hasAnchor" number="19">
<h1><span class="header-section-number">Chapter 19</span> Modelling: Linear Regression<a href="modelling-linear-regression.html#modelling-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Modelling is basically math used to describe some type of system, and they are a forte of R, a language tailor made for statistical computing. Every model has assumptions, limitations, and all around tricky bits to working. There is no shortage of modelling in a myriad of contexts, but in this chapter we’ll discuss and break down the most common model you’ll encounter, the <em>linear regression model</em>, in the most common context, the <em>linear calibration model</em>, using the most common function, <code>lm()</code>.</p>
<p>You have probably encountered the linear regression model under the pseudonym “trend-lines”, most likely generated by <em>Excel</em>’s “add trend-line option” (as in CHM135). While the models we’ll be constructing with <code>lm()</code> work much the same <em>mathematically</em>, unlike <em>Excel</em>, R returns <em>all</em> of the model outputs. Correspondingly, it’s easy to get lost between juggling R code, the seemingly endless model outputs, and keeping yourself grounded in the real systems you’re attempting to model.</p>
<div id="modelling-theory" class="section level2 hasAnchor" number="19.1">
<h2><span class="header-section-number">19.1</span> Modelling Theory<a href="modelling-linear-regression.html#modelling-theory" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <em>linear calibration model</em> relates the response of an instrument to the value of the <em>measurand</em>. The measurand is simply what we’re measuring, often the concentration of an analyte. So we use the measurand, which we can control via preparation of standards from reference material as the <em>independent</em> variable, with the instrument output being the <em>dependent</em> variable (as instrument response varies with concentration). Altogether we’re:</p>
<ol style="list-style-type: decimal">
<li>Measuring the instrument response of standards of known concentration and samples of unknowns concentration.</li>
<li>Calculating the linear calibration model (i.e. line of best fit) through our standards.</li>
<li>Using the measurement model to calculate the concentration in our unknown from their respective instrument response.</li>
</ol>
<div class="figure"><span style="display:block;" id="fig:reg-plot"></span>
<img src="R4EnvChem_files/figure-html/reg-plot-1.png" alt="Linear calibration model; figure modified from Hibbert and Gooding (2006)." width="672" />
<p class="caption">
Figure 19.1: Linear calibration model; figure modified from Hibbert and Gooding (2006).
</p>
</div>
<p>Before we can calculate concentrations, we need a measurement model. In other words, an equation that relates instrument response to sample concentration (or other factors). For simple linear calibration, we use:</p>
<p><span class="math display">\[ y = a + bx\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(y\)</span> is the instrument response</li>
<li><span class="math inline">\(x\)</span> is the independent variable (i.e. sample concentration)</li>
<li><span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are the coefficients of the model; otherwise known as intercept and slope, respectively.</li>
</ul>
<p>We’ll gloss over some of the more technical aspects of modelling, and discuss other in more detail below. For now, know that:</p>
<ul>
<li>We’re assuming our linear model is correct (i.e. the instruments actually respond linearly to concentration).</li>
<li>All uncertainties reside in the dependant variable <span class="math inline">\(y\)</span> (i.e. no errors in preparation of the standards).</li>
<li>The values of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are determined by minimizing the <em>sum of the residuals squared</em>.
<ul>
<li>The residuals are the difference between the actual measured response and where it would be if it were on the calibration line.</li>
</ul></li>
</ul>
<p>Once we have our line of best fit, we can calculate the concentration of our unknown sample <span class="math inline">\(i\)</span>, from it’s measured response <span class="math inline">\(y_i\)</span> by:</p>
<p><span class="math display">\[ x_i = \frac{y_i ~-~b}{a}\]</span></p>
<p>There is more going on under the hood than what we’re describing here, but this should be enough to get you up and running. If you would like a greater breakdown of linear calibration modelling, we suggest you read Chapter 5 of <em>Data Analysis for Chemistry</em> by Hibbert and Gooding. An online version is accessible via the University of Toronto’s Library. Also there is no reason the instrument response must be linear. In fact, we spend a great deal of time arranging our experiment to that we land in the ‘linear range’. For details on non-linear modelling in R see <a href="modelling-non-linear-regression.html#modelling-non-linear-regression">Modelling: Non-Linear Regression</a></p>
</div>
<div id="linear-regression-in-r" class="section level2 hasAnchor" number="19.2">
<h2><span class="header-section-number">19.2</span> Linear Regression in R<a href="modelling-linear-regression.html#linear-regression-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have a rough understanding of what we’re trying to do, let’s go over <em>how</em> to calculate linear regression models in R. Note model is a general term, in this situation we’ll be calculating a <strong>calibration curve</strong>. All calibration curves are models, but not all models are calibration curves.</p>
<p>For our example dataset we’ll import a dataset consisting of four analytical standards of sodium plus a calibration blank all run in triplicate. The standards were measured via flame atomic emission spectroscopy (FAES). Let’s import the FAES calibration results we saw in <a href="transform-data-manipulation.html#transform-data-manipulation">Transform: Data manipulation</a>. As we’ve already seen, our data is composed of four standards and a blank analyzed in triplicate. Since we’re focusing on modelling, <em>we’ll treat the blank as a standard in our model fitting</em>. So let’s import our dataset:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="modelling-linear-regression.html#cb257-1" tabindex="-1"></a><span class="co"># Importing using tips from Import chapter</span></span>
<span id="cb257-2"><a href="modelling-linear-regression.html#cb257-2" tabindex="-1"></a></span>
<span id="cb257-3"><a href="modelling-linear-regression.html#cb257-3" tabindex="-1"></a>FAES <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">&quot;data/FAES_original_wide.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb257-4"><a href="modelling-linear-regression.html#cb257-4" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>std_Na_conc,</span>
<span id="cb257-5"><a href="modelling-linear-regression.html#cb257-5" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;replicate&quot;</span>, </span>
<span id="cb257-6"><a href="modelling-linear-regression.html#cb257-6" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;reading_&quot;</span>,</span>
<span id="cb257-7"><a href="modelling-linear-regression.html#cb257-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;signal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb257-8"><a href="modelling-linear-regression.html#cb257-8" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> std_Na_conc,</span>
<span id="cb257-9"><a href="modelling-linear-regression.html#cb257-9" tabindex="-1"></a>           <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;type&quot;</span>, <span class="st">&quot;conc_Na&quot;</span>, <span class="st">&quot;units&quot;</span>),</span>
<span id="cb257-10"><a href="modelling-linear-regression.html#cb257-10" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">&quot; &quot;</span>,</span>
<span id="cb257-11"><a href="modelling-linear-regression.html#cb257-11" tabindex="-1"></a>           <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb257-12"><a href="modelling-linear-regression.html#cb257-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">&quot;standard&quot;</span>)</span>
<span id="cb257-13"><a href="modelling-linear-regression.html#cb257-13" tabindex="-1"></a></span>
<span id="cb257-14"><a href="modelling-linear-regression.html#cb257-14" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(FAES)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-fb79221e49c2b4e509e3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-fb79221e49c2b4e509e3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard","standard"],[0,0,0,0.1,0.1,0.1,0.2,0.2,0.2,0.5,0.5,0.5,1,1,1],["ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm","ppm"],["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],[502.3391,591.7768,581.4588,5656.342,5653.5584,5667.4387,9393.4167,9362.685799999999,9332.049800000001,20186.9033,20140.5115,20152.9856,30797.6935,30836.5239,30789.8266]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>type<\/th>\n      <th>conc_Na<\/th>\n      <th>units<\/th>\n      <th>replicate<\/th>\n      <th>signal<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"type","targets":1},{"name":"conc_Na","targets":2},{"name":"units","targets":3},{"name":"replicate","targets":4},{"name":"signal","targets":5}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>And let’s quickly plot our data. You should always visualize your data before modelling, especially for linear calibration modelling. Visualizing your data is an easy way to spot trends and gross errors in your data.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="modelling-linear-regression.html#cb258-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> FAES,</span>
<span id="cb258-2"><a href="modelling-linear-regression.html#cb258-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc_Na, </span>
<span id="cb258-3"><a href="modelling-linear-regression.html#cb258-3" tabindex="-1"></a>           <span class="at">y =</span> signal)) <span class="sc">+</span></span>
<span id="cb258-4"><a href="modelling-linear-regression.html#cb258-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-158-1.png" width="672" /></p>
<p>R’s base <code>lm()</code> function for linear regression is excellent, but its outputs have some messy quirks. It’s easier to show that, so let’s calculate the linear relationship between the <code>signal</code> as a function of <code>conc_Na</code>:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="modelling-linear-regression.html#cb259-1" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(signal <span class="sc">~</span> conc_Na, <span class="at">data =</span> FAES)</span>
<span id="cb259-2"><a href="modelling-linear-regression.html#cb259-2" tabindex="-1"></a>lm_fit</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = signal ~ conc_Na, data = FAES)
## 
## Coefficients:
## (Intercept)      conc_Na  
##        2615        29707</code></pre>
<p>Reading the code above (recall that we’re reading it from <em>right to left</em> because it’s base R):</p>
<ol style="list-style-type: decimal">
<li>We’re taking the FAES data we created earlier; <code>data = FAES</code></li>
<li>We’re comparing <code>signal</code> (the dependent, y, variable) to <code>conc_Na</code> (the independent, x, variable) via the tilde <code>~</code>. The way to read this is: <em>“Signal depends on concentration”</em>.</li>
<li>We’re comparing these two variables using the <code>lm()</code> function for generalized linear models.</li>
<li>All of the model outputs are stored in the <code>lm_fit</code> variable.</li>
</ol>
<p>As we can see, the model outputs are pretty brief and not much more than <em>Excel</em>’s outputs. We can use <code>summary()</code> to extract more information to better understand our model:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="modelling-linear-regression.html#cb261-1" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = signal ~ conc_Na, data = FAES)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2112.78 -1528.53    70.51   821.50  2718.20 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2615.1      665.2   3.931  0.00172 ** 
## conc_Na      29707.2     1304.5  22.772 7.34e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1824 on 13 degrees of freedom
## Multiple R-squared:  0.9755, Adjusted R-squared:  0.9737 
## F-statistic: 518.6 on 1 and 13 DF,  p-value: 7.341e-12</code></pre>
<p>Now we have a lot more information from our model, including the slope and intercept with their corresponding standard error as well as the <span class="math inline">\(R^2\)</span> value.</p>
</div>
<div id="building-multiple-linear-regressions" class="section level2 hasAnchor" number="19.3">
<h2><span class="header-section-number">19.3</span> Building Multiple Linear Regressions<a href="modelling-linear-regression.html#building-multiple-linear-regressions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, we will delve into the world of multiple linear regressions, where we extend our analysis beyond single analytes to situation that arises often where you have mixed calibration standards that contain multiple analytes.</p>
<div id="dataset" class="section level3 hasAnchor" number="19.3.1">
<h3><span class="header-section-number">19.3.1</span> Dataset<a href="modelling-linear-regression.html#dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The dataset <code>metal_conc</code> contains information on metal concentrations measured in parts per million, or ppm, and corresponding signal values (counts per seconds, or cps) from the inductively coupled plasma optical emission spectrometer (ICP-OES) in ANALEST for 4 metals: Aluminum, Magnesium, Calcium, and Potassium. Take a look at the data before proceeding with our analysis:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="modelling-linear-regression.html#cb263-1" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb263-2"><a href="modelling-linear-regression.html#cb263-2" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb263-3"><a href="modelling-linear-regression.html#cb263-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb263-4"><a href="modelling-linear-regression.html#cb263-4" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb263-5"><a href="modelling-linear-regression.html#cb263-5" tabindex="-1"></a></span>
<span id="cb263-6"><a href="modelling-linear-regression.html#cb263-6" tabindex="-1"></a><span class="co"># Read the CSV file</span></span>
<span id="cb263-7"><a href="modelling-linear-regression.html#cb263-7" tabindex="-1"></a>metal_conc <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/metal_concentration.csv&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb263-8"><a href="modelling-linear-regression.html#cb263-8" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(metal_conc)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-eff127467ede2221f542" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-eff127467ede2221f542">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9"],[0,0.1,0.2,0.5,1,2,5,10,20],[47.65207368,673.4280116,494.1924593,3157.461024,6335.077694,6811.151416,16076.05919,43769.88816,64355.35576],[914.8524097,23385.88006,16761.39292,110265.1634,218215.4232,240584.101,566487.8196,1680164.492,2657633.941],[22868.85176,73552.11119,59952.89462,326889.3515,644500.0469,718761.2804,1673552.82,4693083.579,7325418.786],[69.67488883999999,11295.97549,8360.64947,62071.05546,140788.3763,161124.7635,440977.7838,1490964.321,2617456.722]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Concentration<\/th>\n      <th>Al<\/th>\n      <th>Mg<\/th>\n      <th>Ca<\/th>\n      <th>K<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Concentration","targets":1},{"name":"Al","targets":2},{"name":"Mg","targets":3},{"name":"Ca","targets":4},{"name":"K","targets":5}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="building-a-linear-regression-for-each-analyte" class="section level3 hasAnchor" number="19.3.2">
<h3><span class="header-section-number">19.3.2</span> Building a Linear Regression for Each Analyte<a href="modelling-linear-regression.html#building-a-linear-regression-for-each-analyte" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, we will build separate linear regression models for each metal to predict signal values based on metal concentrations.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="modelling-linear-regression.html#cb264-1" tabindex="-1"></a><span class="co"># Create a list to store slope and intercept for each metal</span></span>
<span id="cb264-2"><a href="modelling-linear-regression.html#cb264-2" tabindex="-1"></a>metal_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb264-3"><a href="modelling-linear-regression.html#cb264-3" tabindex="-1"></a></span>
<span id="cb264-4"><a href="modelling-linear-regression.html#cb264-4" tabindex="-1"></a><span class="co"># Iterate over each metal</span></span>
<span id="cb264-5"><a href="modelling-linear-regression.html#cb264-5" tabindex="-1"></a><span class="cf">for</span> (metal <span class="cf">in</span> <span class="fu">colnames</span>(metal_conc)[<span class="sc">-</span><span class="dv">1</span>]) {</span>
<span id="cb264-6"><a href="modelling-linear-regression.html#cb264-6" tabindex="-1"></a>  <span class="co"># Build linear regression model</span></span>
<span id="cb264-7"><a href="modelling-linear-regression.html#cb264-7" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(metal_conc[[metal]] <span class="sc">~</span> metal_conc[[<span class="st">&quot;Concentration&quot;</span>]], <span class="at">data =</span> metal_conc)</span>
<span id="cb264-8"><a href="modelling-linear-regression.html#cb264-8" tabindex="-1"></a>  </span>
<span id="cb264-9"><a href="modelling-linear-regression.html#cb264-9" tabindex="-1"></a>  <span class="co"># Extract slope and intercept</span></span>
<span id="cb264-10"><a href="modelling-linear-regression.html#cb264-10" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)[<span class="dv">2</span>]</span>
<span id="cb264-11"><a href="modelling-linear-regression.html#cb264-11" tabindex="-1"></a>  intercept <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)[<span class="dv">1</span>]</span>
<span id="cb264-12"><a href="modelling-linear-regression.html#cb264-12" tabindex="-1"></a>  r_squared <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span>
<span id="cb264-13"><a href="modelling-linear-regression.html#cb264-13" tabindex="-1"></a></span>
<span id="cb264-14"><a href="modelling-linear-regression.html#cb264-14" tabindex="-1"></a>  </span>
<span id="cb264-15"><a href="modelling-linear-regression.html#cb264-15" tabindex="-1"></a>  <span class="co"># Print slope and intercept</span></span>
<span id="cb264-16"><a href="modelling-linear-regression.html#cb264-16" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;For:&quot;</span>, metal, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb264-17"><a href="modelling-linear-regression.html#cb264-17" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Slope:&quot;</span>, slope, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb264-18"><a href="modelling-linear-regression.html#cb264-18" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Intercept:&quot;</span>, intercept, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb264-19"><a href="modelling-linear-regression.html#cb264-19" tabindex="-1"></a>  </span>
<span id="cb264-20"><a href="modelling-linear-regression.html#cb264-20" tabindex="-1"></a>  </span>
<span id="cb264-21"><a href="modelling-linear-regression.html#cb264-21" tabindex="-1"></a>  <span class="co"># Store slope and intercept in metal_results list</span></span>
<span id="cb264-22"><a href="modelling-linear-regression.html#cb264-22" tabindex="-1"></a>  metal_results[[metal]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">slope =</span> slope, <span class="at">intercept =</span> intercept, <span class="at">r2=</span>r_squared)</span>
<span id="cb264-23"><a href="modelling-linear-regression.html#cb264-23" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## For: Al 
## Slope: 3349.366 
## Intercept: 1307.205 
## 
## For: Mg 
## Slope: 137106.8 
## Intercept: 21629.99 
## 
## For: Ca 
## Slope: 377609.7 
## Intercept: 98591.3 
## 
## For: K 
## Slope: 134130.8 
## Intercept: -30129.57</code></pre>
<p>The code above uses a <code>for</code> loop, that was discussed in the <a href="loops-and-functions-in-r.html#loops">Loops</a> section of this resource. The loop will move through each metal in the dataset and then store the slope, intercept and <span class="math inline">\(R^2\)</span> values in a table called <code>metal_results</code>. After constructing linear regression models for each metal, visualizing these results can provide valuable insights into the relationships between metal concentrations and signal values. Below, we will create a single scatterplot for four selected metals along with their regression lines. This visualization will help in assessing the fit of the models and understanding the variance in signal values as a function of concentration.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="modelling-linear-regression.html#cb266-1" tabindex="-1"></a><span class="co"># Use pivot_longer to reshape the data frame for ggplot</span></span>
<span id="cb266-2"><a href="modelling-linear-regression.html#cb266-2" tabindex="-1"></a>metal_conc_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(metal_conc, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;Al&quot;</span>, <span class="st">&quot;Mg&quot;</span>, <span class="st">&quot;Ca&quot;</span>, <span class="st">&quot;K&quot;</span>), <span class="at">names_to =</span> <span class="st">&quot;Metal&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Signal&quot;</span>)</span>
<span id="cb266-3"><a href="modelling-linear-regression.html#cb266-3" tabindex="-1"></a></span>
<span id="cb266-4"><a href="modelling-linear-regression.html#cb266-4" tabindex="-1"></a><span class="co"># Create a scatterplot for each metal with its regression line</span></span>
<span id="cb266-5"><a href="modelling-linear-regression.html#cb266-5" tabindex="-1"></a><span class="fu">ggplot</span>(metal_conc_long, <span class="fu">aes</span>(<span class="at">x =</span> Concentration, <span class="at">y =</span> Signal, <span class="at">color =</span> Metal)) <span class="sc">+</span></span>
<span id="cb266-6"><a href="modelling-linear-regression.html#cb266-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb266-7"><a href="modelling-linear-regression.html#cb266-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">color =</span> Metal)) <span class="sc">+</span></span>
<span id="cb266-8"><a href="modelling-linear-regression.html#cb266-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Regression Lines for Selected Metals&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Concentration&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Signal&quot;</span>) <span class="sc">+</span></span>
<span id="cb266-9"><a href="modelling-linear-regression.html#cb266-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb266-10"><a href="modelling-linear-regression.html#cb266-10" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;purple&quot;</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
<p>To make this plot we used many of the skills we have learned throughout this resource such as the <code>pivot_longer</code> function in <a href="restructuring-your-data.html#making-data-longer">Making Data Longer</a> and the functionality of <code>ggplot()</code> in <a href="ggplot-basic-visualizations.html#ggplot-basic-visualizations">Ggplot Basic Visualizations</a>.</p>
</div>
<div id="table-with-slopes-intercepts-and-r2" class="section level3 hasAnchor" number="19.3.3">
<h3><span class="header-section-number">19.3.3</span> Table with Slopes, Intercepts, and <span class="math inline">\(R^2\)</span><a href="modelling-linear-regression.html#table-with-slopes-intercepts-and-r2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have successfully built linear regression models for each metal, and the slope, intercept, and <span class="math inline">\(R^2\)</span> values have been stored in the <code>metal_results</code> list. This variable is a list containing key values for each metal, where the metal name serves as the key, and the corresponding regression statistics—slope, intercept, and <span class="math inline">\(R^2\)</span>—are stored as sublists. To visualize and use the data stored in <code>metal_results</code>, we can create a dataframe called <code>metal_results_df</code> that includes each metal alongside its slope, intercept, and <span class="math inline">\(R^2\)</span>, offering a clear overview of the regression outcomes.</p>
<pre><code>##                                  Metal      Slope  Intercept        R2
## Al.metal_conc[[&quot;Concentration&quot;]]    Al   3349.366   1307.205 0.9739628
## Mg.metal_conc[[&quot;Concentration&quot;]]    Mg 137106.781  21629.995 0.9823943
## Ca.metal_conc[[&quot;Concentration&quot;]]    Ca 377609.742  98591.304 0.9820809
## K.metal_conc[[&quot;Concentration&quot;]]      K 134130.811 -30129.572 0.9874339</code></pre>
<p>To access the slope and intercept variables for a specific metal from the <code>metal_results</code> list, we can use the dollar sign notation (<code>$</code>). For instance, to retrieve the slope and intercept for calcium (Ca), we can use the syntax <code>metal_results$Ca$slope</code> and <code>metal_results$Ca$intercept</code>, respectively. This allows us to directly access the slope and intercept values associated with the metal of interest. The following code snippet illustrates how to access these variables:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="modelling-linear-regression.html#cb269-1" tabindex="-1"></a><span class="co"># Access slope and intercept for calcium (Ca)</span></span>
<span id="cb269-2"><a href="modelling-linear-regression.html#cb269-2" tabindex="-1"></a>slope_ca <span class="ot">&lt;-</span> metal_results<span class="sc">$</span>Ca<span class="sc">$</span>slope</span>
<span id="cb269-3"><a href="modelling-linear-regression.html#cb269-3" tabindex="-1"></a>intercept_ca <span class="ot">&lt;-</span> metal_results<span class="sc">$</span>Ca<span class="sc">$</span>intercept</span>
<span id="cb269-4"><a href="modelling-linear-regression.html#cb269-4" tabindex="-1"></a></span>
<span id="cb269-5"><a href="modelling-linear-regression.html#cb269-5" tabindex="-1"></a><span class="co"># Print the slope and intercept values</span></span>
<span id="cb269-6"><a href="modelling-linear-regression.html#cb269-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Slope for Ca:&quot;</span>, slope_ca, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Slope for Ca: 377609.7</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="modelling-linear-regression.html#cb271-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Intercept for Ca:&quot;</span>, intercept_ca, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Intercept for Ca: 98591.3</code></pre>
</div>
</div>
<div id="calculating-concentration-using-the-regression-variables" class="section level2 hasAnchor" number="19.4">
<h2><span class="header-section-number">19.4</span> Calculating Concentration Using the Regression Variables<a href="modelling-linear-regression.html#calculating-concentration-using-the-regression-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To calculate the concentration of the metal ions from the provided signal values (in counts per second, cps), we can use the slope and intercept values obtained from the linear regression models.</p>
<p>Take a look at the following signal values that we don’t know the concentrations of:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="modelling-linear-regression.html#cb273-1" tabindex="-1"></a><span class="co"># Read the metal signal data</span></span>
<span id="cb273-2"><a href="modelling-linear-regression.html#cb273-2" tabindex="-1"></a>metal_signals <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/metal_signals.csv&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb273-3"><a href="modelling-linear-regression.html#cb273-3" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(metal_signals)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-cd5b34b891de43610207" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cd5b34b891de43610207">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[28.22690166,85.02599063,68.74784514,53.25549677,149.8498232,97.64028402],[637.911998,4881.352388,4598.590911,4945.846496,2979575.988,2979233.647],[8146.36764,134822.0279,29488.46922,144811.6956,14029794.12,14031817.98],[56.67326169,6774.110982,1124.06784,6697.140025,209256.8176,194014.5721]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Al<\/th>\n      <th>Mg<\/th>\n      <th>Ca<\/th>\n      <th>K<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Al","targets":1},{"name":"Mg","targets":2},{"name":"Ca","targets":3},{"name":"K","targets":4}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>Let’s assume that the linear regression models were built using the concentration of each metal as the independent variable and the signal values as the dependent variable. Here’s how we can calculate the concentration for each metal:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="modelling-linear-regression.html#cb274-1" tabindex="-1"></a><span class="co"># Function to calculate concentration from signal values</span></span>
<span id="cb274-2"><a href="modelling-linear-regression.html#cb274-2" tabindex="-1"></a>calculate_concentration <span class="ot">&lt;-</span> <span class="cf">function</span>(signal, metal_name) {</span>
<span id="cb274-3"><a href="modelling-linear-regression.html#cb274-3" tabindex="-1"></a>  <span class="co"># Extract slope and intercept for the specified metal</span></span>
<span id="cb274-4"><a href="modelling-linear-regression.html#cb274-4" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> metal_results[[metal_name]]<span class="sc">$</span>slope</span>
<span id="cb274-5"><a href="modelling-linear-regression.html#cb274-5" tabindex="-1"></a>  intercept <span class="ot">&lt;-</span> metal_results[[metal_name]]<span class="sc">$</span>intercept</span>
<span id="cb274-6"><a href="modelling-linear-regression.html#cb274-6" tabindex="-1"></a>  </span>
<span id="cb274-7"><a href="modelling-linear-regression.html#cb274-7" tabindex="-1"></a>  <span class="co"># Calculate concentration using the linear regression equation: concentration = (signal - intercept) / slope</span></span>
<span id="cb274-8"><a href="modelling-linear-regression.html#cb274-8" tabindex="-1"></a>  concentration <span class="ot">&lt;-</span> (signal <span class="sc">-</span> intercept) <span class="sc">/</span> slope</span>
<span id="cb274-9"><a href="modelling-linear-regression.html#cb274-9" tabindex="-1"></a>  </span>
<span id="cb274-10"><a href="modelling-linear-regression.html#cb274-10" tabindex="-1"></a>  <span class="fu">return</span>(concentration)</span>
<span id="cb274-11"><a href="modelling-linear-regression.html#cb274-11" tabindex="-1"></a>}</span>
<span id="cb274-12"><a href="modelling-linear-regression.html#cb274-12" tabindex="-1"></a></span>
<span id="cb274-13"><a href="modelling-linear-regression.html#cb274-13" tabindex="-1"></a><span class="co"># Apply the calculate_concentration function to each metal column in the dataset</span></span>
<span id="cb274-14"><a href="modelling-linear-regression.html#cb274-14" tabindex="-1"></a>metal_signals<span class="sc">$</span>Al_concentration <span class="ot">&lt;-</span> <span class="fu">calculate_concentration</span>(metal_signals<span class="sc">$</span>Al, <span class="st">&quot;Al&quot;</span>)</span>
<span id="cb274-15"><a href="modelling-linear-regression.html#cb274-15" tabindex="-1"></a>metal_signals<span class="sc">$</span>Mg_concentration <span class="ot">&lt;-</span> <span class="fu">calculate_concentration</span>(metal_signals<span class="sc">$</span>Mg, <span class="st">&quot;Mg&quot;</span>)</span>
<span id="cb274-16"><a href="modelling-linear-regression.html#cb274-16" tabindex="-1"></a>metal_signals<span class="sc">$</span>Ca_concentration <span class="ot">&lt;-</span> <span class="fu">calculate_concentration</span>(metal_signals<span class="sc">$</span>Ca, <span class="st">&quot;Ca&quot;</span>)</span>
<span id="cb274-17"><a href="modelling-linear-regression.html#cb274-17" tabindex="-1"></a>metal_signals<span class="sc">$</span>K_concentration <span class="ot">&lt;-</span> <span class="fu">calculate_concentration</span>(metal_signals<span class="sc">$</span>K, <span class="st">&quot;K&quot;</span>)</span>
<span id="cb274-18"><a href="modelling-linear-regression.html#cb274-18" tabindex="-1"></a></span>
<span id="cb274-19"><a href="modelling-linear-regression.html#cb274-19" tabindex="-1"></a><span class="co"># Print the updated dataset with calculated concentrations (Aluminum as the example)</span></span>
<span id="cb274-20"><a href="modelling-linear-regression.html#cb274-20" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(metal_signals)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-c789c0f3461111f7783e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c789c0f3461111f7783e">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[28.22690166,85.02599063,68.74784514,53.25549677,149.8498232,97.64028402],[637.911998,4881.352388,4598.590911,4945.846496,2979575.988,2979233.647],[8146.36764,134822.0279,29488.46922,144811.6956,14029794.12,14031817.98],[56.67326169,6774.110982,1124.06784,6697.140025,209256.8176,194014.5721],[-0.3818568392262496,-0.364898680062861,-0.3697587471362963,-0.3743842035342305,-0.3455446219214788,-0.3611325070674756],[-0.1531075442888161,-0.1221576499810653,-0.1242199949236446,-0.1216872567051808,21.57403131663827,21.57153442336455],[-0.2395196065772132,0.09594753380788712,-0.1830006685889998,0.1224025390538681,36.89312343879466,36.89848309924835],[0.2250507924172525,0.2751320352389965,0.2330086551156043,0.2745581853056977,1.78472334364521,1.671086175752136]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Al<\/th>\n      <th>Mg<\/th>\n      <th>Ca<\/th>\n      <th>K<\/th>\n      <th>Al_concentration<\/th>\n      <th>Mg_concentration<\/th>\n      <th>Ca_concentration<\/th>\n      <th>K_concentration<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Al","targets":1},{"name":"Mg","targets":2},{"name":"Ca","targets":3},{"name":"K","targets":4},{"name":"Al_concentration","targets":5},{"name":"Mg_concentration","targets":6},{"name":"Ca_concentration","targets":7},{"name":"K_concentration","targets":8}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p><em>Note</em>: In the provided code snippet, the use of <code>[[]]</code> (double brackets) allows for dynamic access to list elements using a variable name. This is particularly useful when the exact name of the element is stored as a string in another variable, such as <code>metal_name</code>. The double brackets evaluate the variable to get its value, thereby accessing the corresponding list element. This method is distinct from the use of <code>$</code>, which requires a direct, literal name of the element and cannot interpret a variable’s value as an element name.</p>
<p>Let’s take a closer look at one of the analytes’ calculated concentrations:</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-93474b018026750476e7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-93474b018026750476e7">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[8146.36764,134822.0279,29488.46922,144811.6956,14029794.12,14031817.98],[-0.2395196065772132,0.09594753380788712,-0.1830006685889998,0.1224025390538681,36.89312343879466,36.89848309924835]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Ca<\/th>\n      <th>Ca_concentration<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Ca","targets":1},{"name":"Ca_concentration","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>Do you see anything odd about the calculated concentrations of Calcium in the above table?</p>
<p>Note that negative concentration values can arise when signal values fall below the intercept of the linear regression model, indicating a deviation from the model’s assumptions. This situation typically occurs at lower signal levels, where instrument noise or background signal may influence measurements. Negative concentrations lack meaningful interpretation in chemical analysis and are often considered artifacts of the model’s limitations. To address this issue, we could establish a minimum detectable concentration threshold, treating signal values below this threshold as non-detects or zero values. Alternatively, quadratic or logarithmic regression models may better capture non-linear instrument responses, enabling accurate concentration determination across a wider dynamic range. And the great news is, we’ll see how to do these non-linear regressions in the next chapter!</p>
</div>
<div id="conclusion" class="section level2 hasAnchor" number="19.5">
<h2><span class="header-section-number">19.5</span> Conclusion<a href="modelling-linear-regression.html#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In conclusion, while multiple linear regression serves as a powerful tool for analyzing the relationship between chemical concentrations and instrumental signals, its applicability may be limited by the assumption of linearity. Negative concentration values observed in linear regression analyses highlight the need for robust statistical techniques and critical evaluation of instrument responses. As we move forward into the realm of non-linear regression in the subsequent chapter, we explore alternative modeling approaches that can better accommodate non-linear relationships between variables. By embracing the versatility of non-linear regression techniques, we expand our analytical toolkit, allowing for more accurate and comprehensive analysis of complex chemical systems. Through a combination of linear and non-linear regression methods, chemists can unlock deeper insights into the quantitative relationships governing chemical phenomena, paving the way for advancements in analytical chemistry and beyond.</p>
</div>
<div id="further_reading_chapter19" class="section level2 hasAnchor" number="19.6">
<h2><span class="header-section-number">19.6</span> Further reading<a href="modelling-linear-regression.html#further_reading_chapter19" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As previously stated, we highly recommend reading Chapter 5: Calibration from <em>Data Analysis for Chemistry</em> by Hibbert and Gooding for a more in-depth discussion of linear calibration modelling. The book can be accessed online via the University of Toronto’s Library.</p>
<p>For a greater discussion on modelling in R, see <a href="https://r4ds.had.co.nz/model-intro.html">Modelling</a> in <a href="https://r4ds.had.co.nz/index.html"><em>R for Data Science</em></a>.</p>
</div>
<div id="exercise-13" class="section level2 hasAnchor" number="19.7">
<h2><span class="header-section-number">19.7</span> Exercise<a href="modelling-linear-regression.html#exercise-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There is a set of exercises available for this chapter!</p>
<p><strong>Not sure how to access and work on the exercise Rmd files? </strong></p>
<ul>
<li><p>Refer to Chapter 3.2 for step-by-step instructions on accessing the exercises and working within the UofT JupyterHub’s RStudio environment.</p></li>
<li><p>Alternatively, if you’d like to simply access the individual files, you can download them directly from this <a href="https://github.com/UofTChem-Teaching/R4EnvChem-Exercises">repository</a>.</p></li>
</ul>
<p>Always remember to save your progress regularly and consult the textbook’s guidelines for submitting your completed exercises.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="customizing-your-plots.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="augmented-outputs-and-evaluating-your-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/UofTChem-Teaching/R4EnvChem/edit/main/src/05-modelling-in-r/01-linear-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/UofTChem-Teaching/R4EnvChem/blob/main/src/05-modelling-in-r/01-linear-regression.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 21 Modelling: Non-Linear Regression | R for Environmental Chemistry</title>
  <meta name="description" content="This is a proof-of-concept for a further full length textbook." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 21 Modelling: Non-Linear Regression | R for Environmental Chemistry" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a proof-of-concept for a further full length textbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 21 Modelling: Non-Linear Regression | R for Environmental Chemistry" />
  
  <meta name="twitter:description" content="This is a proof-of-concept for a further full length textbook." />
  

<meta name="author" content="David Hall, Steven Kutarna, Kristen Yeh, Hui Peng, Chaerin Song, and Jessica D’eon" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="augmented-outputs-and-evaluating-your-model.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.32/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Environmental Chemistry</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#providing-feedback"><i class="fa fa-check"></i>Providing Feedback</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowlegements"><i class="fa fa-check"></i>Acknowlegements</a></li>
</ul></li>
<li class="part"><span><b>Part 1: Getting Started in R</b></span></li>
<li class="chapter" data-level="1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Intro to R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#r-language"><i class="fa fa-check"></i><b>1.1</b> R Language</a></li>
<li class="chapter" data-level="1.2" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#setting-up-your-environment"><i class="fa fa-check"></i><b>1.3</b> Setting Up Your Environment</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#working-remotely-recommended-for-coursework"><i class="fa fa-check"></i><b>1.3.1</b> Working Remotely (Recommended for Coursework)</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#working-locally"><i class="fa fa-check"></i><b>1.3.2</b> Working Locally</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#using-rstudio"><i class="fa fa-check"></i><b>1.4</b> Using RStudio</a></li>
<li class="chapter" data-level="1.5" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#running-r-code"><i class="fa fa-check"></i><b>1.5</b> Running R Code</a></li>
<li class="chapter" data-level="1.6" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#customizing-rstudio"><i class="fa fa-check"></i><b>1.6</b> Customizing RStudio</a></li>
<li class="chapter" data-level="1.7" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#where-to-get-help"><i class="fa fa-check"></i><b>1.7</b> Where to get help</a></li>
<li class="chapter" data-level="1.8" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#summary"><i class="fa fa-check"></i><b>1.8</b> Summary</a></li>
<li class="chapter" data-level="1.9" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#exercise"><i class="fa fa-check"></i><b>1.9</b> Exercise</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#setup"><i class="fa fa-check"></i><b>1.9.1</b> Setup</a></li>
<li class="chapter" data-level="1.9.2" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#basic-r-commands"><i class="fa fa-check"></i><b>1.9.2</b> Basic R Commands</a></li>
<li class="chapter" data-level="1.9.3" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#using-the-help-command"><i class="fa fa-check"></i><b>1.9.3</b> Using the Help Command (<code>?</code>)</a></li>
<li class="chapter" data-level="1.9.4" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#reflection"><i class="fa fa-check"></i><b>1.9.4</b> Reflection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio-projects.html"><a href="rstudio-projects.html"><i class="fa fa-check"></i><b>2</b> RStudio Projects</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rstudio-projects.html"><a href="rstudio-projects.html#uploading-files-to-rstudio-server-on-jupyterhub"><i class="fa fa-check"></i><b>2.1</b> Uploading Files to RStudio server on JupyterHub</a></li>
<li class="chapter" data-level="2.2" data-path="rstudio-projects.html"><a href="rstudio-projects.html#paths-and-directories"><i class="fa fa-check"></i><b>2.2</b> Paths and Directories</a></li>
<li class="chapter" data-level="2.3" data-path="rstudio-projects.html"><a href="rstudio-projects.html#importing-a-project"><i class="fa fa-check"></i><b>2.3</b> Importing a Project</a></li>
<li class="chapter" data-level="2.4" data-path="rstudio-projects.html"><a href="rstudio-projects.html#creating-an-rstudio-project"><i class="fa fa-check"></i><b>2.4</b> Creating an RStudio Project</a></li>
<li class="chapter" data-level="2.5" data-path="rstudio-projects.html"><a href="rstudio-projects.html#a-sneak-peek-at-.rmd-files"><i class="fa fa-check"></i><b>2.5</b> A Sneak Peek at <code>.Rmd</code> Files</a></li>
<li class="chapter" data-level="2.6" data-path="rstudio-projects.html"><a href="rstudio-projects.html#summary-1"><i class="fa fa-check"></i><b>2.6</b> Summary</a></li>
<li class="chapter" data-level="2.7" data-path="rstudio-projects.html"><a href="rstudio-projects.html#exercise-1"><i class="fa fa-check"></i><b>2.7</b> Exercise</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="rstudio-projects.html"><a href="rstudio-projects.html#get-started"><i class="fa fa-check"></i><b>2.7.1</b> Get Started</a></li>
<li class="chapter" data-level="2.7.2" data-path="rstudio-projects.html"><a href="rstudio-projects.html#confirm-your-working-directory"><i class="fa fa-check"></i><b>2.7.2</b> Confirm Your Working Directory</a></li>
<li class="chapter" data-level="2.7.3" data-path="rstudio-projects.html"><a href="rstudio-projects.html#creating-your-own-project"><i class="fa fa-check"></i><b>2.7.3</b> Creating Your Own Project</a></li>
<li class="chapter" data-level="2.7.4" data-path="rstudio-projects.html"><a href="rstudio-projects.html#create-your-rmd-file"><i class="fa fa-check"></i><b>2.7.4</b> Create Your Rmd File</a></li>
<li class="chapter" data-level="2.7.5" data-path="rstudio-projects.html"><a href="rstudio-projects.html#upload-a-file-from-your-computer"><i class="fa fa-check"></i><b>2.7.5</b> Upload a file from your computer</a></li>
<li class="chapter" data-level="2.7.6" data-path="rstudio-projects.html"><a href="rstudio-projects.html#reflection-1"><i class="fa fa-check"></i><b>2.7.6</b> Reflection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="using-r-markdown.html"><a href="using-r-markdown.html"><i class="fa fa-check"></i><b>3</b> Using R Markdown</a>
<ul>
<li class="chapter" data-level="3.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#getting-started-with-r-markdown"><i class="fa fa-check"></i><b>3.1</b> Getting Started with R Markdown</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#understanding-r-markdown"><i class="fa fa-check"></i><b>3.1.1</b> Understanding R Markdown</a></li>
<li class="chapter" data-level="3.1.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#running-code-in-r-markdown"><i class="fa fa-check"></i><b>3.1.2</b> Running Code in R Markdown</a></li>
<li class="chapter" data-level="3.1.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#headings-and-subheadings"><i class="fa fa-check"></i><b>3.1.3</b> Headings and Subheadings</a></li>
<li class="chapter" data-level="3.1.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#latex-basics"><i class="fa fa-check"></i><b>3.1.4</b> LaTeX Basics</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#compiling-your-final-report"><i class="fa fa-check"></i><b>3.2</b> Compiling your final report</a></li>
<li class="chapter" data-level="3.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#authoring-with-r-markdown"><i class="fa fa-check"></i><b>3.3</b> Authoring with R Markdown</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-markdown-syntax"><i class="fa fa-check"></i><b>3.3.1</b> R Markdown Syntax</a></li>
<li class="chapter" data-level="3.3.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-code-chunk-options"><i class="fa fa-check"></i><b>3.3.2</b> R Code Chunk Options</a></li>
<li class="chapter" data-level="3.3.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#inserting-images"><i class="fa fa-check"></i><b>3.3.3</b> Inserting images</a></li>
<li class="chapter" data-level="3.3.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#generating-tables"><i class="fa fa-check"></i><b>3.3.4</b> Generating tables</a></li>
<li class="chapter" data-level="3.3.5" data-path="using-r-markdown.html"><a href="using-r-markdown.html#spellcheck-in-r-markdown"><i class="fa fa-check"></i><b>3.3.5</b> Spellcheck in R Markdown</a></li>
<li class="chapter" data-level="3.3.6" data-path="using-r-markdown.html"><a href="using-r-markdown.html#exporting-r-markdown-documents"><i class="fa fa-check"></i><b>3.3.6</b> Exporting R Markdown documents</a></li>
<li class="chapter" data-level="3.3.7" data-path="using-r-markdown.html"><a href="using-r-markdown.html#rstudio-tips-and-tricks"><i class="fa fa-check"></i><b>3.3.7</b> RStudio tips and tricks</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-markdown-resources"><i class="fa fa-check"></i><b>3.4</b> R Markdown resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html"><i class="fa fa-check"></i><b>4</b> How to Use This Textbook</a>
<ul>
<li class="chapter" data-level="4.1" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#useful-features"><i class="fa fa-check"></i><b>4.1</b> Useful Features</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#searching-the-textbook"><i class="fa fa-check"></i><b>4.1.1</b> Searching the Textbook</a></li>
<li class="chapter" data-level="4.1.2" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#original-r-markdown-of-the-textbook-chapters"><i class="fa fa-check"></i><b>4.1.2</b> Original R Markdown of the Textbook Chapters</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#running-tests-for-your-exercises"><i class="fa fa-check"></i><b>4.2</b> Running Tests for Your Exercises</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#how-to-run-the-tests"><i class="fa fa-check"></i><b>4.2.1</b> How to Run the Tests</a></li>
<li class="chapter" data-level="4.2.2" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#optional-autotests-on-markus"><i class="fa fa-check"></i><b>4.2.2</b> Optional: Autotests on MarkUs</a></li>
<li class="chapter" data-level="4.2.3" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#optional-extra-questions"><i class="fa fa-check"></i><b>4.2.3</b> Optional Extra Questions</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Part 2: How to Code in R</b></span></li>
<li class="chapter" data-level="5" data-path="r-coding-basics.html"><a href="r-coding-basics.html"><i class="fa fa-check"></i><b>5</b> R Coding Basics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#variables"><i class="fa fa-check"></i><b>5.1</b> Variables</a></li>
<li class="chapter" data-level="5.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-types"><i class="fa fa-check"></i><b>5.2</b> Data Types</a></li>
<li class="chapter" data-level="5.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-structures"><i class="fa fa-check"></i><b>5.3</b> Data Structures</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-frames"><i class="fa fa-check"></i><b>5.3.1</b> Data Frames</a></li>
<li class="chapter" data-level="5.3.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#accessing-data-in-subfolders"><i class="fa fa-check"></i><b>5.3.2</b> Accessing Data in Subfolders</a></li>
<li class="chapter" data-level="5.3.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#other-data-structures"><i class="fa fa-check"></i><b>5.3.3</b> Other Data Structures</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="r-coding-basics.html"><a href="r-coding-basics.html#conditional-statements"><i class="fa fa-check"></i><b>5.4</b> Conditional Statements</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#understanding-r-syntax"><i class="fa fa-check"></i><b>5.4.1</b> Understanding R Syntax</a></li>
<li class="chapter" data-level="5.4.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#the-basic-if-statement"><i class="fa fa-check"></i><b>5.4.2</b> The Basic <code>if</code> Statement</a></li>
<li class="chapter" data-level="5.4.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#expanding-with-else-and-else-if"><i class="fa fa-check"></i><b>5.4.3</b> Expanding with <code>else</code> and <code>else if</code></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="r-coding-basics.html"><a href="r-coding-basics.html#r-built-in-functions"><i class="fa fa-check"></i><b>5.5</b> R built-in Functions</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#exploring-more-built-in-functions"><i class="fa fa-check"></i><b>5.5.1</b> Exploring More Built-In Functions</a></li>
<li class="chapter" data-level="5.5.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#function-documentation"><i class="fa fa-check"></i><b>5.5.2</b> Function Documentation</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="r-coding-basics.html"><a href="r-coding-basics.html#summary-2"><i class="fa fa-check"></i><b>5.6</b> Summary</a></li>
<li class="chapter" data-level="5.7" data-path="r-coding-basics.html"><a href="r-coding-basics.html#exercise-2"><i class="fa fa-check"></i><b>5.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html"><i class="fa fa-check"></i><b>6</b> Workflows for R Coding</a>
<ul>
<li class="chapter" data-level="6.1" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#creating-or-opening-an-r-markdown-document"><i class="fa fa-check"></i><b>6.1</b> Creating or opening an R Markdown document</a></li>
<li class="chapter" data-level="6.2" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#workspace-and-whats-real"><i class="fa fa-check"></i><b>6.2</b> Workspace and What’s Real</a></li>
<li class="chapter" data-level="6.3" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#saving-r-markdown"><i class="fa fa-check"></i><b>6.3</b> Saving R Markdown</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#what-should-i-save"><i class="fa fa-check"></i><b>6.3.1</b> What Should I Save?</a></li>
<li class="chapter" data-level="6.3.2" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#saving-data-frames"><i class="fa fa-check"></i><b>6.3.2</b> Saving Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#script-formatting"><i class="fa fa-check"></i><b>6.4</b> Script formatting</a></li>
<li class="chapter" data-level="6.5" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#viewing-data-and-code-simultaneously"><i class="fa fa-check"></i><b>6.5</b> Viewing Data and Code Simultaneously</a></li>
<li class="chapter" data-level="6.6" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#troubleshooting-error-messages"><i class="fa fa-check"></i><b>6.6</b> Troubleshooting Error Messages</a></li>
<li class="chapter" data-level="6.7" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#summary-3"><i class="fa fa-check"></i><b>6.7</b> Summary</a></li>
<li class="chapter" data-level="6.8" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#exercise-3"><i class="fa fa-check"></i><b>6.8</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>7</b> R Packages</a>
<ul>
<li class="chapter" data-level="7.1" data-path="r-packages.html"><a href="r-packages.html#what-are-r-packages"><i class="fa fa-check"></i><b>7.1</b> What are R packages?</a></li>
<li class="chapter" data-level="7.2" data-path="r-packages.html"><a href="r-packages.html#how-to-use-r-packages"><i class="fa fa-check"></i><b>7.2</b> How to use R packages</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="r-packages.html"><a href="r-packages.html#how-to-install-packages"><i class="fa fa-check"></i><b>7.2.1</b> How to install packages</a></li>
<li class="chapter" data-level="7.2.2" data-path="r-packages.html"><a href="r-packages.html#how-to-load-packages"><i class="fa fa-check"></i><b>7.2.2</b> How to load packages</a></li>
<li class="chapter" data-level="7.2.3" data-path="r-packages.html"><a href="r-packages.html#calling-specific-functions"><i class="fa fa-check"></i><b>7.2.3</b> Calling specific functions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="r-packages.html"><a href="r-packages.html#tidyverse-the-golden-toolbox-of-r"><i class="fa fa-check"></i><b>7.3</b> Tidyverse: The Golden Toolbox of R</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="r-packages.html"><a href="r-packages.html#loading-the-tidyverse"><i class="fa fa-check"></i><b>7.3.1</b> Loading the Tidyverse</a></li>
<li class="chapter" data-level="7.3.2" data-path="r-packages.html"><a href="r-packages.html#data-visualization"><i class="fa fa-check"></i><b>7.3.2</b> Data Visualization</a></li>
<li class="chapter" data-level="7.3.3" data-path="r-packages.html"><a href="r-packages.html#data-manipulation"><i class="fa fa-check"></i><b>7.3.3</b> Data Manipulation</a></li>
<li class="chapter" data-level="7.3.4" data-path="r-packages.html"><a href="r-packages.html#efficient-data-reading"><i class="fa fa-check"></i><b>7.3.4</b> Efficient Data Reading</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="r-packages.html"><a href="r-packages.html#summary-4"><i class="fa fa-check"></i><b>7.4</b> Summary</a></li>
<li class="chapter" data-level="7.5" data-path="r-packages.html"><a href="r-packages.html#exercise-4"><i class="fa fa-check"></i><b>7.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="loops-and-functions-in-r.html"><a href="loops-and-functions-in-r.html"><i class="fa fa-check"></i><b>8</b> Loops and Functions in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="loops-and-functions-in-r.html"><a href="loops-and-functions-in-r.html#loops"><i class="fa fa-check"></i><b>8.1</b> Loops</a></li>
<li class="chapter" data-level="8.2" data-path="loops-and-functions-in-r.html"><a href="loops-and-functions-in-r.html#writing-custom-functions-in-r"><i class="fa fa-check"></i><b>8.2</b> Writing custom functions in R</a></li>
<li class="chapter" data-level="8.3" data-path="loops-and-functions-in-r.html"><a href="loops-and-functions-in-r.html#further_reading_chapter8"><i class="fa fa-check"></i><b>8.3</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>Part 3: Data Analysis in R</b></span></li>
<li class="chapter" data-level="9" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html"><i class="fa fa-check"></i><b>9</b> Intro to Data Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#example-data"><i class="fa fa-check"></i><b>9.1</b> Example Data</a></li>
<li class="chapter" data-level="9.2" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#sneak-peek-at-data-analysis"><i class="fa fa-check"></i><b>9.2</b> Sneak Peek at Data Analysis</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#setting-up"><i class="fa fa-check"></i><b>9.2.1</b> Setting Up</a></li>
<li class="chapter" data-level="9.2.2" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#tidying-our-data"><i class="fa fa-check"></i><b>9.2.2</b> Tidying Our Data</a></li>
<li class="chapter" data-level="9.2.3" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#investigating-storm-patterns"><i class="fa fa-check"></i><b>9.2.3</b> Investigating Storm Patterns</a></li>
<li class="chapter" data-level="9.2.4" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#visualization-geographical-distribution"><i class="fa fa-check"></i><b>9.2.4</b> Visualization: Geographical Distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="intro-to-data-analysis.html"><a href="intro-to-data-analysis.html#further_reading_chapter9"><i class="fa fa-check"></i><b>9.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html"><i class="fa fa-check"></i><b>10</b> Importing Your Data Into R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#csv-files"><i class="fa fa-check"></i><b>10.1</b> csv files</a></li>
<li class="chapter" data-level="10.2" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#read_csv"><i class="fa fa-check"></i><b>10.2</b> <code>read_csv</code></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#tibbles-vs.-data-frames"><i class="fa fa-check"></i><b>10.2.1</b> Tibbles vs. data frames</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#importing-other-data-types"><i class="fa fa-check"></i><b>10.3</b> Importing other data types</a></li>
<li class="chapter" data-level="10.4" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#saving-data"><i class="fa fa-check"></i><b>10.4</b> Saving data</a></li>
<li class="chapter" data-level="10.5" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#further_reading_chapter10"><i class="fa fa-check"></i><b>10.5</b> Further Reading</a></li>
<li class="chapter" data-level="10.6" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#exercise-5"><i class="fa fa-check"></i><b>10.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="tidying-your-data.html"><a href="tidying-your-data.html"><i class="fa fa-check"></i><b>11</b> Tidying Your Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="tidying-your-data.html"><a href="tidying-your-data.html#what-is-tidy-data"><i class="fa fa-check"></i><b>11.1</b> What is tidy data?</a></li>
<li class="chapter" data-level="11.2" data-path="tidying-your-data.html"><a href="tidying-your-data.html#tools-to-tidy-your-data"><i class="fa fa-check"></i><b>11.2</b> Tools to tidy your data</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="tidying-your-data.html"><a href="tidying-your-data.html#selection-helpers"><i class="fa fa-check"></i><b>11.2.1</b> Selection helpers</a></li>
<li class="chapter" data-level="11.2.2" data-path="tidying-your-data.html"><a href="tidying-your-data.html#separating-columns"><i class="fa fa-check"></i><b>11.2.2</b> Separating columns</a></li>
<li class="chapter" data-level="11.2.3" data-path="tidying-your-data.html"><a href="tidying-your-data.html#unitingcombining-columns"><i class="fa fa-check"></i><b>11.2.3</b> Uniting/combining columns</a></li>
<li class="chapter" data-level="11.2.4" data-path="tidying-your-data.html"><a href="tidying-your-data.html#renaming-columnsheaders"><i class="fa fa-check"></i><b>11.2.4</b> Renaming columns/headers</a></li>
<li class="chapter" data-level="11.2.5" data-path="tidying-your-data.html"><a href="tidying-your-data.html#chaining-multiple-operations"><i class="fa fa-check"></i><b>11.2.5</b> Chaining multiple operations</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="tidying-your-data.html"><a href="tidying-your-data.html#tips-for-recording-data"><i class="fa fa-check"></i><b>11.3</b> Tips for recording data</a></li>
<li class="chapter" data-level="11.4" data-path="tidying-your-data.html"><a href="tidying-your-data.html#further_reading_chapter11"><i class="fa fa-check"></i><b>11.4</b> Further reading</a></li>
<li class="chapter" data-level="11.5" data-path="tidying-your-data.html"><a href="tidying-your-data.html#chapter-references"><i class="fa fa-check"></i><b>11.5</b> Chapter References</a></li>
<li class="chapter" data-level="11.6" data-path="tidying-your-data.html"><a href="tidying-your-data.html#exercise-6"><i class="fa fa-check"></i><b>11.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html"><i class="fa fa-check"></i><b>12</b> Transform: Data Manipulation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#selecting-by-row-or-value"><i class="fa fa-check"></i><b>12.1</b> Selecting by row or value</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#logical-operators"><i class="fa fa-check"></i><b>12.1.1</b> Logical operators</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#arranging-rows"><i class="fa fa-check"></i><b>12.2</b> Arranging rows</a></li>
<li class="chapter" data-level="12.3" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#selecting-column-name"><i class="fa fa-check"></i><b>12.3</b> Selecting column name</a></li>
<li class="chapter" data-level="12.4" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#deleting-columns-or-rows"><i class="fa fa-check"></i><b>12.4</b> Deleting Columns or Rows</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#deleting-columns"><i class="fa fa-check"></i><b>12.4.1</b> Deleting columns</a></li>
<li class="chapter" data-level="12.4.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#deleting-rows"><i class="fa fa-check"></i><b>12.4.2</b> Deleting rows</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#adding-new-variables"><i class="fa fa-check"></i><b>12.5</b> Adding new variables</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#mutate-with-a-condition"><i class="fa fa-check"></i><b>12.5.1</b> Mutate with a condition</a></li>
<li class="chapter" data-level="12.5.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#useful-mutate-function"><i class="fa fa-check"></i><b>12.5.2</b> Useful mutate function</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#group-and-summarize-data"><i class="fa fa-check"></i><b>12.6</b> Group and summarize data</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#useful-summarize-functions"><i class="fa fa-check"></i><b>12.6.1</b> Useful summarize functions</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#the-pipe-chaining-functions-together"><i class="fa fa-check"></i><b>12.7</b> The Pipe: Chaining Functions Together</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#function-composition-example"><i class="fa fa-check"></i><b>12.7.1</b> Function Composition Example</a></li>
<li class="chapter" data-level="12.7.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#abstract-example-of-piping"><i class="fa fa-check"></i><b>12.7.2</b> Abstract Example of Piping</a></li>
<li class="chapter" data-level="12.7.3" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#simple-examples-of-piping"><i class="fa fa-check"></i><b>12.7.3</b> Simple Examples of Piping</a></li>
<li class="chapter" data-level="12.7.4" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#piping-in-practice"><i class="fa fa-check"></i><b>12.7.4</b> Piping in Practice</a></li>
<li class="chapter" data-level="12.7.5" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#notes-on-piping"><i class="fa fa-check"></i><b>12.7.5</b> Notes on piping</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#further_reading_chapter12"><i class="fa fa-check"></i><b>12.8</b> Further reading</a></li>
<li class="chapter" data-level="12.9" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#exercise-7"><i class="fa fa-check"></i><b>12.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html"><i class="fa fa-check"></i><b>13</b> Ggplot Basic Visualizations</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#building-plots-ups"><i class="fa fa-check"></i><b>13.1</b> Building plots ups</a></li>
<li class="chapter" data-level="13.2" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#basic-plotting"><i class="fa fa-check"></i><b>13.2</b> Basic plotting</a></li>
<li class="chapter" data-level="13.3" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#changing-plot-labels"><i class="fa fa-check"></i><b>13.3</b> Changing plot labels</a></li>
<li class="chapter" data-level="13.4" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#small-multiples"><i class="fa fa-check"></i><b>13.4</b> Small Multiples</a></li>
<li class="chapter" data-level="13.5" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#plotting-subsets-of-data"><i class="fa fa-check"></i><b>13.5</b> Plotting subsets of data</a></li>
<li class="chapter" data-level="13.6" data-path="ggplot-basic-visualizations.html"><a href="ggplot-basic-visualizations.html#exercise-8"><i class="fa fa-check"></i><b>13.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>14</b> Summarizing Data</a>
<ul>
<li class="chapter" data-level="14.1" data-path="summarizing-data.html"><a href="summarizing-data.html#data-to-play-with"><i class="fa fa-check"></i><b>14.1</b> Data to Play With</a></li>
<li class="chapter" data-level="14.2" data-path="summarizing-data.html"><a href="summarizing-data.html#summarizing-data-by-group"><i class="fa fa-check"></i><b>14.2</b> Summarizing Data by Group</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#further-summarize-operations"><i class="fa fa-check"></i><b>14.2.1</b> Further Summarize Operations</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="summarizing-data.html"><a href="summarizing-data.html#pretty-tables-with-flextable"><i class="fa fa-check"></i><b>14.3</b> Pretty Tables with Flextable</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#uniting-columns"><i class="fa fa-check"></i><b>14.3.1</b> Uniting columns</a></li>
<li class="chapter" data-level="14.3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#pretty-tables"><i class="fa fa-check"></i><b>14.3.2</b> Pretty tables</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="summarizing-data.html"><a href="summarizing-data.html#exercise-9"><i class="fa fa-check"></i><b>14.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html"><i class="fa fa-check"></i><b>15</b> Restructuring Your Data</a>
<ul>
<li class="chapter" data-level="15.1" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#long-vs-wide-data"><i class="fa fa-check"></i><b>15.1</b> Long vs Wide Data</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#long-data"><i class="fa fa-check"></i><b>15.1.1</b> Long Data</a></li>
<li class="chapter" data-level="15.1.2" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#wide-data"><i class="fa fa-check"></i><b>15.1.2</b> Wide Data</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#making-data-longer"><i class="fa fa-check"></i><b>15.2</b> Making Data Longer</a></li>
<li class="chapter" data-level="15.3" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#making-data-wider"><i class="fa fa-check"></i><b>15.3</b> Making Data Wider</a></li>
<li class="chapter" data-level="15.4" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#summary-5"><i class="fa fa-check"></i><b>15.4</b> Summary</a></li>
<li class="chapter" data-level="15.5" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#further_reading_chapter15"><i class="fa fa-check"></i><b>15.5</b> Further reading</a></li>
<li class="chapter" data-level="15.6" data-path="restructuring-your-data.html"><a href="restructuring-your-data.html#exercise-10"><i class="fa fa-check"></i><b>15.6</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>Part 4: Visualization in R</b></span></li>
<li class="chapter" data-level="16" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html"><i class="fa fa-check"></i><b>16</b> Visualizations for Env Chem</a>
<ul>
<li class="chapter" data-level="16.1" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#discrete-vs.-continuous-variables"><i class="fa fa-check"></i><b>16.1</b> Discrete vs. Continuous variables</a></li>
<li class="chapter" data-level="16.2" data-path="visualizations-for-env-chem.html"><a href="visualizations-for-env-chem.html#prerequisites"><i class="fa fa-check"></i><b>16.2</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html"><i class="fa fa-check"></i><b>17</b> Common Types of Graphs</a>
<ul>
<li class="chapter" data-level="17.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#bar-charts"><i class="fa fa-check"></i><b>17.1</b> Bar Charts</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#adding-error-bars"><i class="fa fa-check"></i><b>17.1.1</b> Adding Error Bars</a></li>
<li class="chapter" data-level="17.1.2" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#ordering-bar-charts"><i class="fa fa-check"></i><b>17.1.2</b> Ordering Bar Charts</a></li>
<li class="chapter" data-level="17.1.3" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#grouping-bar-charts"><i class="fa fa-check"></i><b>17.1.3</b> Grouping Bar Charts</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#box-plots"><i class="fa fa-check"></i><b>17.2</b> Box Plots</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#violin-plots"><i class="fa fa-check"></i><b>17.2.1</b> Violin Plots</a></li>
<li class="chapter" data-level="17.2.2" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#statistical-comparisons-between-groups"><i class="fa fa-check"></i><b>17.2.2</b> Statistical Comparisons Between Groups</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#histograms"><i class="fa fa-check"></i><b>17.3</b> Histograms</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#multiple-histograms"><i class="fa fa-check"></i><b>17.3.1</b> Multiple histograms</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#scatter-plots"><i class="fa fa-check"></i><b>17.4</b> Scatter Plots</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#marginal-plots"><i class="fa fa-check"></i><b>17.4.1</b> Marginal plots</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="common-types-of-graphs.html"><a href="common-types-of-graphs.html#exercise-11"><i class="fa fa-check"></i><b>17.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html"><i class="fa fa-check"></i><b>18</b> Customizing your plots</a>
<ul>
<li class="chapter" data-level="18.1" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#interactive-plots"><i class="fa fa-check"></i><b>18.1</b> Interactive Plots</a></li>
<li class="chapter" data-level="18.2" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#plot-themes"><i class="fa fa-check"></i><b>18.2</b> Plot Themes</a></li>
<li class="chapter" data-level="18.3" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#legends"><i class="fa fa-check"></i><b>18.3</b> Legends</a></li>
<li class="chapter" data-level="18.4" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#modifying-labels"><i class="fa fa-check"></i><b>18.4</b> Modifying labels</a></li>
<li class="chapter" data-level="18.5" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#modifying-axis"><i class="fa fa-check"></i><b>18.5</b> Modifying Axis</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#transforming-axis"><i class="fa fa-check"></i><b>18.5.1</b> Transforming axis</a></li>
<li class="chapter" data-level="18.5.2" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#axis-limits"><i class="fa fa-check"></i><b>18.5.2</b> Axis limits</a></li>
<li class="chapter" data-level="18.5.3" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#axis-tickslabels"><i class="fa fa-check"></i><b>18.5.3</b> Axis ticks/labels</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#arranging-plots"><i class="fa fa-check"></i><b>18.6</b> Arranging plots</a></li>
<li class="chapter" data-level="18.7" data-path="customizing-your-plots.html"><a href="customizing-your-plots.html#exercise-12"><i class="fa fa-check"></i><b>18.7</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>Part 5: Modelling in R</b></span></li>
<li class="chapter" data-level="19" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html"><i class="fa fa-check"></i><b>19</b> Modelling: Linear Regression</a>
<ul>
<li class="chapter" data-level="19.1" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#modelling-theory"><i class="fa fa-check"></i><b>19.1</b> Modelling Theory</a></li>
<li class="chapter" data-level="19.2" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#linear-regression-in-r"><i class="fa fa-check"></i><b>19.2</b> Linear Regression in R</a></li>
<li class="chapter" data-level="19.3" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#building-multiple-linear-regressions"><i class="fa fa-check"></i><b>19.3</b> Building Multiple Linear Regressions</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#dataset"><i class="fa fa-check"></i><b>19.3.1</b> Dataset</a></li>
<li class="chapter" data-level="19.3.2" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#building-a-linear-regression-for-each-analyte"><i class="fa fa-check"></i><b>19.3.2</b> Building a Linear Regression for Each Analyte</a></li>
<li class="chapter" data-level="19.3.3" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#table-with-slopes-intercepts-and-r2"><i class="fa fa-check"></i><b>19.3.3</b> Table with Slopes, Intercepts, and <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#calculating-concentration-using-the-regression-variables"><i class="fa fa-check"></i><b>19.4</b> Calculating Concentration Using the Regression Variables</a></li>
<li class="chapter" data-level="19.5" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#conclusion"><i class="fa fa-check"></i><b>19.5</b> Conclusion</a></li>
<li class="chapter" data-level="19.6" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#further_reading_chapter19"><i class="fa fa-check"></i><b>19.6</b> Further reading</a></li>
<li class="chapter" data-level="19.7" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#exercise-13"><i class="fa fa-check"></i><b>19.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html"><i class="fa fa-check"></i><b>20</b> Augmented Outputs and Evaluating Your Model</a>
<ul>
<li class="chapter" data-level="20.1" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#cleaning-up-model-ouputs"><i class="fa fa-check"></i><b>20.1</b> Cleaning up Model Ouputs</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#glanced-outputs"><i class="fa fa-check"></i><b>20.1.1</b> Glanced Outputs</a></li>
<li class="chapter" data-level="20.1.2" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#tidied-outputs"><i class="fa fa-check"></i><b>20.1.2</b> Tidied Outputs</a></li>
<li class="chapter" data-level="20.1.3" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#augmented-outputs"><i class="fa fa-check"></i><b>20.1.3</b> Augmented Outputs</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#incorporating-weights-into-your-model"><i class="fa fa-check"></i><b>20.2</b> Incorporating Weights into your Model</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#why-we-approach-modelling-this-way"><i class="fa fa-check"></i><b>20.2.1</b> Why we approach modelling this way</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#visualizing-models"><i class="fa fa-check"></i><b>20.3</b> Visualizing models</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#visualizing-residuals"><i class="fa fa-check"></i><b>20.3.1</b> Visualizing residuals</a></li>
<li class="chapter" data-level="20.3.2" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#plotting-residuals"><i class="fa fa-check"></i><b>20.3.2</b> Plotting residuals</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#calculating-concentrations-from-the-augmented-outputs"><i class="fa fa-check"></i><b>20.4</b> Calculating Concentrations from the Augmented Outputs</a></li>
<li class="chapter" data-level="20.5" data-path="augmented-outputs-and-evaluating-your-model.html"><a href="augmented-outputs-and-evaluating-your-model.html#exercise-14"><i class="fa fa-check"></i><b>20.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html"><i class="fa fa-check"></i><b>21</b> Modelling: Non-Linear Regression</a>
<ul>
<li class="chapter" data-level="21.1" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#experimental-background"><i class="fa fa-check"></i><b>21.1</b> Experimental Background</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#annotating-maximal-values"><i class="fa fa-check"></i><b>21.1.1</b> Annotating maximal values</a></li>
<li class="chapter" data-level="21.1.2" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#extracting-maximal-values"><i class="fa fa-check"></i><b>21.1.2</b> Extracting maximal values</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#modelling-sigmoid-curve"><i class="fa fa-check"></i><b>21.2</b> Modelling Sigmoid Curve</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#calculating-logistic-regression"><i class="fa fa-check"></i><b>21.2.1</b> Calculating Logistic Regression</a></li>
<li class="chapter" data-level="21.2.2" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#extracting-model-parameters"><i class="fa fa-check"></i><b>21.2.2</b> Extracting model parameters</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#summary-6"><i class="fa fa-check"></i><b>21.3</b> Summary</a></li>
<li class="chapter" data-level="21.4" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#exercise-15"><i class="fa fa-check"></i><b>21.4</b> Exercise</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Environmental Chemistry</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelling-non-linear-regression" class="section level1 hasAnchor" number="21">
<h1><span class="header-section-number">Chapter 21</span> Modelling: Non-Linear Regression<a href="modelling-non-linear-regression.html#modelling-non-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We’ve touched upon the basics of modelling in R but it doesn’t have to stop there. This chapter will expand upon the contents of <a href="modelling-linear-regression.html#modelling-linear-regression">Modelling: Linear Regression</a> to cover non-linear regressions. Since we can’t account for the myriad of models utilized throughout the field, we’ll work through a case-study.</p>
<div id="experimental-background" class="section level2 hasAnchor" number="21.1">
<h2><span class="header-section-number">21.1</span> Experimental Background<a href="modelling-non-linear-regression.html#experimental-background" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this chapter we’ll be using data obtained from an experiment in <em>CHM317</em>. In this experiment, students measure the fluorescence of the fluorescent dye acridine orange in the presence of sodium dodecyl sulfate (SDS). In, or near, the critical micelle concentration of SDS, there is a sharp change in absorbance and fluorescence of the solution. Tracking these changes in fluorescence, students can then estimate the CMC of SDS. Experimentally, students prepared solutions of a constant concentration of acridine orange and varying concentrations of SDS. The emission spectrum of each sample was recorded, and we want to take the maximal of each spectra as a data point to build our model.</p>
<p>Let’s go ahead and import our data:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="modelling-non-linear-regression.html#cb310-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb310-2"><a href="modelling-non-linear-regression.html#cb310-2" tabindex="-1"></a></span>
<span id="cb310-3"><a href="modelling-non-linear-regression.html#cb310-3" tabindex="-1"></a>sds <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/CHM317/fluoro_SDSCMC.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb310-4"><a href="modelling-non-linear-regression.html#cb310-4" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span><span class="st">`</span><span class="at">Wavelength (nm)</span><span class="st">`</span>, <span class="co"># select all columns BESIDES `Wavelength (nm)`</span></span>
<span id="cb310-5"><a href="modelling-non-linear-regression.html#cb310-5" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;conc&quot;</span>, <span class="st">&quot;conc.units&quot;</span>, <span class="st">&quot;chemical&quot;</span>),</span>
<span id="cb310-6"><a href="modelling-non-linear-regression.html#cb310-6" tabindex="-1"></a>               <span class="at">names_pattern =</span> <span class="st">&quot;(.*) (.) (.*)&quot;</span>,</span>
<span id="cb310-7"><a href="modelling-non-linear-regression.html#cb310-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;intensity&quot;</span>,</span>
<span id="cb310-8"><a href="modelling-non-linear-regression.html#cb310-8" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">conc =</span> as.numeric)</span>
<span id="cb310-9"><a href="modelling-non-linear-regression.html#cb310-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb310-10"><a href="modelling-non-linear-regression.html#cb310-10" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">wavelength =</span> <span class="st">&#39;Wavelength (nm)&#39;</span>) <span class="co"># renaming column, less typing later on. </span></span>
<span id="cb310-11"><a href="modelling-non-linear-regression.html#cb310-11" tabindex="-1"></a></span>
<span id="cb310-12"><a href="modelling-non-linear-regression.html#cb310-12" tabindex="-1"></a><span class="fu">head</span>(sds)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   wavelength   conc conc.units chemical intensity
##        &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt;
## 1        500 0.001  M          SDS          20.0 
## 2        500 0.0016 M          SDS          18.6 
## 3        500 0.004  M          SDS           7.02
## 4        500 0.0048 M          SDS           1.12
## 5        500 0.0056 M          SDS           5.48
## 6        500 0.0064 M          SDS           7.72</code></pre>
<p>And a quick plot to visualize our data:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="modelling-non-linear-regression.html#cb312-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sds, </span>
<span id="cb312-2"><a href="modelling-non-linear-regression.html#cb312-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> wavelength,</span>
<span id="cb312-3"><a href="modelling-non-linear-regression.html#cb312-3" tabindex="-1"></a>           <span class="at">y =</span> intensity, </span>
<span id="cb312-4"><a href="modelling-non-linear-regression.html#cb312-4" tabindex="-1"></a>           <span class="at">colour =</span> conc)) <span class="sc">+</span></span>
<span id="cb312-5"><a href="modelling-non-linear-regression.html#cb312-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-185-1.png" width="672" /></p>
<p>Alright, alright, alright. Things are looking like we’d expect with some well behaved data. By plotting each point individually, we can really see the noise inherent with each reading. For a more robust analysis we’d typically conduct several replicates and average out the spectra for each concentration or apply some kind of model to smooth each peak. But today, we’re just interested in getting the maximal fluorescence emission intensity from each reading.</p>
<p>Let’s first annotate our plate to find the highest point, then go about extracting our data for analysis.</p>
<div id="annotating-maximal-values" class="section level3 hasAnchor" number="21.1.1">
<h3><span class="header-section-number">21.1.1</span> Annotating maximal values<a href="modelling-non-linear-regression.html#annotating-maximal-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Annotating the maximal point on the plot will take a bit more code than actually obtaining it from the data. For this we’ll need to use the <code>ggpmisc</code> package which contains miscellaneous extensions for <code>ggplot2</code>, and <code>ggrepel</code> so our labels won’t overlap.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="modelling-non-linear-regression.html#cb313-1" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb313-2"><a href="modelling-non-linear-regression.html#cb313-2" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb313-3"><a href="modelling-non-linear-regression.html#cb313-3" tabindex="-1"></a></span>
<span id="cb313-4"><a href="modelling-non-linear-regression.html#cb313-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sds, </span>
<span id="cb313-5"><a href="modelling-non-linear-regression.html#cb313-5" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> wavelength,</span>
<span id="cb313-6"><a href="modelling-non-linear-regression.html#cb313-6" tabindex="-1"></a>           <span class="at">y =</span> intensity, </span>
<span id="cb313-7"><a href="modelling-non-linear-regression.html#cb313-7" tabindex="-1"></a>           <span class="at">colour =</span> conc)) <span class="sc">+</span></span>
<span id="cb313-8"><a href="modelling-non-linear-regression.html#cb313-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb313-9"><a href="modelling-non-linear-regression.html#cb313-9" tabindex="-1"></a>  ggpmisc<span class="sc">::</span><span class="fu">stat_peaks</span>(<span class="at">span =</span> <span class="cn">NULL</span>,</span>
<span id="cb313-10"><a href="modelling-non-linear-regression.html#cb313-10" tabindex="-1"></a>                      <span class="at">geom =</span> <span class="st">&quot;text_repel&quot;</span>, <span class="co"># From ggrepel</span></span>
<span id="cb313-11"><a href="modelling-non-linear-regression.html#cb313-11" tabindex="-1"></a>                      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..y.label.., ..x.label..)),</span>
<span id="cb313-12"><a href="modelling-non-linear-regression.html#cb313-12" tabindex="-1"></a>                      <span class="at">x.label.fmt =</span> <span class="st">&quot;at %.0f nm&quot;</span>,</span>
<span id="cb313-13"><a href="modelling-non-linear-regression.html#cb313-13" tabindex="-1"></a>                      <span class="at">y.label.fmt =</span> <span class="st">&quot;Max intensity = %.0f&quot;</span>,</span>
<span id="cb313-14"><a href="modelling-non-linear-regression.html#cb313-14" tabindex="-1"></a>                      <span class="at">segment.colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb313-15"><a href="modelling-non-linear-regression.html#cb313-15" tabindex="-1"></a>                      <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;inches&quot;</span>)),</span>
<span id="cb313-16"><a href="modelling-non-linear-regression.html#cb313-16" tabindex="-1"></a>                      <span class="at">nudge_x =</span> <span class="dv">60</span>,</span>
<span id="cb313-17"><a href="modelling-non-linear-regression.html#cb313-17" tabindex="-1"></a>                      <span class="at">nudge_y =</span> <span class="dv">200</span>) <span class="sc">+</span></span>
<span id="cb313-18"><a href="modelling-non-linear-regression.html#cb313-18" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(conc))</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-186-1.png" width="672" /></p>
<p>By faceting the plot (i.e. arranging many smaller plots vs. one large one), we can easily see the increase in emission peak intensity as the concentration of SDS increases. Likewise, we can avoid the messy overlap of the max intensity annotations.</p>
<p>This is only one way to plot this data, but this is sufficient because we’re simply inspecting our data at this point. And here we can see that the intensity all occur around a similar wavelength (~ 528 nm)</p>
</div>
<div id="extracting-maximal-values" class="section level3 hasAnchor" number="21.1.2">
<h3><span class="header-section-number">21.1.2</span> Extracting maximal values<a href="modelling-non-linear-regression.html#extracting-maximal-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The plots we made above are great for inspecting our data, but what we really want is the maximal emission intensity value to calculate the CMC of SDS. We can see the maximal values on the plots, but there’s no way we’re typing those in manually. So let’s go ahead and get out maximal values from our dataset:</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="modelling-non-linear-regression.html#cb314-1" tabindex="-1"></a>sdsMax <span class="ot">&lt;-</span> sds <span class="sc">%&gt;%</span></span>
<span id="cb314-2"><a href="modelling-non-linear-regression.html#cb314-2" tabindex="-1"></a>  <span class="fu">group_by</span>(chemical, conc.units, conc) <span class="sc">%&gt;%</span></span>
<span id="cb314-3"><a href="modelling-non-linear-regression.html#cb314-3" tabindex="-1"></a>  <span class="fu">filter</span>(intensity <span class="sc">==</span> <span class="fu">max</span>(intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb314-4"><a href="modelling-non-linear-regression.html#cb314-4" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb314-5"><a href="modelling-non-linear-regression.html#cb314-5" tabindex="-1"></a></span>
<span id="cb314-6"><a href="modelling-non-linear-regression.html#cb314-6" tabindex="-1"></a><span class="fu">head</span>(sdsMax)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   wavelength   conc conc.units chemical intensity
##        &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt;
## 1       520  0.0056 M          SDS           28.1
## 2       524  0.0072 M          SDS          116. 
## 3       527  0.0064 M          SDS           65.3
## 4       527  0.008  M          SDS          768. 
## 5       528. 0.012  M          SDS          810. 
## 6       528  0.0048 M          SDS           22.0</code></pre>
<p>All we did was tell R to take the row with the highest emission intensity value per group. We specified <code>chemical</code>, <code>conc.units</code>, and <code>conc</code>, in case we had more chemicals in our dataset.</p>
<p>Our maximum values match those we see in our plot above. Let’s see how they stack up against each other:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="modelling-non-linear-regression.html#cb316-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sdsMax, </span>
<span id="cb316-2"><a href="modelling-non-linear-regression.html#cb316-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc, </span>
<span id="cb316-3"><a href="modelling-non-linear-regression.html#cb316-3" tabindex="-1"></a>           <span class="at">y =</span> intensity)) <span class="sc">+</span></span>
<span id="cb316-4"><a href="modelling-non-linear-regression.html#cb316-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:sdsMaxPlot"></span>
<img src="R4EnvChem_files/figure-html/sdsMaxPlot-1.png" alt="Plot of maximal fluoresence intensity at various concentrations of SDS." width="672" />
<p class="caption">
Figure 21.1: Plot of maximal fluoresence intensity at various concentrations of SDS.
</p>
</div>
</div>
</div>
<div id="modelling-sigmoid-curve" class="section level2 hasAnchor" number="21.2">
<h2><span class="header-section-number">21.2</span> Modelling Sigmoid Curve<a href="modelling-non-linear-regression.html#modelling-sigmoid-curve" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So we want to find the critical micelle concentration of SDS using the maximum fluorescence emission. The CMC is at the ‘midpoint of the sinusoid curve’. Which means we’ll need to a) plot a sinusoid curve and b) extract the midpoint.</p>
<p>The ‘sinusoid’ or ‘S-shaped’ curve mentioned in the lab manual is known as a <em>logistic regression</em>. Logistic regressions are often used to model systems with a largely binary outcome. In other words, the system starts at point A, and remains there for awhile, before ‘quickly’ jumping up (or down) to level B and remain there for the remainder. Examples include saturation and dose response curves.</p>
<p>For our CMC working data, the fluorescence intensity is low when the <span class="math inline">\([SDS] &lt; CMC\)</span>, as micelles are not able to form. However once <span class="math inline">\([SDS] &gt; CMC\)</span>, micelles form and the fluorescence intensity increases. We can see this trend in <a href="modelling-non-linear-regression.html#fig:sdsMaxPlot">21.1</a>.</p>
<p>There are different forms of logistic regression equations. The simplest form is the 1 parameter, or sigmoid, function which looks like <span class="math inline">\(f(x) = \frac{1}{1+e^{-x}}\)</span>. The outputs for this function are between 0 and 1. We could apply this formula to our model if we somehow normalized our fluorescence intensity accordingly. An alternative is to use the <em>four parameter logistic regression</em>, which looks like:</p>
<p><span class="math display">\[f(x) =  \frac{a - d}{\left[ 1 + \left( \frac{x}{c} \right)^b \right ]} + d\]</span></p>
<p>where:</p>
<ul>
<li><strong>a</strong> = the theoretical response when <span class="math inline">\(x = 0\)</span></li>
<li><strong>b</strong> = the slope factor</li>
<li><strong>c</strong> = the mid-range concentration (inflection point)
<ul>
<li>This is commonly referred to as the <em>EC50</em> or <em>LC50</em> in toxicology/pharmacology.</li>
</ul></li>
<li><strong>d</strong> = the theoretical response when <span class="math inline">\(x = \infty\)</span></li>
</ul>
<p>Why do we need such a complicated formula for our model? Well, looking again at <a href="modelling-non-linear-regression.html#fig:sdsMaxPlot">21.1</a> we see that the lower point is approximately 20, and not zero. Likewise, the upper limit appears to be around 825. The slope factor is necessary because the transition from the low to high steady state occurs over a small, but not immeasurable, concentration range. And lastly, by including the inflection point, we can calculate exactly for this value using <code>R</code> to get the CMC estimate.</p>
<div id="calculating-logistic-regression" class="section level3 hasAnchor" number="21.2.1">
<h3><span class="header-section-number">21.2.1</span> Calculating Logistic Regression<a href="modelling-non-linear-regression.html#calculating-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A strength of <code>R</code> is its flexibility in running various models, and logistic regression is no different. We can use a number of packages to reach these ends, specifically the <code>drc</code> package contains a plethora of functions for modelling dose response curves (hence <code>drc</code>). However, for this example we’ll use a more generalized approach. Earlier we talked about linear regression, where we adjust the slope and intercept of a linear equation to best fit our data (see Calibration Curves). Recall that this optimization is based on minimizing the distance between the model and all of the experimental points (<em>least squares</em>). Well the <code>stats</code> package has a function called <code>nls</code> that expands upon this to nonlinear models. Per the <code>nls</code> function description: “[nls] determine[s] the nonlinear (weighted) least_squared estimates of the parameters of a nonlinear model.”</p>
<p>So we can create a formula in <code>R</code> based on the four-parameter logistic regression described above. After that, we’ll need to produce some starting details from which the model can build off of. If we don’t tell <code>nls</code> where to start, it can’t function, as the search space is too large. Looking at <a href="modelling-non-linear-regression.html#fig:sdsMaxPlot">21.1</a>, the intensity appears to floor around 20; the intensity appears to max out around 820; the midpoint appears to be around 0.0075 M, and let’s say the slope is 1. Remember, these are starting values from which <code>nls</code> starts to optimize from, and not the actual values used to construct the model.</p>
<p>So, let’s create our model</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="modelling-non-linear-regression.html#cb317-1" tabindex="-1"></a>logisModel <span class="ot">&lt;-</span> <span class="fu">nls</span>(intensity <span class="sc">~</span>  (a<span class="sc">-</span>d)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> (conc <span class="sc">/</span>c)<span class="sc">^</span>b) <span class="sc">+</span> d, </span>
<span id="cb317-2"><a href="modelling-non-linear-regression.html#cb317-2" tabindex="-1"></a>                  <span class="at">data =</span> sdsMax, </span>
<span id="cb317-3"><a href="modelling-non-linear-regression.html#cb317-3" tabindex="-1"></a>                  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">20</span>,       <span class="co"># min intensity</span></span>
<span id="cb317-4"><a href="modelling-non-linear-regression.html#cb317-4" tabindex="-1"></a>                               <span class="at">b =</span> <span class="dv">1</span>,        <span class="co"># slope</span></span>
<span id="cb317-5"><a href="modelling-non-linear-regression.html#cb317-5" tabindex="-1"></a>                               <span class="at">c =</span> <span class="fl">0.0075</span>,   <span class="co"># CMC</span></span>
<span id="cb317-6"><a href="modelling-non-linear-regression.html#cb317-6" tabindex="-1"></a>                               <span class="at">d=</span> <span class="dv">820</span>)       <span class="co"># max intensity</span></span>
<span id="cb317-7"><a href="modelling-non-linear-regression.html#cb317-7" tabindex="-1"></a>                  )</span></code></pre></div>
<pre><code>## Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral): Missing value or an infinity produced when evaluating the model</code></pre>
<p>… and we get an error message. Get used to these when modelling! Don’t worry about understanding it completely, error messages are often written with programmers in mind so they can be a bit cryptic. You can often copy and paste these directly into any search engine to get some more information, but this one is simple enough: we either have a missing value or an infinity produced. Well we have six input parameters in our model: <code>a, b, c, d</code>, our independent variable <code>conc</code>, and our dependent variable <code>intensity</code>. We’ve also supplied starting values to all of them via the list we created inside the function. Therefore, one of our starting values must be too far off from a plausible start point and is causing troubles in the <code>nls</code> function. They all look good except for the slope start value <code>b = 1</code>.</p>
<p>The slope here is an approximation for the slope between the min value <code>a</code> and max value <code>d</code>. Looking at our data in <a href="modelling-non-linear-regression.html#fig:sdsMaxPlot">21.1</a>, that slope may be a bit shallow considering the large jump in intensity. Let’s increase the value of <code>b</code> and try again:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="modelling-non-linear-regression.html#cb319-1" tabindex="-1"></a>logisModel <span class="ot">&lt;-</span> <span class="fu">nls</span>(intensity <span class="sc">~</span>  (a<span class="sc">-</span>d)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> (conc <span class="sc">/</span>c)<span class="sc">^</span>b) <span class="sc">+</span> d, </span>
<span id="cb319-2"><a href="modelling-non-linear-regression.html#cb319-2" tabindex="-1"></a>                  <span class="at">data =</span> sdsMax, </span>
<span id="cb319-3"><a href="modelling-non-linear-regression.html#cb319-3" tabindex="-1"></a>                  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">20</span>,       <span class="co"># min intensity</span></span>
<span id="cb319-4"><a href="modelling-non-linear-regression.html#cb319-4" tabindex="-1"></a>                               <span class="at">b =</span> <span class="dv">10</span>,       <span class="co"># new slope</span></span>
<span id="cb319-5"><a href="modelling-non-linear-regression.html#cb319-5" tabindex="-1"></a>                               <span class="at">c =</span> <span class="fl">0.0075</span>,   <span class="co"># CMC</span></span>
<span id="cb319-6"><a href="modelling-non-linear-regression.html#cb319-6" tabindex="-1"></a>                               <span class="at">d=</span> <span class="dv">820</span>)       <span class="co"># max intensity</span></span>
<span id="cb319-7"><a href="modelling-non-linear-regression.html#cb319-7" tabindex="-1"></a>                  )</span></code></pre></div>
<p>Eh, no errors! Once you progress beyond simple linear regressions, modelling becomes more of a craft. If we were trying to apply this model to multiple datasets, we would probably want to shop around <code>cran</code> to find a package with self-starting models. This way we can circumvent having to supply starting parameters. Anyways, that’s for another day.</p>
<p>For now, let’s take a look at our model outputs which are all stored in the <code>logisModel</code> variable. To this end, we’ll use the <code>broom</code> package discussed in <a href="modelling-linear-regression.html#modelling-linear-regression">Modelling: Linear Regression</a>. Specifically, we’ll use <code>tidy</code> to get an output of our estimated model parameters (i.e. <code>a,b,c</code>, and <code>d</code>), and <code>augment</code> for a data frame of containing the input values, and the estimated intensity values.</p>
<p>Let’s look at our fitted values:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="modelling-non-linear-regression.html#cb320-1" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb320-2"><a href="modelling-non-linear-regression.html#cb320-2" tabindex="-1"></a></span>
<span id="cb320-3"><a href="modelling-non-linear-regression.html#cb320-3" tabindex="-1"></a>augment <span class="ot">&lt;-</span> <span class="fu">augment</span>(logisModel)</span>
<span id="cb320-4"><a href="modelling-non-linear-regression.html#cb320-4" tabindex="-1"></a>augment</span></code></pre></div>
<pre><code>## # A tibble: 9 × 4
##   intensity   conc .fitted   .resid
##       &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1      28.1 0.0056    49.4 -21.3   
## 2     116.  0.0072   116.   -0.123 
## 3      65.3 0.0064    49.7  15.6   
## 4     768.  0.008    768.    0.0977
## 5     810.  0.012    810.   -0.0861
## 6      22.0 0.0048    49.4 -27.5   
## 7      93.0 0.001     49.4  43.5   
## 8      31.7 0.004     49.4 -17.7   
## 9      57.0 0.0016    49.4   7.51</code></pre>
<p>What we can see here from <code>augment</code> are the <code>intensity</code> and <code>conc</code> values we inputted into R. <code>.fitted</code> are the intensity values for a given concentration fitted to out model, and <code>.resid</code> is the residuals, the difference between the actual and estimated values.</p>
<p>Let’s go ahead and plot our actual and fitted values against each other.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="modelling-non-linear-regression.html#cb322-1" tabindex="-1"></a><span class="fu">ggplot</span>(augment, <span class="fu">aes</span>(<span class="at">x =</span> conc, <span class="at">y =</span> intensity, <span class="at">colour =</span> <span class="st">&quot;actual&quot;</span>)) <span class="sc">+</span></span>
<span id="cb322-2"><a href="modelling-non-linear-regression.html#cb322-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb322-3"><a href="modelling-non-linear-regression.html#cb322-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted)) <span class="sc">+</span></span>
<span id="cb322-4"><a href="modelling-non-linear-regression.html#cb322-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">colour =</span> <span class="st">&quot;fitted&quot;</span>)) </span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-191-1.png" width="672" /></p>
<p>Looks pretty good, although it’s interesting how the baseline at lower concentrations doesn’t plateau like the model values. You’ll note that the line produced by <code>geom_line</code> will only draw a straight line between points. There are ways to address this, but we don’t need to for our needs right now.</p>
<p>There doesn’t appear to be any gross outliers in our model, so it seems to have done a good job. We can verify this by checking the residuals(see <a href="augmented-outputs-and-evaluating-your-model.html#plotting-residuals">Plotting residuals</a>):</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="modelling-non-linear-regression.html#cb323-1" tabindex="-1"></a><span class="fu">ggplot</span>(augment, <span class="fu">aes</span>(<span class="at">x =</span> conc, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb323-2"><a href="modelling-non-linear-regression.html#cb323-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
<p>We can’t see any obvious patterns in the residuals (i.e. all are negative), so we can have further confidence in the fit of our model.</p>
</div>
<div id="extracting-model-parameters" class="section level3 hasAnchor" number="21.2.2">
<h3><span class="header-section-number">21.2.2</span> Extracting model parameters<a href="modelling-non-linear-regression.html#extracting-model-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To extract the model parameters <code>a</code>, <code>b</code>, <code>c</code>, and <code>d</code> we can use the <code>tidy</code> function:</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="modelling-non-linear-regression.html#cb324-1" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb324-2"><a href="modelling-non-linear-regression.html#cb324-2" tabindex="-1"></a></span>
<span id="cb324-3"><a href="modelling-non-linear-regression.html#cb324-3" tabindex="-1"></a>tidy <span class="ot">&lt;-</span> <span class="fu">tidy</span>(logisModel)</span>
<span id="cb324-4"><a href="modelling-non-linear-regression.html#cb324-4" tabindex="-1"></a>tidy</span></code></pre></div>
<pre><code>## # A tibble: 4 × 5
##   term   estimate  std.error statistic       p.value
##   &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
## 1 a      49.4     11.1            4.44 0.00678      
## 2 b      49.0      9.65           5.07 0.00385      
## 3 c       0.00755  0.0000785     96.2  0.00000000230
## 4 d     810.      27.3           29.7  0.000000808</code></pre>
<p>Looking past the scientific notation, our model values are pretty similar to what we estimated. Specifically, <code>c</code>, our midpoint value is 0.0076 M. Not too bad from our original estimate. And recall that the midpoint of our curve corresponds to the critical micelle concentration of SDS, which we’ve estimated to be 0.0076M. Not too far from the literature value of 0.0081 M.</p>
</div>
</div>
<div id="summary-6" class="section level2 hasAnchor" number="21.3">
<h2><span class="header-section-number">21.3</span> Summary<a href="modelling-non-linear-regression.html#summary-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter we reviewed non-linear modelling using a case study with four-parameter logistic regression. While the equation covered here might not be the one you need, the steps are identical:</p>
<ol style="list-style-type: decimal">
<li>Tidy and visually inspect your data to see and patterns</li>
<li>Determine which mathematical model you’ll be using</li>
<li>Use the <code>nls</code> or other suitable package to calculate your model; you may need to tinker around with the starting values, estimate them from your data.</li>
<li>Verify your model outputs (both fitted and residuals).</li>
</ol>
<p>Lastly, we’ve also touched upon labelling maximal values in a plot using the <code>ggpmisc</code> package. Notably useful for determining local peaks in spectroscopy data.</p>
</div>
<div id="exercise-15" class="section level2 hasAnchor" number="21.4">
<h2><span class="header-section-number">21.4</span> Exercise<a href="modelling-non-linear-regression.html#exercise-15" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There is a set of exercises available for this chapter!</p>
<p><strong>Not sure how to access and work on the exercise Rmd files? </strong></p>
<ul>
<li><p>Refer to <a href="how-to-use-this-textbook.html#running-tests-for-your-exercises">Running Tests for Your Exercises</a> for step-by-step instructions on accessing the exercises and working within the UofT JupyterHub’s RStudio environment.</p></li>
<li><p>Alternatively, if you’d like to simply access the individual files, you can download them directly from this <a href="https://github.com/UofTChem-Teaching/R4EnvChem-Exercises">repository</a>.</p></li>
</ul>
<p>Always remember to save your progress regularly and consult the textbook’s guidelines for submitting your completed exercises.</p>

<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div class="csl-entry">
Wickham, H. 2009. <em>Ggplot2: Elegant Graphics for Data Analysis.</em> New York: Springer-Verlag.
</div>
<div class="csl-entry">
Wickham, Hadley. 2014. <span>“Tidy Data.”</span> <em>Journal of Statistical Software</em> 59 (1): 1–23. <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.
</div>
</div>
</div>
</div>







            </section>

          </div>
        </div>
      </div>
<a href="augmented-outputs-and-evaluating-your-model.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/UofTChem-Teaching/R4EnvChem/edit/main/src/05-modelling-in-r/03-non-linear-models.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/UofTChem-Teaching/R4EnvChem/blob/main/src/05-modelling-in-r/03-non-linear-models.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

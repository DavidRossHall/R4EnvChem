<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Visualizations | R for Environmental Chemistry</title>
  <meta name="description" content="This is a proof-of-concept for a further full length textbook." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Visualizations | R for Environmental Chemistry" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a proof-of-concept for a further full length textbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Visualizations | R for Environmental Chemistry" />
  
  <meta name="twitter:description" content="This is a proof-of-concept for a further full length textbook." />
  

<meta name="author" content="David Hall, Steven Kutarna, Kristen Yeh, Hui Peng and Jessica D’eon" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="summarizing-data.html"/>
<link rel="next" href="modelling-linear-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.28/datatables.js"></script>
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Environmental Chemistry</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#providing-feedback"><i class="fa fa-check"></i>Providing Feedback</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowlegements"><i class="fa fa-check"></i>Acknowlegements</a></li>
</ul></li>
<li class="part"><span><b>Part 1: Getting Started in R</b></span></li>
<li class="chapter" data-level="1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Intro to R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#r-language"><i class="fa fa-check"></i><b>1.1</b> R Language</a></li>
<li class="chapter" data-level="1.2" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#setting-up-your-environment"><i class="fa fa-check"></i><b>1.3</b> Setting Up Your Environment</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#working-remotely-recommended"><i class="fa fa-check"></i><b>1.3.1</b> Working Remotely (Recommended)</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#working-locally"><i class="fa fa-check"></i><b>1.3.2</b> Working Locally</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#using-rstudio"><i class="fa fa-check"></i><b>1.4</b> Using RStudio</a></li>
<li class="chapter" data-level="1.5" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#running-r-code"><i class="fa fa-check"></i><b>1.5</b> Running R Code</a></li>
<li class="chapter" data-level="1.6" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#customizing-rstudio"><i class="fa fa-check"></i><b>1.6</b> Customizing RStudio</a></li>
<li class="chapter" data-level="1.7" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#where-to-get-help"><i class="fa fa-check"></i><b>1.7</b> Where to get help</a></li>
<li class="chapter" data-level="1.8" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#summary"><i class="fa fa-check"></i><b>1.8</b> Summary</a></li>
<li class="chapter" data-level="1.9" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#exercise"><i class="fa fa-check"></i><b>1.9</b> Exercise</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#setup"><i class="fa fa-check"></i><b>1.9.1</b> Setup</a></li>
<li class="chapter" data-level="1.9.2" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#basic-r-commands"><i class="fa fa-check"></i><b>1.9.2</b> Basic R Commands</a></li>
<li class="chapter" data-level="1.9.3" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#using-the-help-function"><i class="fa fa-check"></i><b>1.9.3</b> USing the Help Function</a></li>
<li class="chapter" data-level="1.9.4" data-path="intro-to-r-and-rstudio.html"><a href="intro-to-r-and-rstudio.html#reflection"><i class="fa fa-check"></i><b>1.9.4</b> Reflection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio-projects.html"><a href="rstudio-projects.html"><i class="fa fa-check"></i><b>2</b> RStudio Projects</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rstudio-projects.html"><a href="rstudio-projects.html#uploading-files-to-rstudio-server-on-jupyterhub"><i class="fa fa-check"></i><b>2.1</b> Uploading Files to RStudio server on JupyterHub</a></li>
<li class="chapter" data-level="2.2" data-path="rstudio-projects.html"><a href="rstudio-projects.html#paths-and-directories"><i class="fa fa-check"></i><b>2.2</b> Paths and directories</a></li>
<li class="chapter" data-level="2.3" data-path="rstudio-projects.html"><a href="rstudio-projects.html#importing-a-project"><i class="fa fa-check"></i><b>2.3</b> Importing a project</a></li>
<li class="chapter" data-level="2.4" data-path="rstudio-projects.html"><a href="rstudio-projects.html#creating-an-rstudio-project"><i class="fa fa-check"></i><b>2.4</b> Creating an RStudio project</a></li>
<li class="chapter" data-level="2.5" data-path="rstudio-projects.html"><a href="rstudio-projects.html#a-sneak-peek-at-.rmd-files"><i class="fa fa-check"></i><b>2.5</b> A sneak peek at <code>.Rmd</code> files</a></li>
<li class="chapter" data-level="2.6" data-path="rstudio-projects.html"><a href="rstudio-projects.html#summary-1"><i class="fa fa-check"></i><b>2.6</b> Summary</a></li>
<li class="chapter" data-level="2.7" data-path="rstudio-projects.html"><a href="rstudio-projects.html#exercise-1"><i class="fa fa-check"></i><b>2.7</b> Exercise</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="rstudio-projects.html"><a href="rstudio-projects.html#get-started"><i class="fa fa-check"></i><b>2.7.1</b> Get Started:</a></li>
<li class="chapter" data-level="2.7.2" data-path="rstudio-projects.html"><a href="rstudio-projects.html#confirm-your-working-directory"><i class="fa fa-check"></i><b>2.7.2</b> Confirm Your Working Directory</a></li>
<li class="chapter" data-level="2.7.3" data-path="rstudio-projects.html"><a href="rstudio-projects.html#creating-your-own-project"><i class="fa fa-check"></i><b>2.7.3</b> Creating Your Own Project:</a></li>
<li class="chapter" data-level="2.7.4" data-path="rstudio-projects.html"><a href="rstudio-projects.html#create-your-rmd-file"><i class="fa fa-check"></i><b>2.7.4</b> Create Your Rmd File:</a></li>
<li class="chapter" data-level="2.7.5" data-path="rstudio-projects.html"><a href="rstudio-projects.html#upload-a-file-from-your-computer"><i class="fa fa-check"></i><b>2.7.5</b> Upload a file from your computer:</a></li>
<li class="chapter" data-level="2.7.6" data-path="rstudio-projects.html"><a href="rstudio-projects.html#reflection-1"><i class="fa fa-check"></i><b>2.7.6</b> Reflection:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html"><i class="fa fa-check"></i><b>3</b> How to Use This Textbook</a>
<ul>
<li class="chapter" data-level="3.1" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#keep-in-mind"><i class="fa fa-check"></i><b>3.1</b> Keep in mind</a></li>
<li class="chapter" data-level="3.2" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#useful-features"><i class="fa fa-check"></i><b>3.2</b> Useful features</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#searching-throughout-the-textbook"><i class="fa fa-check"></i><b>3.2.1</b> Searching throughout the textbook</a></li>
<li class="chapter" data-level="3.2.2" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#how-to-view-the-original-r-markdown-of-textbook-chapters"><i class="fa fa-check"></i><b>3.2.2</b> How to view the original R Markdown of textbook chapters</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="how-to-use-this-textbook.html"><a href="how-to-use-this-textbook.html#end-of-chapter-exercises"><i class="fa fa-check"></i><b>3.3</b> End-of-chapter Exercises</a></li>
</ul></li>
<li class="part"><span><b>Part 2: How to Code in R</b></span></li>
<li class="chapter" data-level="4" data-path="r-coding-basics.html"><a href="r-coding-basics.html"><i class="fa fa-check"></i><b>4</b> R Coding Basics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#variables"><i class="fa fa-check"></i><b>4.1</b> Variables</a></li>
<li class="chapter" data-level="4.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-types"><i class="fa fa-check"></i><b>4.2</b> Data types</a></li>
<li class="chapter" data-level="4.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-structures"><i class="fa fa-check"></i><b>4.3</b> Data structures</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#data-frames"><i class="fa fa-check"></i><b>4.3.1</b> Data Frames</a></li>
<li class="chapter" data-level="4.3.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#accessing-data-in-subfolders"><i class="fa fa-check"></i><b>4.3.2</b> Accessing data in subfolders</a></li>
<li class="chapter" data-level="4.3.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#other-data-structures"><i class="fa fa-check"></i><b>4.3.3</b> Other data structures</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="r-coding-basics.html"><a href="r-coding-basics.html#conditional-statements"><i class="fa fa-check"></i><b>4.4</b> Conditional Statements</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#understanding-r-syntax"><i class="fa fa-check"></i><b>4.4.1</b> Understanding R Syntax</a></li>
<li class="chapter" data-level="4.4.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#the-basic-if-statement"><i class="fa fa-check"></i><b>4.4.2</b> The basic <code>if</code> statement</a></li>
<li class="chapter" data-level="4.4.3" data-path="r-coding-basics.html"><a href="r-coding-basics.html#expanding-with-else-and-else-if"><i class="fa fa-check"></i><b>4.4.3</b> Expanding with <code>else</code> and <code>else if</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="r-coding-basics.html"><a href="r-coding-basics.html#r-built-in-functions"><i class="fa fa-check"></i><b>4.5</b> R built-in functions</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="r-coding-basics.html"><a href="r-coding-basics.html#exploring-more-built-in-functions"><i class="fa fa-check"></i><b>4.5.1</b> Exploring More Built-In Functions</a></li>
<li class="chapter" data-level="4.5.2" data-path="r-coding-basics.html"><a href="r-coding-basics.html#function-documentation"><i class="fa fa-check"></i><b>4.5.2</b> Function documentation</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="r-coding-basics.html"><a href="r-coding-basics.html#summary-2"><i class="fa fa-check"></i><b>4.6</b> Summary</a></li>
<li class="chapter" data-level="4.7" data-path="r-coding-basics.html"><a href="r-coding-basics.html#exercise-2"><i class="fa fa-check"></i><b>4.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html"><i class="fa fa-check"></i><b>5</b> Workflows for R Coding</a>
<ul>
<li class="chapter" data-level="5.1" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#creating-or-opening-an-r-markdown-document"><i class="fa fa-check"></i><b>5.1</b> Creating or opening an R Markdown document</a></li>
<li class="chapter" data-level="5.2" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#workspace-and-whats-real"><i class="fa fa-check"></i><b>5.2</b> Workspace and what’s real</a></li>
<li class="chapter" data-level="5.3" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#saving-r-markdown"><i class="fa fa-check"></i><b>5.3</b> Saving R Markdown</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#what-should-i-save"><i class="fa fa-check"></i><b>5.3.1</b> What should I save?</a></li>
<li class="chapter" data-level="5.3.2" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#saving-objects"><i class="fa fa-check"></i><b>5.3.2</b> Saving objects</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#script-formatting"><i class="fa fa-check"></i><b>5.4</b> Script formatting</a></li>
<li class="chapter" data-level="5.5" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#viewing-data-and-code-simultaneously"><i class="fa fa-check"></i><b>5.5</b> Viewing data and code simultaneously</a></li>
<li class="chapter" data-level="5.6" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#troubleshooting-error-messages"><i class="fa fa-check"></i><b>5.6</b> Troubleshooting error messages</a></li>
<li class="chapter" data-level="5.7" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#summary-3"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
<li class="chapter" data-level="5.8" data-path="workflows-for-r-coding.html"><a href="workflows-for-r-coding.html#exercise-3"><i class="fa fa-check"></i><b>5.8</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="using-r-markdown.html"><a href="using-r-markdown.html"><i class="fa fa-check"></i><b>6</b> Using R Markdown</a>
<ul>
<li class="chapter" data-level="6.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#getting-started-with-r-markdown"><i class="fa fa-check"></i><b>6.1</b> Getting started with R Markdown</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#understanding-r-markdown"><i class="fa fa-check"></i><b>6.1.1</b> Understanding R Markdown</a></li>
<li class="chapter" data-level="6.1.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#running-code-in-r-markdown"><i class="fa fa-check"></i><b>6.1.2</b> Running code in R Markdown</a></li>
<li class="chapter" data-level="6.1.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#headings-and-subheadings"><i class="fa fa-check"></i><b>6.1.3</b> Headings and Subheadings</a></li>
<li class="chapter" data-level="6.1.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#latex-basics"><i class="fa fa-check"></i><b>6.1.4</b> LaTeX Basics</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#compiling-your-final-report"><i class="fa fa-check"></i><b>6.2</b> Compiling your final report</a></li>
<li class="chapter" data-level="6.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#authoring-with-r-markdown"><i class="fa fa-check"></i><b>6.3</b> Authoring with R Markdown</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-markdown-syntax"><i class="fa fa-check"></i><b>6.3.1</b> R markdown syntax</a></li>
<li class="chapter" data-level="6.3.2" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-code-chunk-options"><i class="fa fa-check"></i><b>6.3.2</b> R code chunk options</a></li>
<li class="chapter" data-level="6.3.3" data-path="using-r-markdown.html"><a href="using-r-markdown.html#inserting-images"><i class="fa fa-check"></i><b>6.3.3</b> Inserting images</a></li>
<li class="chapter" data-level="6.3.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#generating-tables"><i class="fa fa-check"></i><b>6.3.4</b> Generating tables</a></li>
<li class="chapter" data-level="6.3.5" data-path="using-r-markdown.html"><a href="using-r-markdown.html#spellcheck-in-r-markdown"><i class="fa fa-check"></i><b>6.3.5</b> Spellcheck in R Markdown</a></li>
<li class="chapter" data-level="6.3.6" data-path="using-r-markdown.html"><a href="using-r-markdown.html#exporting-r-markdown-documents"><i class="fa fa-check"></i><b>6.3.6</b> Exporting R Markdown documents</a></li>
<li class="chapter" data-level="6.3.7" data-path="using-r-markdown.html"><a href="using-r-markdown.html#rstudio-tips-and-tricks"><i class="fa fa-check"></i><b>6.3.7</b> RStudio tips and tricks</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-markdown-resources"><i class="fa fa-check"></i><b>6.4</b> R Markdown resources</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>7</b> R Packages</a>
<ul>
<li class="chapter" data-level="7.1" data-path="r-packages.html"><a href="r-packages.html#what-are-r-packages"><i class="fa fa-check"></i><b>7.1</b> What are R packages?</a></li>
<li class="chapter" data-level="7.2" data-path="r-packages.html"><a href="r-packages.html#how-to-use-r-packages"><i class="fa fa-check"></i><b>7.2</b> How to use R packages</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="r-packages.html"><a href="r-packages.html#how-to-install-packages"><i class="fa fa-check"></i><b>7.2.1</b> How to install packages</a></li>
<li class="chapter" data-level="7.2.2" data-path="r-packages.html"><a href="r-packages.html#how-to-load-packages"><i class="fa fa-check"></i><b>7.2.2</b> How to load packages</a></li>
<li class="chapter" data-level="7.2.3" data-path="r-packages.html"><a href="r-packages.html#calling-specific-functions"><i class="fa fa-check"></i><b>7.2.3</b> Calling specific functions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="r-packages.html"><a href="r-packages.html#tidyverse-the-golden-toolbox-of-r"><i class="fa fa-check"></i><b>7.3</b> Tidyverse: The Golden Toolbox of R</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="r-packages.html"><a href="r-packages.html#loading-the-tidyverse"><i class="fa fa-check"></i><b>7.3.1</b> Loading the Tidyverse</a></li>
<li class="chapter" data-level="7.3.2" data-path="r-packages.html"><a href="r-packages.html#data-visualization"><i class="fa fa-check"></i><b>7.3.2</b> Data Visualization</a></li>
<li class="chapter" data-level="7.3.3" data-path="r-packages.html"><a href="r-packages.html#data-manipulation"><i class="fa fa-check"></i><b>7.3.3</b> Data Manipulation</a></li>
<li class="chapter" data-level="7.3.4" data-path="r-packages.html"><a href="r-packages.html#efficient-data-reading"><i class="fa fa-check"></i><b>7.3.4</b> Efficient Data Reading</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="r-packages.html"><a href="r-packages.html#smile-handling-chemical-structures-in-r"><i class="fa fa-check"></i><b>7.4</b> Smile: Handling Chemical Structures in R</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="r-packages.html"><a href="r-packages.html#installation"><i class="fa fa-check"></i><b>7.4.1</b> Installation</a></li>
<li class="chapter" data-level="7.4.2" data-path="r-packages.html"><a href="r-packages.html#a-simple-example"><i class="fa fa-check"></i><b>7.4.2</b> A simple example</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="r-packages.html"><a href="r-packages.html#summary-4"><i class="fa fa-check"></i><b>7.5</b> Summary</a></li>
<li class="chapter" data-level="7.6" data-path="r-packages.html"><a href="r-packages.html#exercise-4"><i class="fa fa-check"></i><b>7.6</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>Part 3: Data Wrangling in R</b></span></li>
<li class="chapter" data-level="8" data-path="intro-to-data-wrangling.html"><a href="intro-to-data-wrangling.html"><i class="fa fa-check"></i><b>8</b> Intro to Data Wrangling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="intro-to-data-wrangling.html"><a href="intro-to-data-wrangling.html#example-data"><i class="fa fa-check"></i><b>8.1</b> Example Data</a></li>
<li class="chapter" data-level="8.2" data-path="intro-to-data-wrangling.html"><a href="intro-to-data-wrangling.html#sneak-peek-at-data-wrangling"><i class="fa fa-check"></i><b>8.2</b> Sneak Peek at Data Wrangling</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="intro-to-data-wrangling.html"><a href="intro-to-data-wrangling.html#setting-up"><i class="fa fa-check"></i><b>8.2.1</b> Setting Up</a></li>
<li class="chapter" data-level="8.2.2" data-path="intro-to-data-wrangling.html"><a href="intro-to-data-wrangling.html#tidying-our-data"><i class="fa fa-check"></i><b>8.2.2</b> Tidying Our Data</a></li>
<li class="chapter" data-level="8.2.3" data-path="intro-to-data-wrangling.html"><a href="intro-to-data-wrangling.html#investigating-storm-patterns"><i class="fa fa-check"></i><b>8.2.3</b> Investigating Storm Patterns</a></li>
<li class="chapter" data-level="8.2.4" data-path="intro-to-data-wrangling.html"><a href="intro-to-data-wrangling.html#visualization-geographical-distribution"><i class="fa fa-check"></i><b>8.2.4</b> Visualization: Geographical Distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="intro-to-data-wrangling.html"><a href="intro-to-data-wrangling.html#further-reading"><i class="fa fa-check"></i><b>8.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html"><i class="fa fa-check"></i><b>9</b> Importing Your Data Into R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#csv-files"><i class="fa fa-check"></i><b>9.1</b> .csv files</a></li>
<li class="chapter" data-level="9.2" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#read_csv"><i class="fa fa-check"></i><b>9.2</b> read_csv</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#tibbles-vs.-data-frames"><i class="fa fa-check"></i><b>9.2.1</b> Tibbles vs. data frames</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#importing-other-data-types"><i class="fa fa-check"></i><b>9.3</b> Importing other data types</a></li>
<li class="chapter" data-level="9.4" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#saving-data"><i class="fa fa-check"></i><b>9.4</b> Saving data</a></li>
<li class="chapter" data-level="9.5" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#further-reading-1"><i class="fa fa-check"></i><b>9.5</b> Further Reading</a></li>
<li class="chapter" data-level="9.6" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#exercise-5"><i class="fa fa-check"></i><b>9.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tidying-your-data.html"><a href="tidying-your-data.html"><i class="fa fa-check"></i><b>10</b> Tidying Your Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tidying-your-data.html"><a href="tidying-your-data.html#what-is-tidy-data"><i class="fa fa-check"></i><b>10.1</b> What is tidy data?</a></li>
<li class="chapter" data-level="10.2" data-path="tidying-your-data.html"><a href="tidying-your-data.html#tools-to-tidy-your-data"><i class="fa fa-check"></i><b>10.2</b> Tools to tidy your data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tidying-your-data.html"><a href="tidying-your-data.html#making-data-longer"><i class="fa fa-check"></i><b>10.2.1</b> Making data ‘longer’</a></li>
<li class="chapter" data-level="10.2.2" data-path="tidying-your-data.html"><a href="tidying-your-data.html#making-data-wider"><i class="fa fa-check"></i><b>10.2.2</b> Making data ‘wider’</a></li>
<li class="chapter" data-level="10.2.3" data-path="tidying-your-data.html"><a href="tidying-your-data.html#selection-helpers"><i class="fa fa-check"></i><b>10.2.3</b> Selection helpers</a></li>
<li class="chapter" data-level="10.2.4" data-path="tidying-your-data.html"><a href="tidying-your-data.html#seperating-columns"><i class="fa fa-check"></i><b>10.2.4</b> Seperating columns</a></li>
<li class="chapter" data-level="10.2.5" data-path="tidying-your-data.html"><a href="tidying-your-data.html#unitingcombining-columns"><i class="fa fa-check"></i><b>10.2.5</b> Uniting/combining columns</a></li>
<li class="chapter" data-level="10.2.6" data-path="tidying-your-data.html"><a href="tidying-your-data.html#renaming-columnsheaders"><i class="fa fa-check"></i><b>10.2.6</b> Renaming columns/headers</a></li>
<li class="chapter" data-level="10.2.7" data-path="tidying-your-data.html"><a href="tidying-your-data.html#chaining-multiple-operations"><i class="fa fa-check"></i><b>10.2.7</b> Chaining multiple operations</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tidying-your-data.html"><a href="tidying-your-data.html#tips-for-recording-data"><i class="fa fa-check"></i><b>10.3</b> Tips for recording data</a></li>
<li class="chapter" data-level="10.4" data-path="tidying-your-data.html"><a href="tidying-your-data.html#further-reading-2"><i class="fa fa-check"></i><b>10.4</b> Further reading</a></li>
<li class="chapter" data-level="10.5" data-path="tidying-your-data.html"><a href="tidying-your-data.html#chapter-references"><i class="fa fa-check"></i><b>10.5</b> Chapter References</a></li>
<li class="chapter" data-level="10.6" data-path="tidying-your-data.html"><a href="tidying-your-data.html#exercise-6"><i class="fa fa-check"></i><b>10.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html"><i class="fa fa-check"></i><b>11</b> Transform: Data Manipulation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#selecting-by-row-or-value"><i class="fa fa-check"></i><b>11.1</b> Selecting by row or value</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#logical-operators"><i class="fa fa-check"></i><b>11.1.1</b> Logical operators</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#arranging-rows"><i class="fa fa-check"></i><b>11.2</b> Arranging rows</a></li>
<li class="chapter" data-level="11.3" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#selecting-column-name"><i class="fa fa-check"></i><b>11.3</b> Selecting column name</a></li>
<li class="chapter" data-level="11.4" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#deleting-columns-or-rows"><i class="fa fa-check"></i><b>11.4</b> Deleting Columns or Rows</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#deleting-columns"><i class="fa fa-check"></i><b>11.4.1</b> Deleting columns</a></li>
<li class="chapter" data-level="11.4.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#deleting-rows"><i class="fa fa-check"></i><b>11.4.2</b> Deleting rows</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#adding-new-variables"><i class="fa fa-check"></i><b>11.5</b> Adding new variables</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#mutate-with-a-condition"><i class="fa fa-check"></i><b>11.5.1</b> Mutate with a condition</a></li>
<li class="chapter" data-level="11.5.2" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#useful-mutate-function"><i class="fa fa-check"></i><b>11.5.2</b> Useful mutate function</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#group-and-summarize-data"><i class="fa fa-check"></i><b>11.6</b> Group and summarize data</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#useful-summarize-functions"><i class="fa fa-check"></i><b>11.6.1</b> Useful summarize functions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#the-pipe-chaining-functions-together"><i class="fa fa-check"></i><b>11.7</b> The pipe: chaining functions together</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#notes-on-piping"><i class="fa fa-check"></i><b>11.7.1</b> Notes on piping</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#further-reading-3"><i class="fa fa-check"></i><b>11.8</b> Further reading</a></li>
<li class="chapter" data-level="11.9" data-path="transform-data-manipulation.html"><a href="transform-data-manipulation.html#exercise-7"><i class="fa fa-check"></i><b>11.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="functions-in-r.html"><a href="functions-in-r.html"><i class="fa fa-check"></i><b>12</b> Functions in R</a>
<ul>
<li class="chapter" data-level="12.1" data-path="functions-in-r.html"><a href="functions-in-r.html#functions"><i class="fa fa-check"></i><b>12.1</b> Functions</a></li>
<li class="chapter" data-level="12.2" data-path="functions-in-r.html"><a href="functions-in-r.html#when-to-use-functions"><i class="fa fa-check"></i><b>12.2</b> When to use functions</a></li>
<li class="chapter" data-level="12.3" data-path="functions-in-r.html"><a href="functions-in-r.html#exercise-8"><i class="fa fa-check"></i><b>12.3</b> Exercise</a></li>
</ul></li>
<li class="part"><span><b>Part 4: Data Analysis Toolbox</b></span></li>
<li class="chapter" data-level="13" data-path="introduction-to-data-analysis.html"><a href="introduction-to-data-analysis.html"><i class="fa fa-check"></i><b>13</b> Introduction to Data Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="introduction-to-data-analysis.html"><a href="introduction-to-data-analysis.html#example-data-1"><i class="fa fa-check"></i><b>13.1</b> Example Data</a></li>
<li class="chapter" data-level="13.2" data-path="introduction-to-data-analysis.html"><a href="introduction-to-data-analysis.html#further-reading-4"><i class="fa fa-check"></i><b>13.2</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>14</b> Summarizing Data</a>
<ul>
<li class="chapter" data-level="14.1" data-path="summarizing-data.html"><a href="summarizing-data.html#data-to-play-with"><i class="fa fa-check"></i><b>14.1</b> Data to play with</a></li>
<li class="chapter" data-level="14.2" data-path="summarizing-data.html"><a href="summarizing-data.html#summarizing-data-by-group"><i class="fa fa-check"></i><b>14.2</b> Summarizing data by group</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#further-summarize-operations"><i class="fa fa-check"></i><b>14.2.1</b> Further summarize operations</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="summarizing-data.html"><a href="summarizing-data.html#pretty-tables-with-flextable"><i class="fa fa-check"></i><b>14.3</b> Pretty tables with flextable</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#uniting-columns"><i class="fa fa-check"></i><b>14.3.1</b> Uniting columns</a></li>
<li class="chapter" data-level="14.3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#pretty-tables"><i class="fa fa-check"></i><b>14.3.2</b> Pretty tables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="visualizations.html"><a href="visualizations.html"><i class="fa fa-check"></i><b>15</b> Visualizations</a>
<ul>
<li class="chapter" data-level="15.1" data-path="visualizations.html"><a href="visualizations.html#ggplot-basics"><i class="fa fa-check"></i><b>15.1</b> ggplot basics</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="visualizations.html"><a href="visualizations.html#building-plots-ups"><i class="fa fa-check"></i><b>15.1.1</b> Building plots ups</a></li>
<li class="chapter" data-level="15.1.2" data-path="visualizations.html"><a href="visualizations.html#basic-plotting"><i class="fa fa-check"></i><b>15.1.2</b> Basic plotting</a></li>
<li class="chapter" data-level="15.1.3" data-path="visualizations.html"><a href="visualizations.html#changing-plot-labels"><i class="fa fa-check"></i><b>15.1.3</b> Changing plot labels</a></li>
<li class="chapter" data-level="15.1.4" data-path="visualizations.html"><a href="visualizations.html#small-multiples"><i class="fa fa-check"></i><b>15.1.4</b> Small Multiples</a></li>
<li class="chapter" data-level="15.1.5" data-path="visualizations.html"><a href="visualizations.html#plotting-subsets-of-data"><i class="fa fa-check"></i><b>15.1.5</b> Plotting subsets of data</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="visualizations.html"><a href="visualizations.html#visualizations-for-env-chem"><i class="fa fa-check"></i><b>15.2</b> Visualizations for Env Chem</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="visualizations.html"><a href="visualizations.html#discrete-vs.-continuous-variables"><i class="fa fa-check"></i><b>15.2.1</b> Discrete vs. continuous variables</a></li>
<li class="chapter" data-level="15.2.2" data-path="visualizations.html"><a href="visualizations.html#prerequisites"><i class="fa fa-check"></i><b>15.2.2</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="visualizations.html"><a href="visualizations.html#bar-chart"><i class="fa fa-check"></i><b>15.3</b> Bar chart</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="visualizations.html"><a href="visualizations.html#adding-error-bars"><i class="fa fa-check"></i><b>15.3.1</b> Adding error bars</a></li>
<li class="chapter" data-level="15.3.2" data-path="visualizations.html"><a href="visualizations.html#ordering-bar-charts"><i class="fa fa-check"></i><b>15.3.2</b> Ordering bar charts</a></li>
<li class="chapter" data-level="15.3.3" data-path="visualizations.html"><a href="visualizations.html#grouping-bar-charts"><i class="fa fa-check"></i><b>15.3.3</b> Grouping bar charts</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="visualizations.html"><a href="visualizations.html#box-plots"><i class="fa fa-check"></i><b>15.4</b> Box Plots</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="visualizations.html"><a href="visualizations.html#box-plot-alternatives"><i class="fa fa-check"></i><b>15.4.1</b> Box plot alternatives</a></li>
<li class="chapter" data-level="15.4.2" data-path="visualizations.html"><a href="visualizations.html#statistical-comparisons-between-groups"><i class="fa fa-check"></i><b>15.4.2</b> Statistical comparisons between groups</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="visualizations.html"><a href="visualizations.html#histograms"><i class="fa fa-check"></i><b>15.5</b> Histograms</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="visualizations.html"><a href="visualizations.html#multiple-histograms"><i class="fa fa-check"></i><b>15.5.1</b> Multiple histograms</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="visualizations.html"><a href="visualizations.html#scatter-plots"><i class="fa fa-check"></i><b>15.6</b> Scatter plots</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="visualizations.html"><a href="visualizations.html#marginal-plots"><i class="fa fa-check"></i><b>15.6.1</b> Marginal plots</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="visualizations.html"><a href="visualizations.html#interactive-plots"><i class="fa fa-check"></i><b>15.7</b> Interactive Plots</a></li>
<li class="chapter" data-level="15.8" data-path="visualizations.html"><a href="visualizations.html#plotting-for-publication"><i class="fa fa-check"></i><b>15.8</b> Plotting for publication</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="visualizations.html"><a href="visualizations.html#plot-themes"><i class="fa fa-check"></i><b>15.8.1</b> Plot Themes</a></li>
<li class="chapter" data-level="15.8.2" data-path="visualizations.html"><a href="visualizations.html#legends"><i class="fa fa-check"></i><b>15.8.2</b> Legends</a></li>
<li class="chapter" data-level="15.8.3" data-path="visualizations.html"><a href="visualizations.html#modifying-labels"><i class="fa fa-check"></i><b>15.8.3</b> Modifying labels</a></li>
<li class="chapter" data-level="15.8.4" data-path="visualizations.html"><a href="visualizations.html#modifying-axis"><i class="fa fa-check"></i><b>15.8.4</b> Modifying Axis</a></li>
<li class="chapter" data-level="15.8.5" data-path="visualizations.html"><a href="visualizations.html#arranging-plots"><i class="fa fa-check"></i><b>15.8.5</b> Arranging plots</a></li>
<li class="chapter" data-level="15.8.6" data-path="visualizations.html"><a href="visualizations.html#anotating-plots"><i class="fa fa-check"></i><b>15.8.6</b> Anotating plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html"><i class="fa fa-check"></i><b>16</b> Modelling: Linear Regression</a>
<ul>
<li class="chapter" data-level="16.1" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#modelling-theory"><i class="fa fa-check"></i><b>16.1</b> Modelling Theory</a></li>
<li class="chapter" data-level="16.2" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#modelling-in-r"><i class="fa fa-check"></i><b>16.2</b> Modelling in R</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#base-r-linear-model"><i class="fa fa-check"></i><b>16.2.1</b> Base R Linear Model</a></li>
<li class="chapter" data-level="16.2.2" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#cleaning-up-model-ouputs"><i class="fa fa-check"></i><b>16.2.2</b> Cleaning up model ouputs</a></li>
<li class="chapter" data-level="16.2.3" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#glanced-outputs"><i class="fa fa-check"></i><b>16.2.3</b> Glanced outputs</a></li>
<li class="chapter" data-level="16.2.4" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#tidied-outputs"><i class="fa fa-check"></i><b>16.2.4</b> Tidied outputs</a></li>
<li class="chapter" data-level="16.2.5" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#augmented-outputs"><i class="fa fa-check"></i><b>16.2.5</b> Augmented outputs</a></li>
<li class="chapter" data-level="16.2.6" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#why-we-approach-modelling-this-way"><i class="fa fa-check"></i><b>16.2.6</b> Why we approach modelling this way</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#visualizing-models"><i class="fa fa-check"></i><b>16.3</b> Visualizing models</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#vizualizing-residuals"><i class="fa fa-check"></i><b>16.3.1</b> Vizualizing residuals</a></li>
<li class="chapter" data-level="16.3.2" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#plotting-residuals"><i class="fa fa-check"></i><b>16.3.2</b> Plotting residuals</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#calculating-concentrations"><i class="fa fa-check"></i><b>16.4</b> Calculating Concentrations</a></li>
<li class="chapter" data-level="16.5" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#summary-5"><i class="fa fa-check"></i><b>16.5</b> Summary</a></li>
<li class="chapter" data-level="16.6" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#further-reading-5"><i class="fa fa-check"></i><b>16.6</b> Further reading</a></li>
<li class="chapter" data-level="16.7" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#going-deeper-with-modelling"><i class="fa fa-check"></i><b>16.7</b> Going deeper with modelling</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="modelling-linear-regression.html"><a href="modelling-linear-regression.html#weighing"><i class="fa fa-check"></i><b>16.7.1</b> Weighing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html"><i class="fa fa-check"></i><b>17</b> Modelling: Non-Linear Regression</a>
<ul>
<li class="chapter" data-level="17.1" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#experimental-background"><i class="fa fa-check"></i><b>17.1</b> Experimental Background</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#annotating-maximal-values"><i class="fa fa-check"></i><b>17.1.1</b> Annotating maximal values</a></li>
<li class="chapter" data-level="17.1.2" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#extracting-maximal-values"><i class="fa fa-check"></i><b>17.1.2</b> Extracting maximal values</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#modelling-sigmoid-curve"><i class="fa fa-check"></i><b>17.2</b> Modelling Sigmoid Curve</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#calculating-logistic-regression"><i class="fa fa-check"></i><b>17.2.1</b> Calculating Logistic Regression</a></li>
<li class="chapter" data-level="17.2.2" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#extracting-model-parameters"><i class="fa fa-check"></i><b>17.2.2</b> Extracting model parameters</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="modelling-non-linear-regression.html"><a href="modelling-non-linear-regression.html#summary-6"><i class="fa fa-check"></i><b>17.3</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>Section 4: Notes for Env. Chem. Labs</b></span></li>
<li class="chapter" data-level="18" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html"><i class="fa fa-check"></i><b>18</b> CHM410: Air Quality Lab</a>
<ul>
<li class="chapter" data-level="18.1" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#importing-data"><i class="fa fa-check"></i><b>18.1</b> Importing Data</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#importing-airbeam-2-data"><i class="fa fa-check"></i><b>18.1.1</b> Importing Airbeam 2 data</a></li>
<li class="chapter" data-level="18.1.2" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#importing-co2-and-o3-data"><i class="fa fa-check"></i><b>18.1.2</b> Importing CO2 and O3 data</a></li>
<li class="chapter" data-level="18.1.3" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#merging-datasets"><i class="fa fa-check"></i><b>18.1.3</b> Merging datasets</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#plotting-data-spatially"><i class="fa fa-check"></i><b>18.2</b> Plotting data spatially</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#plotting-airbeam-data-spatially"><i class="fa fa-check"></i><b>18.2.1</b> Plotting Airbeam data spatially</a></li>
<li class="chapter" data-level="18.2.2" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#plotting-gases-data-spatially"><i class="fa fa-check"></i><b>18.2.2</b> Plotting gases data spatially</a></li>
<li class="chapter" data-level="18.2.3" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#combining-maps"><i class="fa fa-check"></i><b>18.2.3</b> Combining maps</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="chm410-air-quality-lab.html"><a href="chm410-air-quality-lab.html#summary-7"><i class="fa fa-check"></i><b>18.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="chm410-nmr-lab.html"><a href="chm410-nmr-lab.html"><i class="fa fa-check"></i><b>19</b> CHM410: NMR Lab</a>
<ul>
<li class="chapter" data-level="19.1" data-path="chm410-nmr-lab.html"><a href="chm410-nmr-lab.html#getting-started"><i class="fa fa-check"></i><b>19.1</b> Getting started</a></li>
<li class="chapter" data-level="19.2" data-path="chm410-nmr-lab.html"><a href="chm410-nmr-lab.html#setting-up-your-workspace"><i class="fa fa-check"></i><b>19.2</b> Setting up your workspace</a></li>
<li class="chapter" data-level="19.3" data-path="chm410-nmr-lab.html"><a href="chm410-nmr-lab.html#import-and-install-the-appropriate-packages"><i class="fa fa-check"></i><b>19.3</b> Import and install the appropriate packages</a></li>
<li class="chapter" data-level="19.4" data-path="chm410-nmr-lab.html"><a href="chm410-nmr-lab.html#exporting-your-nmr-for-r-and-chemospec"><i class="fa fa-check"></i><b>19.4</b> Exporting your NMR for R and ChemoSpec</a></li>
<li class="chapter" data-level="19.5" data-path="chm410-nmr-lab.html"><a href="chm410-nmr-lab.html#importing-your-data-in-chemospec"><i class="fa fa-check"></i><b>19.5</b> Importing your data in ChemoSpec</a></li>
<li class="chapter" data-level="19.6" data-path="chm410-nmr-lab.html"><a href="chm410-nmr-lab.html#preparing-the-data-for-statistical-analysis"><i class="fa fa-check"></i><b>19.6</b> Preparing the Data for Statistical Analysis</a></li>
<li class="chapter" data-level="19.7" data-path="chm410-nmr-lab.html"><a href="chm410-nmr-lab.html#lets-do-statistics"><i class="fa fa-check"></i><b>19.7</b> Let’s do statistics!</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Environmental Chemistry</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualizations" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">Chapter 15</span> Visualizations<a href="visualizations.html#visualizations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Visualizations have always been an important part of data science and chemistry. Good graphics illuminate trends and patterns you may have otherwise missed and allow us to quickly inspect thousands of values. R via the <code>ggplot2</code> package is one of, if not the premier, data visualization language available. This chapter will formally introduce the <code>ggplot2</code> package, explain a bit of the logic undergirding it’s operation, and give you some quick examples of how it works. Afterwards we’ll delve deeper into specific visualizations you’ll use and encounter in your studies culminating in preparing your plots for publication.</p>
<div id="ggplot-basics" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> ggplot basics<a href="visualizations.html#ggplot-basics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>ggplot2</code> is loaded by default with the <code>tidyverse</code> suite of packages. Let’s revisit our spectroscopy data we encountered in <a href="tidying-your-data.html#tidying-your-data">Tidying your data</a>:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="visualizations.html#cb220-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb220-2"><a href="visualizations.html#cb220-2" tabindex="-1"></a>atr_long <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/ATR_plastics.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb220-3"><a href="visualizations.html#cb220-3" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>wavenumber, </span>
<span id="cb220-4"><a href="visualizations.html#cb220-4" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;sample&quot;</span>,</span>
<span id="cb220-5"><a href="visualizations.html#cb220-5" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;absorbance&quot;</span>) </span></code></pre></div>
<pre><code>## Rows: 7157 Columns: 5
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (5): wavenumber, EPDM, Polystyrene, Polyethylene, Sample: Shopping bag
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="visualizations.html#cb222-1" tabindex="-1"></a><span class="co"># First 50 rows of data</span></span>
<span id="cb222-2"><a href="visualizations.html#cb222-2" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(atr_long[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ])</span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-872d859cc067bfc544f4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-872d859cc067bfc544f4">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50"],[550.0952,550.0952,550.0952,550.0952,550.5773,550.5773,550.5773,550.5773,551.0594,551.0594,551.0594,551.0594,551.5415,551.5415,551.5415,551.5415,552.0236,552.0236,552.0236,552.0236,552.5057,552.5057,552.5057,552.5057,552.9879,552.9879,552.9879,552.9879,553.47,553.47,553.47,553.47,553.9521,553.9521,553.9521,553.9521,554.4342,554.4342,554.4342,554.4342,554.9163,554.9163,554.9163,554.9163,555.3984,555.3984,555.3984,555.3984,555.8806,555.8806],["EPDM","Polystyrene","Polyethylene","Sample: Shopping bag","EPDM","Polystyrene","Polyethylene","Sample: Shopping bag","EPDM","Polystyrene","Polyethylene","Sample: Shopping bag","EPDM","Polystyrene","Polyethylene","Sample: Shopping bag","EPDM","Polystyrene","Polyethylene","Sample: Shopping bag","EPDM","Polystyrene","Polyethylene","Sample: Shopping bag","EPDM","Polystyrene","Polyethylene","Sample: Shopping bag","EPDM","Polystyrene","Polyethylene","Sample: Shopping bag","EPDM","Polystyrene","Polyethylene","Sample: Shopping bag","EPDM","Polystyrene","Polyethylene","Sample: Shopping bag","EPDM","Polystyrene","Polyethylene","Sample: Shopping bag","EPDM","Polystyrene","Polyethylene","Sample: Shopping bag","EPDM","Polystyrene"],[0.2119556,0.07463058,0.000873196,0.02364882,0.2124079,0.07455246,0.000834192,0.02382648,0.2128818,0.07450471,0.0008194469999999999,0.02387163,0.2133267,0.07449704,0.000825491,0.02391921,0.2137241,0.07452058,0.000868397,0.02396947,0.2140997,0.07455528,0.000949017,0.02402323,0.2145173,0.07458498,0.001008869,0.02408946,0.2150495,0.07458818,0.0010252,0.02413738,0.2156501,0.07456694,0.001053734,0.02419313,0.2163207,0.07452466000000001,0.001066902,0.02424033,0.2170318,0.07447084,0.001056188,0.02426789,0.2177349,0.07441481,0.001044501,0.02427777,0.2184014,0.07436047]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>wavenumber<\/th>\n      <th>sample<\/th>\n      <th>absorbance<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<div id="building-plots-ups" class="section level3 hasAnchor" number="15.1.1">
<h3><span class="header-section-number">15.1.1</span> Building plots ups<a href="visualizations.html#building-plots-ups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>gg</code> in <code>ggplot2</code> stands for the <em>grammar of graphics</em>,<span class="citation">(H. Wickham 2009)</span> and it’s a way to break down graphics (plots) into small pieces that can be discussed (hence grammar). We’ll take a look at this grammar via <code>geoms</code> (what kind of plot), <code>aes</code> (aesthetic choices), etc. For now, understand that this means we need to build up graphics/plots piece-by-piece and layer-by-layer. This extends beyond code to how we code. No sense in putting lipstick on a pig. Plot often, and discard the useless ones. Take the time to pretty up your plot <em>after</em> you’re satisfied with the underlying data.</p>
</div>
<div id="basic-plotting" class="section level3 hasAnchor" number="15.1.2">
<h3><span class="header-section-number">15.1.2</span> Basic plotting<a href="visualizations.html#basic-plotting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot2</code> uses <code>geoms</code> to specify what type of plot to create. Different plots are used to tell different stories and have different strengths and weakness. We’ll explore these more in <a href="visualizations.html#visualizations-for-env-chem">Visualizations for Env Chem</a>, but for now we’ll focus on <code>geom_point()</code>, which simply plots data as points on an [x,y] coordinate. In other words, a scatter plot.</p>
<p>Let’s plot our tided <code>atr_long</code> data:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="visualizations.html#cb223-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atr_long, </span>
<span id="cb223-2"><a href="visualizations.html#cb223-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> wavenumber, <span class="at">y =</span> absorbance)) <span class="sc">+</span></span>
<span id="cb223-3"><a href="visualizations.html#cb223-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
<p>Let’s ignore the plot for now and look at our code down:</p>
<ol style="list-style-type: decimal">
<li><code>ggplot()</code> initializes a <em>ggplot object</em>, basically an empty plot.</li>
<li>We then specified we want to plot data from our <code>atr_long</code> dataset (<code>data = atr_long</code>).</li>
<li>We then specified our <em>aesthetic mappings</em> via <code>aes()</code>. Here we’ll pass information for how we want the plot to look.</li>
<li>To our aesthetic mappings we’ve specified which values from <code>atr_long</code> are supposed to be our x-axis values (<code>x = wavenumber</code>) and y-axis values (<code>y = absorbance</code>).</li>
<li>We then add the <code>geom_point()</code> layer to create a scatter plot of [x,y] points .</li>
</ol>
<p>Now let’s look at our result. What we see is a point for every recorded absorbance measurements from our ATR analysis. We can clearly see the spectra of the different plastics in our data, however they’re all coloured the same. This is because we’ve only specified the x and y values. As far as <code>ggplot()</code> is concerned, these are the only values that matter, but we know different.</p>
<p>Fortunately you can pass multiple variables to different <code>aes()</code> options to enhance our plot. For instance, we can pass the <code>sample</code> variable, which specifies which sample a spectrum originates from, to the <code>colour</code> option:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="visualizations.html#cb224-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atr_long, </span>
<span id="cb224-2"><a href="visualizations.html#cb224-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> wavenumber, </span>
<span id="cb224-3"><a href="visualizations.html#cb224-3" tabindex="-1"></a>           <span class="at">y =</span> absorbance, </span>
<span id="cb224-4"><a href="visualizations.html#cb224-4" tabindex="-1"></a>           <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb224-5"><a href="visualizations.html#cb224-5" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
<p>Now we have a legend which clearly specifies which points are associated with each sample. But now the points are too large, potentially masking certain peaks. We can adjust the size of each point as follows:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="visualizations.html#cb225-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atr_long, </span>
<span id="cb225-2"><a href="visualizations.html#cb225-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> wavenumber, </span>
<span id="cb225-3"><a href="visualizations.html#cb225-3" tabindex="-1"></a>           <span class="at">y =</span> absorbance, </span>
<span id="cb225-4"><a href="visualizations.html#cb225-4" tabindex="-1"></a>           <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb225-5"><a href="visualizations.html#cb225-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-123-1.png" width="672" /></p>
<p>We specified <code>size = 0.5</code> in the <code>geom_point()</code> call because it’s a constant. We can map <code>size</code> to any continuous variable, such as the absorbance:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="visualizations.html#cb226-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atr_long, </span>
<span id="cb226-2"><a href="visualizations.html#cb226-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> wavenumber, </span>
<span id="cb226-3"><a href="visualizations.html#cb226-3" tabindex="-1"></a>           <span class="at">y =</span> absorbance, </span>
<span id="cb226-4"><a href="visualizations.html#cb226-4" tabindex="-1"></a>           <span class="at">colour =</span> sample,</span>
<span id="cb226-5"><a href="visualizations.html#cb226-5" tabindex="-1"></a>           <span class="at">size =</span> absorbance)) <span class="sc">+</span></span>
<span id="cb226-6"><a href="visualizations.html#cb226-6" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
<p>Sometimes this makes sense (i.e. a <em>bubble chart</em>) but for our example, having the size of the points increase as the absorbance increases doesn’t provide any new information (it actually clutters our plot).</p>
</div>
<div id="changing-plot-labels" class="section level3 hasAnchor" number="15.1.3">
<h3><span class="header-section-number">15.1.3</span> Changing plot labels<a href="visualizations.html#changing-plot-labels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>By default <code>ggplot</code> uses the header of the columns you passed for the <code>x</code> and <code>y</code> <code>aes()</code> options. Because headers are written for code they’re often poor label titles for plots. We can specify new labels and plot titles as follows:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="visualizations.html#cb227-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atr_long, </span>
<span id="cb227-2"><a href="visualizations.html#cb227-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> wavenumber, </span>
<span id="cb227-3"><a href="visualizations.html#cb227-3" tabindex="-1"></a>           <span class="at">y =</span> absorbance, </span>
<span id="cb227-4"><a href="visualizations.html#cb227-4" tabindex="-1"></a>           <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb227-5"><a href="visualizations.html#cb227-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb227-6"><a href="visualizations.html#cb227-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ATR Spetra&quot;</span>,</span>
<span id="cb227-7"><a href="visualizations.html#cb227-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Courtesy of CHM317 student data&quot;</span>,</span>
<span id="cb227-8"><a href="visualizations.html#cb227-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Wavenumber, cm^-1&quot;</span>,</span>
<span id="cb227-9"><a href="visualizations.html#cb227-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Absorbance (arbitrary units)&quot;</span>,</span>
<span id="cb227-10"><a href="visualizations.html#cb227-10" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;hi mom&quot;</span>,</span>
<span id="cb227-11"><a href="visualizations.html#cb227-11" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Plastic&quot;</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>
<p>Note how we changed the title of the legend with <code>colour = "Plastics"</code>. This is because the legend is generated from our colour aesthetic (<code>aes(..., colour = sample)</code>). If our legend was based off of the size aesthetic, we would use <code>size = "New Title"</code> to change the title for the size legend.</p>
</div>
<div id="small-multiples" class="section level3 hasAnchor" number="15.1.4">
<h3><span class="header-section-number">15.1.4</span> Small Multiples<a href="visualizations.html#small-multiples" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes your plots become overwhelming, a phenomena called overplotting, which prevent your from comparing graphs or charts. A popular solution is <a href="https://en.wikipedia.org/wiki/Small_multiple"><em>small multiples</em></a>, a series of smilar plots using the same scale and axes. This is readily accomplished in R using <a href="https://ggplot2-book.org/facet.html"><code>facet_grid()</code></a> (which creates a 2-D grid ) or <a href="https://ggplot2-book.org/facet.html"><code>facet_wrap()</code></a> (a single 1d ribbon wrapped into 2D space). You simply specy which variable you want to differentiate your plots, for us it’s <code>sample</code>:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="visualizations.html#cb228-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atr_long, </span>
<span id="cb228-2"><a href="visualizations.html#cb228-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> wavenumber, </span>
<span id="cb228-3"><a href="visualizations.html#cb228-3" tabindex="-1"></a>           <span class="at">y =</span> absorbance)) <span class="sc">+</span></span>
<span id="cb228-4"><a href="visualizations.html#cb228-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb228-5"><a href="visualizations.html#cb228-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sample)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
<p>Note the use of the tilde (<code>~</code>) in <code>facet_wrap(~sample)</code>; in this situation, it’s shorthand telling <code>facet_wrap()</code> to make small multiples off of the sample variable.</p>
</div>
<div id="plotting-subsets-of-data" class="section level3 hasAnchor" number="15.1.5">
<h3><span class="header-section-number">15.1.5</span> Plotting subsets of data<a href="visualizations.html#plotting-subsets-of-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often you won’t want to plot everything in your dataset. Rather, you’ll want to plot a specific chemical, city, location, etc. To that end you want to plot a <em>subset</em> of your data. There are a couple of ways to handle this.</p>
<p>You can subset your data on the fly using <code>subset()</code>. This way allows you to specify based off of <a href="transform-data-manipulation.html#logical-operators">Logical operators</a> as such:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="visualizations.html#cb229-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(atr_long, sample <span class="sc">==</span> <span class="st">&quot;EPDM&quot;</span>),</span>
<span id="cb229-2"><a href="visualizations.html#cb229-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> wavenumber, </span>
<span id="cb229-3"><a href="visualizations.html#cb229-3" tabindex="-1"></a>           <span class="at">y =</span> absorbance)) <span class="sc">+</span></span>
<span id="cb229-4"><a href="visualizations.html#cb229-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
<p>or</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="visualizations.html#cb230-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(atr_long, wavenumber <span class="sc">&gt;=</span><span class="dv">2500</span>),</span>
<span id="cb230-2"><a href="visualizations.html#cb230-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> wavenumber, </span>
<span id="cb230-3"><a href="visualizations.html#cb230-3" tabindex="-1"></a>           <span class="at">y =</span> absorbance)) <span class="sc">+</span></span>
<span id="cb230-4"><a href="visualizations.html#cb230-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
<p>Another approach is to use <code>filter()</code> and pipe to <code>ggplot()</code>:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="visualizations.html#cb231-1" tabindex="-1"></a>atr_long <span class="sc">%&gt;%</span></span>
<span id="cb231-2"><a href="visualizations.html#cb231-2" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">!=</span> <span class="st">&quot;EPDM&quot;</span> <span class="sc">&amp;</span> wavenumber <span class="sc">&lt;=</span> <span class="dv">2500</span> <span class="sc">|</span>sample <span class="sc">==</span> <span class="st">&quot;EPDM&quot;</span> <span class="sc">&amp;</span> wavenumber <span class="sc">&gt;=</span> <span class="dv">3500</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb231-3"><a href="visualizations.html#cb231-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x =</span> wavenumber, <span class="at">y =</span> absorbance, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb231-4"><a href="visualizations.html#cb231-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
<p>There are pros and cons to either approach. <code>subset()</code> on the fly is best for simple task, like plotting a single city, whereas the piping approach is best for more complex sorting.</p>
</div>
</div>
<div id="visualizations-for-env-chem" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> Visualizations for Env Chem<a href="visualizations.html#visualizations-for-env-chem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ve already encountered and produced several types of plots to visualize our data. We’ve also gone over the theory and basic operations of <code>ggplot()</code> in the <a href="visualizations.html#ggplot-basics">ggplot basics</a> section. Now, we’ll expand on these and explicitly walk through the most common data visualization methods you’ll encounter in the field of environmental chemistry. Additionally, we’ll learn how to get your plots ready for publication.</p>
<p>The plots we’ll be covering include:</p>
<ul>
<li>[Bar Plots]</li>
<li><a href="visualizations.html#box-plots">Box Plots</a></li>
<li><a href="visualizations.html#histograms">Histograms</a></li>
<li><a href="visualizations.html#scatter-plots">Scatter Plots</a></li>
<li><a href="visualizations.html#interactive-plots">Interactive Plots</a></li>
<li><a href="visualizations.html#plotting-for-publication">Plotting for publication</a></li>
</ul>
<p>These are only a smattering of the possible data visualizations you can perform in R. We’re focusing on them because of their ubiquity in our field, but they often won’t be the ideal visualizations you need to communicate <em>your story</em>. We highly recommend you check out the following resources. Not only are they a great source of inspiration, they provide example code to get you up and running. We consult them regularly.</p>
<ul>
<li><a href="https://www.data-to-viz.com/"><strong>Data to viz</strong></a> which features a decision tree to help you decide on what plot would serve you best.</li>
<li><a href="https://exts.ggplot2.tidyverse.org/gallery/"><strong>ggplot2 extensions gallery</strong></a> which is the best repository to the plethora of <code>ggplot2()</code> extensions. If you need a specialized plot, check here. Odds are someone has a solution to your problem. Some great extensions include <a href="https://github.com/slowkow/ggrepel"><code>ggrepel</code></a> for easy labelling of points; <a href="https://docs.r4photobiology.info/ggpmisc/"><code>ggpmisc</code></a> for statistical annotations; and <a href="https://rpkgs.datanovia.com/ggpubr/"><code>ggpubr</code></a> for publication ready plots, group wise comparisons, and annotation of statistical significance.</li>
<li><a href="https://www.r-graph-gallery.com/index.html"><strong>The R Graph Gallery</strong></a> contains hundreds of charts made with R. While it’s not as easy to navigate as <em>Data to viz</em>, it does contain many more examples; it is definitely worth exploring.</li>
</ul>
<div id="discrete-vs.-continuous-variables" class="section level3 hasAnchor" number="15.2.1">
<h3><span class="header-section-number">15.2.1</span> Discrete vs. continuous variables<a href="visualizations.html#discrete-vs.-continuous-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The type of plots available to you, and how they display, are dependent on the type of data. Namely, whether your data is <em>discrete</em> (i.e .can only take particular values) or <em>continuous</em> (is not restricted to defined separate values, but can occupy any value over a continuous range). So a variable consisting of cities would be discrete, whereas a variable like concentration of a chemical would be continuous. You can treat numeric data as categorical if you so chose. Understanding the difference between discrete and continuous data will shape how you plot your data.</p>
</div>
<div id="prerequisites" class="section level3 hasAnchor" number="15.2.2">
<h3><span class="header-section-number">15.2.2</span> Prerequisites<a href="visualizations.html#prerequisites" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Additionally, for this section we’ll mostly be using the <code>atlNO2</code> and <code>sumAtl</code> datasets we created in the <a href="summarizing-data.html#summarizing-data">Summarizing data</a> chapter. Please revisit that chapter for details on that dataset.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="visualizations.html#cb232-1" tabindex="-1"></a>atlNO2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/2018hourlyNO2_Atl.csv&quot;</span>, <span class="at">skip =</span> <span class="dv">7</span>, <span class="at">na =</span><span class="fu">c</span>(<span class="st">&quot;-999&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb232-2"><a href="visualizations.html#cb232-2" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span><span class="fu">tolower</span>(<span class="fu">gsub</span>(<span class="st">&quot;/.*&quot;</span>, <span class="st">&quot;&quot;</span>, .x))) <span class="sc">%&gt;%</span></span>
<span id="cb232-3"><a href="visualizations.html#cb232-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;h&quot;</span>), </span>
<span id="cb232-4"><a href="visualizations.html#cb232-4" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;h&quot;</span>, </span>
<span id="cb232-5"><a href="visualizations.html#cb232-5" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;hour&quot;</span>, </span>
<span id="cb232-6"><a href="visualizations.html#cb232-6" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">hour =</span> as.numeric),</span>
<span id="cb232-7"><a href="visualizations.html#cb232-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;conc&quot;</span>, </span>
<span id="cb232-8"><a href="visualizations.html#cb232-8" tabindex="-1"></a>               <span class="at">values_transform =</span> <span class="fu">list</span>(<span class="at">conc =</span> as.numeric),</span>
<span id="cb232-9"><a href="visualizations.html#cb232-9" tabindex="-1"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<pre><code>## Rows: 8395 Columns: 31
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (3): Pollutant//Polluant, City//Ville, P/T//P/T
## dbl (28): NAPS ID//Identifiant SNPA, Latitude//Latitude, Longitude//Longitud...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="visualizations.html#cb234-1" tabindex="-1"></a>sumAtl <span class="ot">&lt;-</span> atlNO2 <span class="sc">%&gt;%</span></span>
<span id="cb234-2"><a href="visualizations.html#cb234-2" tabindex="-1"></a>  <span class="fu">group_by</span>(p, city) <span class="sc">%&gt;%</span></span>
<span id="cb234-3"><a href="visualizations.html#cb234-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(conc), </span>
<span id="cb234-4"><a href="visualizations.html#cb234-4" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(conc), </span>
<span id="cb234-5"><a href="visualizations.html#cb234-5" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(conc), </span>
<span id="cb234-6"><a href="visualizations.html#cb234-6" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(conc), </span>
<span id="cb234-7"><a href="visualizations.html#cb234-7" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(conc))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;p&#39;. You can override using the `.groups`
## argument.</code></pre>
</div>
</div>
<div id="bar-chart" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> Bar chart<a href="visualizations.html#bar-chart" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bar charts, also called <em>column</em> charts, represent <em>categorical</em> data with rectangular bars whose height/length is proportional to the values they represent.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="visualizations.html#cb236-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sumAtl,</span>
<span id="cb236-2"><a href="visualizations.html#cb236-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> city, </span>
<span id="cb236-3"><a href="visualizations.html#cb236-3" tabindex="-1"></a>           <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb236-4"><a href="visualizations.html#cb236-4" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb236-5"><a href="visualizations.html#cb236-5" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="co"># rotates plot 90 degrees</span></span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
<p>Pretty boring, but it’s gotten the job done. <strong>Note</strong> that we used <code>coord_flip()</code> to rotate our plot 90<span class="math inline">\(^\circ\)</span> therefore the supplied <code>x</code> option of <code>city</code> is now plotted on the <code>y-axis</code>. This makes reading long categorical names (i.e. the names of cities) easier. <code>coord_flip()</code> doesn’t change anything else except the final orientation of the plot.</p>
<p>Also note that <code>ggplot()</code> includes <code>geom_col()</code> and <code>geom_bar()</code>. While both can be used to make bar charts. <code>geom_col()</code> is used when you want to represent values in the data (i.e. the precalculated mean as shown above), whereas <code>geom_bar()</code> makes the height of the bar proportional to the number of cases in each group.</p>
<div id="adding-error-bars" class="section level3 hasAnchor" number="15.3.1">
<h3><span class="header-section-number">15.3.1</span> Adding error bars<a href="visualizations.html#adding-error-bars" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Any measurement always has an associated uncertainty/variability. These values are expressed visually via <em>error bars</em> demarcating the minimum and maximum variability and give a general idea of how precise a measurement is. In our <code>sumAtl</code> dataset we’ve calculated the standard deviation as a measure of uncertainty. In our example, we’ve used the standard deviation (<code>sd</code>) as a measure of uncertainty of our calculated annual means.</p>
<p>To plot error bars we use <code>geom_errorbar()</code> and pass the min and max values we want the error bars to be. In our case, the lowest value would be <code>ymin = mean - sd</code>, and the highest would be <code>ymin = mean + sd</code>. Our plotted error bars now indicated plus or minus one standard deviation from the mean.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="visualizations.html#cb237-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sumAtl, <span class="fu">aes</span>(<span class="at">x =</span> city, <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb237-2"><a href="visualizations.html#cb237-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb237-3"><a href="visualizations.html#cb237-3" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> sd, </span>
<span id="cb237-4"><a href="visualizations.html#cb237-4" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> sd)) <span class="sc">+</span></span>
<span id="cb237-5"><a href="visualizations.html#cb237-5" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-132-1.png" width="672" /></p>
<p>Some of the error bars indicate we could get a <em>negative</em> concentration of NO<sub>2</sub>. This is physically impossible, but it does suggest we should evaluate the distribution of our data (see below). Note that since we’re calculating error bar ranges on the fly, we’ve had to specify new aesthetic arguments to <code>geom_errorbar()</code>.</p>
</div>
<div id="ordering-bar-charts" class="section level3 hasAnchor" number="15.3.2">
<h3><span class="header-section-number">15.3.2</span> Ordering bar charts<a href="visualizations.html#ordering-bar-charts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often with bar charts (and similar plots), it’s useful to <em>order</em> the bars to help tell a story or convey information. We can effectuate this using <code>fct_reorder()</code>:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="visualizations.html#cb238-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sumAtl, </span>
<span id="cb238-2"><a href="visualizations.html#cb238-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(city, mean),</span>
<span id="cb238-3"><a href="visualizations.html#cb238-3" tabindex="-1"></a>           <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb238-4"><a href="visualizations.html#cb238-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-5"><a href="visualizations.html#cb238-5" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> sd, </span>
<span id="cb238-6"><a href="visualizations.html#cb238-6" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> sd)) <span class="sc">+</span></span>
<span id="cb238-7"><a href="visualizations.html#cb238-7" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
<p>So in our aesthetics call for <code>geom_bar</code> we specified the <code>x</code> variable should be <code>city</code>, but ordered based on their corresponding <code>mean</code> value. Doing this has helped shed some light on trends in NO<sub>2</sub> levels. For one, despite Labrador City having lower mean [NO<sub>2</sub>], we can now easily see that it has a larger variation in [NO<sub>2</sub>] then Corner Brook.</p>
</div>
<div id="grouping-bar-charts" class="section level3 hasAnchor" number="15.3.3">
<h3><span class="header-section-number">15.3.3</span> Grouping bar charts<a href="visualizations.html#grouping-bar-charts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes you’ll want to group bar charts as in the concentration of several chemicals in different locations. We can easily group bar charts in ggplot. Let’s go ahead and group our mean annual [NO<sub>2</sub>] by province by simply (1) reordering based on province, and (2) colour bars based on province:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="visualizations.html#cb239-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sumAtl, </span>
<span id="cb239-2"><a href="visualizations.html#cb239-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(city, p),</span>
<span id="cb239-3"><a href="visualizations.html#cb239-3" tabindex="-1"></a>           <span class="at">y =</span> mean, </span>
<span id="cb239-4"><a href="visualizations.html#cb239-4" tabindex="-1"></a>           <span class="at">fill =</span> p)) <span class="sc">+</span></span>
<span id="cb239-5"><a href="visualizations.html#cb239-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb239-6"><a href="visualizations.html#cb239-6" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> sd, </span>
<span id="cb239-7"><a href="visualizations.html#cb239-7" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> sd)) <span class="sc">+</span></span>
<span id="cb239-8"><a href="visualizations.html#cb239-8" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<p>There are other ways to group your bar charts depending on the story you want to tell and the data you have. Please consult the <a href="https://www.r-graph-gallery.com/48-grouped-barplot-with-ggplot2.html">Grouped, stacked and percent stacked barplot in ggplot2</a> page from the <em>R-graph-gallery</em>.</p>
</div>
</div>
<div id="box-plots" class="section level2 hasAnchor" number="15.4">
<h2><span class="header-section-number">15.4</span> Box Plots<a href="visualizations.html#box-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Box plots give a summary of the <em>distribution</em> of a numeric variable through their <em>quartiles</em>. You’ve no doubt seen them before, but they’re often misinterpreted. Let’s create a box-plot using <code>geom_boxplot()</code> and our Atlantic hourly NO<sub>2</sub> measurements, then we’ll break down how to interpret it.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="visualizations.html#cb240-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atlNO2, </span>
<span id="cb240-2"><a href="visualizations.html#cb240-2" tabindex="-1"></a>       <span class="fu">aes</span>( <span class="at">x =</span> city, <span class="at">y =</span> conc)) <span class="sc">+</span></span>
<span id="cb240-3"><a href="visualizations.html#cb240-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb240-4"><a href="visualizations.html#cb240-4" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
<p>Let’s break down how to interpret <em>one</em> box before tackling the entire set. As previously mentioned, box plots describe data in their <em>quartiles</em>. Quartiles basically arrange the data from the lowest to highest value and split the data at <em>three points</em>:</p>
<ul>
<li><em>The first quartile</em> (Q1) is halfway between the lowest value and the median (50%) of the data. In other words 25% of the data lies <em>below</em> Q1.</li>
<li><em>The second quartile</em> (Q2) is the median. 50% of the data lies below, and 50% lies above this point.</li>
<li><em>The third quartile</em> (Q3) is halfway between the median and the <em>highest</em> value in the data. In other words, 75% of the data lies <em>below</em> Q3.</li>
</ul>
<p>The <em>box</em> in box-plots represents the range between Q1 and Q3. This is known as the <em>inter-quartile range</em> (IQR) and 50% of the total data falls somewhere inside this box. You can estimate the distribution by the symmetry of the box. if Q1 to the median is smaller than the median to Q3, the data has a <em>positive skew</em> (right sided skew), and vice versa.</p>
<p>Rounding it out, <code>geom_boxplot()</code> includes <em>whiskers</em>, the thin lines emanating out from the box. This is used the predict outliers and is calculated as <span class="math inline">\(outliers = \pm 1.5 \times IQR\)</span>. Anything outside the whiskers is considered an “outliers” or an extreme point, and is plotted individually.</p>
<p>Putting this all together, let’s look at the [NO<sub>2</sub>] for St. Johns city:</p>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
<p>Note that we’ve plotted the actual distribution of the data. Prior to computers, this was incredibly difficult to do, hence the use of box plots which can be drawn knowing only five points. However, the simplicity in calculating box-plots means they can hide trends and observations of your data. On top of that, they aren’t very intuitive (see the score of text you just read to understand them). Consequently, we strongly recommend you explore some of the <a href="visualizations.html#box-plot-alternatives">Box plot alternatives</a> unless you explicitly need to create box-plots.</p>
<div id="box-plot-alternatives" class="section level3 hasAnchor" number="15.4.1">
<h3><span class="header-section-number">15.4.1</span> Box plot alternatives<a href="visualizations.html#box-plot-alternatives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first alternative to box-plots is the <em>violin plot</em> which is made using <code>geom_violin()</code>. It is similar to the box-plot, but instead of displaying the quartiles, it plots the density within each group and is a bit more intuitive then box-plots. While the example below isn’t the most convincing given the scale of the dataset, violin plots are useful for identifying underlying trends in the distribution of data. For example, in the plot below we can see that some towns such as Marystown principle has days where [NO<sub>2</sub>] = 0 ppb, whereas Grand Falls-Windsor has a large number of days with low, but measurable levels of NO<sub>2</sub>. This might be because of difference in regional ambient levels of NO<sub>2</sub>.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="visualizations.html#cb241-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atlNO2, </span>
<span id="cb241-2"><a href="visualizations.html#cb241-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> city, <span class="at">y =</span> conc, <span class="at">fill =</span> p)) <span class="sc">+</span> </span>
<span id="cb241-3"><a href="visualizations.html#cb241-3" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb241-4"><a href="visualizations.html#cb241-4" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/atl-violin-1.png" width="672" /></p>
<p>Another alternative is to plot the points over top of the box-plot. You’ve encountered this example in <a href="r-coding-basics.html#r-coding-basics">R coding basics</a>. Truth be told, there are countless way to visualize distribution.</p>
</div>
<div id="statistical-comparisons-between-groups" class="section level3 hasAnchor" number="15.4.2">
<h3><span class="header-section-number">15.4.2</span> Statistical comparisons between groups<a href="visualizations.html#statistical-comparisons-between-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often box-plots are used to show differences in distributions between two groups (i.e. population in Location A vs. Location B). How you determine this statistically is a different story, but packages such as <code>ggpubr</code> have many built in functionalists to display the results of these outcomes.</p>
<p>From our NO<sub>2</sub> data, St. Johns appears to have the highest levels of NO<sub>2</sub>. Let’s apply a pairwise test against other Newfoundland communities to see if our observation is <em>statistically significant</em> based upon the results of a <em>Wilcoxon test</em>.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="visualizations.html#cb242-1" tabindex="-1"></a>nfld <span class="ot">&lt;-</span> atlNO2 <span class="sc">%&gt;%</span></span>
<span id="cb242-2"><a href="visualizations.html#cb242-2" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">==</span> <span class="st">&quot;NL&quot;</span>) <span class="co"># only nfld stations</span></span>
<span id="cb242-3"><a href="visualizations.html#cb242-3" tabindex="-1"></a></span>
<span id="cb242-4"><a href="visualizations.html#cb242-4" tabindex="-1"></a><span class="co"># Code from ggpubr website</span></span>
<span id="cb242-5"><a href="visualizations.html#cb242-5" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggviolin</span>(nfld, <span class="at">x =</span> <span class="st">&quot;city&quot;</span>, <span class="at">y =</span> <span class="st">&quot;conc&quot;</span>) <span class="sc">+</span></span>
<span id="cb242-6"><a href="visualizations.html#cb242-6" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">stat_compare_means</span>(<span class="at">ref.group =</span> <span class="st">&quot;St Johns&quot;</span>,</span>
<span id="cb242-7"><a href="visualizations.html#cb242-7" tabindex="-1"></a>                             <span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>,</span>
<span id="cb242-8"><a href="visualizations.html#cb242-8" tabindex="-1"></a>                             <span class="at">label =</span> <span class="st">&quot;p.signif&quot;</span>) </span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
<p>Based on the results of our test, all other stations in Newfoundland have statistically significant differences in the median NO2 values. Note the validity of this statistical approach to this particular problem is called into question based on the distribution of the data etc. We’ve included it to demonstrate how to label significance on plots, rather than an explicit discussion on statistics.</p>
<p>For more information on <code>ggpubr</code>, adding p-values and significance labels, and different pairwise statistical test please visit <a href="http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/">ggpubr: Publication Ready Plots</a>.</p>
</div>
</div>
<div id="histograms" class="section level2 hasAnchor" number="15.5">
<h2><span class="header-section-number">15.5</span> Histograms<a href="visualizations.html#histograms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Histograms are an approximate representation of the distributions of numerical data. They’re an approximation because you arbitrarily “bin” your data into groups and then count the number of values inside that bin. The frequency, or count, in each bin is represented by the height of a rectangle whose width equals that of the bin. <code>geom_histogram()</code> is used to create histograms:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="visualizations.html#cb243-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(atlNO2, <span class="at">city =</span> <span class="st">&quot;St Johns&quot;</span>), </span>
<span id="cb243-2"><a href="visualizations.html#cb243-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc)) <span class="sc">+</span></span>
<span id="cb243-3"><a href="visualizations.html#cb243-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb243-4"><a href="visualizations.html#cb243-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Distribution of St. Johns&#39; NO2 levels in 2018&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: In subset.data.frame(atlNO2, city = &quot;St Johns&quot;) :
##  extra argument &#39;city&#39; will be disregarded</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
<p>We can alter the resolution of our histogram by modifying the width of the bins using the <code>binwidth</code> argument or by specifying the number of bins with the <code>bins</code> argument. The former is useful when you don’t know the range of your data, whereas the latter is useful is you do (i.e. numbers between 0 and 100).</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="visualizations.html#cb246-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(atlNO2, <span class="at">city =</span> <span class="st">&quot;St Johns&quot;</span>), </span>
<span id="cb246-2"><a href="visualizations.html#cb246-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc)) <span class="sc">+</span></span>
<span id="cb246-3"><a href="visualizations.html#cb246-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb246-4"><a href="visualizations.html#cb246-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Distribution of St. Johns&#39; NO2 levels in 2018, binwidth = 1&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: In subset.data.frame(atlNO2, city = &quot;St Johns&quot;) :
##  extra argument &#39;city&#39; will be disregarded</code></pre>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<div id="multiple-histograms" class="section level3 hasAnchor" number="15.5.1">
<h3><span class="header-section-number">15.5.1</span> Multiple histograms<a href="visualizations.html#multiple-histograms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While you can overlap histograms, it get’s difficult to read with more than a handful of datasets. If we wanted to plot histograms of all the cities in our dataset we would have to use a small multiple via the <code>facet_grid()</code> or <code>facet_wrap()</code> arguments. <code>facet_grid()</code> allows you to arrange many small plots on a grid defined by variables in your dataset (i.e. columns for provinces, and rows for different pollutants). In the example below we’ve used <code>facet_wrap(~city)</code> which creates a 2D layout of histograms of each cities NO<sub>2</sub> values. Note the tilde , <code>~</code>, preceding in <code>~city</code>.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="visualizations.html#cb248-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> atlNO2, </span>
<span id="cb248-2"><a href="visualizations.html#cb248-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> conc, <span class="at">fill =</span> p)) <span class="sc">+</span> </span>
<span id="cb248-3"><a href="visualizations.html#cb248-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb248-4"><a href="visualizations.html#cb248-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>city)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
</div>
</div>
<div id="scatter-plots" class="section level2 hasAnchor" number="15.6">
<h2><span class="header-section-number">15.6</span> Scatter plots<a href="visualizations.html#scatter-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Scatter plots display values of two variables, one of which is a <em>continuous</em> variable. Each data point ins plotted as an individual point on.You’ve already made scatter plots in the form of a time series during the Section 1 tutorial exercise. We’ve already touched upon scatter plots during the [Linear Regression] chapter where we also overlaid our linear model over our concentration points. So now we’ll touch upon some things you can do to improve your scatter plots.</p>
<div id="marginal-plots" class="section level3 hasAnchor" number="15.6.1">
<h3><span class="header-section-number">15.6.1</span> Marginal plots<a href="visualizations.html#marginal-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can easily combine a scatter plot with marginal plot. This is useful to summarize one dimension of our scatter plot. For example, let’s revisit the time series plot we made in <a href="r-coding-basics.html#r-coding-basics">R coding basics</a>. We might want to know the distribution of concentrations of the individual pollutants. using the <code>ggExtra</code> package and the <code>ggMarginal()</code> function we can get the following:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="visualizations.html#cb249-1" tabindex="-1"></a>torontoAir <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/2018-01-01_60430_Toronto_ON.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 507 Columns: 8
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (3): city, p, pollutant
## dbl  (4): naps, latitude, longitude, concentration
## dttm (1): date.time
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="visualizations.html#cb251-1" tabindex="-1"></a><span class="co"># note we&#39;re storing our plot in the variable &#39;torPlot&#39;</span></span>
<span id="cb251-2"><a href="visualizations.html#cb251-2" tabindex="-1"></a><span class="co"># and we&#39;re not plotting SO2</span></span>
<span id="cb251-3"><a href="visualizations.html#cb251-3" tabindex="-1"></a>torPlot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(torontoAir, pollutant <span class="sc">!=</span> <span class="st">&quot;SO2&quot;</span>), </span>
<span id="cb251-4"><a href="visualizations.html#cb251-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> date.time,</span>
<span id="cb251-5"><a href="visualizations.html#cb251-5" tabindex="-1"></a>           <span class="at">y =</span> concentration,</span>
<span id="cb251-6"><a href="visualizations.html#cb251-6" tabindex="-1"></a>           <span class="at">colour =</span> pollutant)) <span class="sc">+</span></span>
<span id="cb251-7"><a href="visualizations.html#cb251-7" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb251-8"><a href="visualizations.html#cb251-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb251-9"><a href="visualizations.html#cb251-9" tabindex="-1"></a></span>
<span id="cb251-10"><a href="visualizations.html#cb251-10" tabindex="-1"></a><span class="co"># We&#39;re passing our torPlot to the ggMarginal Function</span></span>
<span id="cb251-11"><a href="visualizations.html#cb251-11" tabindex="-1"></a>ggExtra<span class="sc">::</span><span class="fu">ggMarginal</span>(torPlot, <span class="at">margins =</span> <span class="st">&quot;y&quot;</span>, <span class="at">groupColour =</span> <span class="cn">TRUE</span>, <span class="at">groupFill =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<p>We can now see the distributions of NO<sub>2</sub> and O<sub>3</sub> overlaid on the vertical axis. note that <code>ggMarginal()</code> only works with scatter plots.</p>
<p>There are plenty of other marginal options scatted about various packages. You can see many of them in action (with beautiful examples) at <a href="http://motioninsocial.com/tufte/#minimal-line-plot">Tufte in R</a> by Lukasz Piwek.</p>
</div>
</div>
<div id="interactive-plots" class="section level2 hasAnchor" number="15.7">
<h2><span class="header-section-number">15.7</span> Interactive Plots<a href="visualizations.html#interactive-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ultimately you’re visualizations will be printed to a static PDF document, but in the interim having an interactive plot can be helpful for data exploration. The <code>plotly</code> package magically makes most <code>ggplots</code> interactive with a simply command. Here’s an example with our Toronto air quality data:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="visualizations.html#cb252-1" tabindex="-1"></a>torPlot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> torontoAir,</span>
<span id="cb252-2"><a href="visualizations.html#cb252-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> date.time,</span>
<span id="cb252-3"><a href="visualizations.html#cb252-3" tabindex="-1"></a>           <span class="at">y =</span> concentration,</span>
<span id="cb252-4"><a href="visualizations.html#cb252-4" tabindex="-1"></a>           <span class="at">colour =</span> pollutant)) <span class="sc">+</span></span>
<span id="cb252-5"><a href="visualizations.html#cb252-5" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb252-6"><a href="visualizations.html#cb252-6" tabindex="-1"></a></span>
<span id="cb252-7"><a href="visualizations.html#cb252-7" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(torPlot2)</span></code></pre></div>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-800d9bad1ee49356a638" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-800d9bad1ee49356a638">{"x":{"data":[{"x":[1514764800,1514768400,1514772000,1514775600,1514779200,1514782800,1514786400,1514790000,1514793600,1514797200,1514800800,1514804400,1514808000,1514811600,1514815200,1514818800,1514822400,1514826000,1514829600,1514833200,1514836800,1514840400,1514844000,1514847600,1514851200,1514854800,1514858400,1514862000,1514865600,1514869200,1514872800,1514876400,1514880000,1514883600,1514887200,1514890800,1514894400,1514898000,1514901600,1514905200,1514908800,1514912400,1514916000,1514919600,1514923200,1514926800,1514930400,1514934000,1514937600,1514941200,1514944800,1514948400,1514952000,1514955600,1514959200,1514962800,1514966400,1514970000,1514973600,1514977200,1514980800,1514984400,1514988000,1514991600,1514995200,1514998800,1515002400,1515006000,1515009600,1515013200,1515016800,1515020400,1515024000,1515027600,1515031200,1515034800,1515038400,1515042000,1515045600,1515049200,1515052800,1515056400,1515060000,1515063600,1515067200,1515070800,1515074400,1515078000,1515081600,1515085200,1515088800,1515092400,1515096000,1515099600,1515103200,1515106800,1515110400,1515114000,1515117600,1515121200,1515124800,1515128400,1515132000,1515135600,1515139200,1515142800,1515146400,1515150000,1515153600,1515157200,1515160800,1515164400,1515168000,1515171600,1515175200,1515178800,1515182400,1515186000,1515189600,1515193200,1515196800,1515200400,1515204000,1515207600,1515211200,1515214800,1515218400,1515222000,1515225600,1515229200,1515232800,1515236400,1515240000,1515243600,1515247200,1515250800,1515254400,1515258000,1515261600,1515265200,1515268800,1515272400,1515276000,1515279600,1515283200,1515286800,1515290400,1515294000,1515297600,1515301200,1515304800,1515308400,1515312000,1515315600,1515319200,1515322800,1515326400,1515330000,1515333600,1515337200,1515340800,1515344400,1515348000,1515351600,1515355200,1515358800,1515362400,1515366000,1515369600],"y":[39,47,46,46,46,46,50,55,45,20,13,8,7,7,8,7,8,8,8,12,17,22,26,34,42,37,20,20,23,20,21,23,21,22,26,19,16,18,18,18,20,24,27,31,26,25,26,23,21,16,18,19,20,24,24,35,31,17,14,10,9,11,10,15,18,21,24,21,23,26,32,32,28,30,31,35,38,26,27,33,26,19,12,12,10,11,10,10,11,13,13,9,8,10,9,10,7,9,7,11,15,18,23,27,17,19,13,11,13,14,16,13,13,17,17,14,20,22,16,14,9,14,19,21,15,18,16,22,20,16,11,11,8,8,8,10,16,23,26,25,20,28,32,49,50,50,50,46,45,43,31,21,12,12,9,7,7,7,8,9,10,11,10,11,12,15,18,18,15],"text":["date.time: 2018-01-01 00:00:00<br />concentration: 39<br />pollutant: NO2","date.time: 2018-01-01 01:00:00<br />concentration: 47<br />pollutant: NO2","date.time: 2018-01-01 02:00:00<br />concentration: 46<br />pollutant: NO2","date.time: 2018-01-01 03:00:00<br />concentration: 46<br />pollutant: NO2","date.time: 2018-01-01 04:00:00<br />concentration: 46<br />pollutant: NO2","date.time: 2018-01-01 05:00:00<br />concentration: 46<br />pollutant: NO2","date.time: 2018-01-01 06:00:00<br />concentration: 50<br />pollutant: NO2","date.time: 2018-01-01 07:00:00<br />concentration: 55<br />pollutant: NO2","date.time: 2018-01-01 08:00:00<br />concentration: 45<br />pollutant: NO2","date.time: 2018-01-01 09:00:00<br />concentration: 20<br />pollutant: NO2","date.time: 2018-01-01 10:00:00<br />concentration: 13<br />pollutant: NO2","date.time: 2018-01-01 11:00:00<br />concentration:  8<br />pollutant: NO2","date.time: 2018-01-01 12:00:00<br />concentration:  7<br />pollutant: NO2","date.time: 2018-01-01 13:00:00<br />concentration:  7<br />pollutant: NO2","date.time: 2018-01-01 14:00:00<br />concentration:  8<br />pollutant: NO2","date.time: 2018-01-01 15:00:00<br />concentration:  7<br />pollutant: NO2","date.time: 2018-01-01 16:00:00<br />concentration:  8<br />pollutant: NO2","date.time: 2018-01-01 17:00:00<br />concentration:  8<br />pollutant: NO2","date.time: 2018-01-01 18:00:00<br />concentration:  8<br />pollutant: NO2","date.time: 2018-01-01 19:00:00<br />concentration: 12<br />pollutant: NO2","date.time: 2018-01-01 20:00:00<br />concentration: 17<br />pollutant: NO2","date.time: 2018-01-01 21:00:00<br />concentration: 22<br />pollutant: NO2","date.time: 2018-01-01 22:00:00<br />concentration: 26<br />pollutant: NO2","date.time: 2018-01-01 23:00:00<br />concentration: 34<br />pollutant: NO2","date.time: 2018-01-02 00:00:00<br />concentration: 42<br />pollutant: NO2","date.time: 2018-01-02 01:00:00<br />concentration: 37<br />pollutant: NO2","date.time: 2018-01-02 02:00:00<br />concentration: 20<br />pollutant: NO2","date.time: 2018-01-02 03:00:00<br />concentration: 20<br />pollutant: NO2","date.time: 2018-01-02 04:00:00<br />concentration: 23<br />pollutant: NO2","date.time: 2018-01-02 05:00:00<br />concentration: 20<br />pollutant: NO2","date.time: 2018-01-02 06:00:00<br />concentration: 21<br />pollutant: NO2","date.time: 2018-01-02 07:00:00<br />concentration: 23<br />pollutant: NO2","date.time: 2018-01-02 08:00:00<br />concentration: 21<br />pollutant: NO2","date.time: 2018-01-02 09:00:00<br />concentration: 22<br />pollutant: NO2","date.time: 2018-01-02 10:00:00<br />concentration: 26<br />pollutant: NO2","date.time: 2018-01-02 11:00:00<br />concentration: 19<br />pollutant: NO2","date.time: 2018-01-02 12:00:00<br />concentration: 16<br />pollutant: NO2","date.time: 2018-01-02 13:00:00<br />concentration: 18<br />pollutant: NO2","date.time: 2018-01-02 14:00:00<br />concentration: 18<br />pollutant: NO2","date.time: 2018-01-02 15:00:00<br />concentration: 18<br />pollutant: NO2","date.time: 2018-01-02 16:00:00<br />concentration: 20<br />pollutant: NO2","date.time: 2018-01-02 17:00:00<br />concentration: 24<br />pollutant: NO2","date.time: 2018-01-02 18:00:00<br />concentration: 27<br />pollutant: NO2","date.time: 2018-01-02 19:00:00<br />concentration: 31<br />pollutant: NO2","date.time: 2018-01-02 20:00:00<br />concentration: 26<br />pollutant: NO2","date.time: 2018-01-02 21:00:00<br />concentration: 25<br />pollutant: NO2","date.time: 2018-01-02 22:00:00<br />concentration: 26<br />pollutant: NO2","date.time: 2018-01-02 23:00:00<br />concentration: 23<br />pollutant: NO2","date.time: 2018-01-03 00:00:00<br />concentration: 21<br />pollutant: NO2","date.time: 2018-01-03 01:00:00<br />concentration: 16<br />pollutant: NO2","date.time: 2018-01-03 02:00:00<br />concentration: 18<br />pollutant: NO2","date.time: 2018-01-03 03:00:00<br />concentration: 19<br />pollutant: NO2","date.time: 2018-01-03 04:00:00<br />concentration: 20<br />pollutant: NO2","date.time: 2018-01-03 05:00:00<br />concentration: 24<br />pollutant: NO2","date.time: 2018-01-03 06:00:00<br />concentration: 24<br />pollutant: NO2","date.time: 2018-01-03 07:00:00<br />concentration: 35<br />pollutant: NO2","date.time: 2018-01-03 08:00:00<br />concentration: 31<br />pollutant: NO2","date.time: 2018-01-03 09:00:00<br />concentration: 17<br />pollutant: NO2","date.time: 2018-01-03 10:00:00<br />concentration: 14<br />pollutant: NO2","date.time: 2018-01-03 11:00:00<br />concentration: 10<br />pollutant: NO2","date.time: 2018-01-03 12:00:00<br />concentration:  9<br />pollutant: NO2","date.time: 2018-01-03 13:00:00<br />concentration: 11<br />pollutant: NO2","date.time: 2018-01-03 14:00:00<br />concentration: 10<br />pollutant: NO2","date.time: 2018-01-03 15:00:00<br />concentration: 15<br />pollutant: NO2","date.time: 2018-01-03 16:00:00<br />concentration: 18<br />pollutant: NO2","date.time: 2018-01-03 17:00:00<br />concentration: 21<br />pollutant: NO2","date.time: 2018-01-03 18:00:00<br />concentration: 24<br />pollutant: NO2","date.time: 2018-01-03 19:00:00<br />concentration: 21<br />pollutant: NO2","date.time: 2018-01-03 20:00:00<br />concentration: 23<br />pollutant: NO2","date.time: 2018-01-03 21:00:00<br />concentration: 26<br />pollutant: NO2","date.time: 2018-01-03 22:00:00<br />concentration: 32<br />pollutant: NO2","date.time: 2018-01-03 23:00:00<br />concentration: 32<br />pollutant: NO2","date.time: 2018-01-04 00:00:00<br />concentration: 28<br />pollutant: NO2","date.time: 2018-01-04 01:00:00<br />concentration: 30<br />pollutant: NO2","date.time: 2018-01-04 02:00:00<br />concentration: 31<br />pollutant: NO2","date.time: 2018-01-04 03:00:00<br />concentration: 35<br />pollutant: NO2","date.time: 2018-01-04 04:00:00<br />concentration: 38<br />pollutant: NO2","date.time: 2018-01-04 05:00:00<br />concentration: 26<br />pollutant: NO2","date.time: 2018-01-04 06:00:00<br />concentration: 27<br />pollutant: NO2","date.time: 2018-01-04 07:00:00<br />concentration: 33<br />pollutant: NO2","date.time: 2018-01-04 08:00:00<br />concentration: 26<br />pollutant: NO2","date.time: 2018-01-04 09:00:00<br />concentration: 19<br />pollutant: NO2","date.time: 2018-01-04 10:00:00<br />concentration: 12<br />pollutant: NO2","date.time: 2018-01-04 11:00:00<br />concentration: 12<br />pollutant: NO2","date.time: 2018-01-04 12:00:00<br />concentration: 10<br />pollutant: NO2","date.time: 2018-01-04 13:00:00<br />concentration: 11<br />pollutant: NO2","date.time: 2018-01-04 14:00:00<br />concentration: 10<br />pollutant: NO2","date.time: 2018-01-04 15:00:00<br />concentration: 10<br />pollutant: NO2","date.time: 2018-01-04 16:00:00<br />concentration: 11<br />pollutant: NO2","date.time: 2018-01-04 17:00:00<br />concentration: 13<br />pollutant: NO2","date.time: 2018-01-04 18:00:00<br />concentration: 13<br />pollutant: NO2","date.time: 2018-01-04 19:00:00<br />concentration:  9<br />pollutant: NO2","date.time: 2018-01-04 20:00:00<br />concentration:  8<br />pollutant: NO2","date.time: 2018-01-04 21:00:00<br />concentration: 10<br />pollutant: NO2","date.time: 2018-01-04 22:00:00<br />concentration:  9<br />pollutant: NO2","date.time: 2018-01-04 23:00:00<br />concentration: 10<br />pollutant: NO2","date.time: 2018-01-05 00:00:00<br />concentration:  7<br />pollutant: NO2","date.time: 2018-01-05 01:00:00<br />concentration:  9<br />pollutant: NO2","date.time: 2018-01-05 02:00:00<br />concentration:  7<br />pollutant: NO2","date.time: 2018-01-05 03:00:00<br />concentration: 11<br />pollutant: NO2","date.time: 2018-01-05 04:00:00<br />concentration: 15<br />pollutant: NO2","date.time: 2018-01-05 05:00:00<br />concentration: 18<br />pollutant: NO2","date.time: 2018-01-05 06:00:00<br />concentration: 23<br />pollutant: NO2","date.time: 2018-01-05 07:00:00<br />concentration: 27<br />pollutant: NO2","date.time: 2018-01-05 08:00:00<br />concentration: 17<br />pollutant: NO2","date.time: 2018-01-05 09:00:00<br />concentration: 19<br />pollutant: NO2","date.time: 2018-01-05 10:00:00<br />concentration: 13<br />pollutant: NO2","date.time: 2018-01-05 11:00:00<br />concentration: 11<br />pollutant: NO2","date.time: 2018-01-05 12:00:00<br />concentration: 13<br />pollutant: NO2","date.time: 2018-01-05 13:00:00<br />concentration: 14<br />pollutant: NO2","date.time: 2018-01-05 14:00:00<br />concentration: 16<br />pollutant: NO2","date.time: 2018-01-05 15:00:00<br />concentration: 13<br />pollutant: NO2","date.time: 2018-01-05 16:00:00<br />concentration: 13<br />pollutant: NO2","date.time: 2018-01-05 17:00:00<br />concentration: 17<br />pollutant: NO2","date.time: 2018-01-05 18:00:00<br />concentration: 17<br />pollutant: NO2","date.time: 2018-01-05 19:00:00<br />concentration: 14<br />pollutant: NO2","date.time: 2018-01-05 20:00:00<br />concentration: 20<br />pollutant: NO2","date.time: 2018-01-05 21:00:00<br />concentration: 22<br />pollutant: NO2","date.time: 2018-01-05 22:00:00<br />concentration: 16<br />pollutant: NO2","date.time: 2018-01-05 23:00:00<br />concentration: 14<br />pollutant: NO2","date.time: 2018-01-06 00:00:00<br />concentration:  9<br />pollutant: NO2","date.time: 2018-01-06 01:00:00<br />concentration: 14<br />pollutant: NO2","date.time: 2018-01-06 02:00:00<br />concentration: 19<br />pollutant: NO2","date.time: 2018-01-06 03:00:00<br />concentration: 21<br />pollutant: NO2","date.time: 2018-01-06 04:00:00<br />concentration: 15<br />pollutant: NO2","date.time: 2018-01-06 05:00:00<br />concentration: 18<br />pollutant: NO2","date.time: 2018-01-06 06:00:00<br />concentration: 16<br />pollutant: NO2","date.time: 2018-01-06 07:00:00<br />concentration: 22<br />pollutant: NO2","date.time: 2018-01-06 08:00:00<br />concentration: 20<br />pollutant: NO2","date.time: 2018-01-06 09:00:00<br />concentration: 16<br />pollutant: NO2","date.time: 2018-01-06 10:00:00<br />concentration: 11<br />pollutant: NO2","date.time: 2018-01-06 11:00:00<br />concentration: 11<br />pollutant: NO2","date.time: 2018-01-06 12:00:00<br />concentration:  8<br />pollutant: NO2","date.time: 2018-01-06 13:00:00<br />concentration:  8<br />pollutant: NO2","date.time: 2018-01-06 14:00:00<br />concentration:  8<br />pollutant: NO2","date.time: 2018-01-06 15:00:00<br />concentration: 10<br />pollutant: NO2","date.time: 2018-01-06 16:00:00<br />concentration: 16<br />pollutant: NO2","date.time: 2018-01-06 17:00:00<br />concentration: 23<br />pollutant: NO2","date.time: 2018-01-06 18:00:00<br />concentration: 26<br />pollutant: NO2","date.time: 2018-01-06 19:00:00<br />concentration: 25<br />pollutant: NO2","date.time: 2018-01-06 20:00:00<br />concentration: 20<br />pollutant: NO2","date.time: 2018-01-06 21:00:00<br />concentration: 28<br />pollutant: NO2","date.time: 2018-01-06 22:00:00<br />concentration: 32<br />pollutant: NO2","date.time: 2018-01-06 23:00:00<br />concentration: 49<br />pollutant: NO2","date.time: 2018-01-07 00:00:00<br />concentration: 50<br />pollutant: NO2","date.time: 2018-01-07 01:00:00<br />concentration: 50<br />pollutant: NO2","date.time: 2018-01-07 02:00:00<br />concentration: 50<br />pollutant: NO2","date.time: 2018-01-07 03:00:00<br />concentration: 46<br />pollutant: NO2","date.time: 2018-01-07 04:00:00<br />concentration: 45<br />pollutant: NO2","date.time: 2018-01-07 05:00:00<br />concentration: 43<br />pollutant: NO2","date.time: 2018-01-07 06:00:00<br />concentration: 31<br />pollutant: NO2","date.time: 2018-01-07 07:00:00<br />concentration: 21<br />pollutant: NO2","date.time: 2018-01-07 08:00:00<br />concentration: 12<br />pollutant: NO2","date.time: 2018-01-07 09:00:00<br />concentration: 12<br />pollutant: NO2","date.time: 2018-01-07 10:00:00<br />concentration:  9<br />pollutant: NO2","date.time: 2018-01-07 11:00:00<br />concentration:  7<br />pollutant: NO2","date.time: 2018-01-07 12:00:00<br />concentration:  7<br />pollutant: NO2","date.time: 2018-01-07 13:00:00<br />concentration:  7<br />pollutant: NO2","date.time: 2018-01-07 14:00:00<br />concentration:  8<br />pollutant: NO2","date.time: 2018-01-07 15:00:00<br />concentration:  9<br />pollutant: NO2","date.time: 2018-01-07 16:00:00<br />concentration: 10<br />pollutant: NO2","date.time: 2018-01-07 17:00:00<br />concentration: 11<br />pollutant: NO2","date.time: 2018-01-07 18:00:00<br />concentration: 10<br />pollutant: NO2","date.time: 2018-01-07 19:00:00<br />concentration: 11<br />pollutant: NO2","date.time: 2018-01-07 20:00:00<br />concentration: 12<br />pollutant: NO2","date.time: 2018-01-07 21:00:00<br />concentration: 15<br />pollutant: NO2","date.time: 2018-01-07 22:00:00<br />concentration: 18<br />pollutant: NO2","date.time: 2018-01-07 23:00:00<br />concentration: 18<br />pollutant: NO2","date.time: 2018-01-08 00:00:00<br />concentration: 15<br />pollutant: NO2"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"NO2","legendgroup":"NO2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1514764800,1514768400,1514772000,1514775600,1514779200,1514782800,1514786400,1514790000,1514793600,1514797200,1514800800,1514804400,1514808000,1514811600,1514815200,1514818800,1514822400,1514826000,1514829600,1514833200,1514836800,1514840400,1514844000,1514847600,1514851200,1514854800,1514858400,1514862000,1514865600,1514869200,1514872800,1514876400,1514880000,1514883600,1514887200,1514890800,1514894400,1514898000,1514901600,1514905200,1514908800,1514912400,1514916000,1514919600,1514923200,1514926800,1514930400,1514934000,1514937600,1514941200,1514944800,1514948400,1514952000,1514955600,1514959200,1514962800,1514966400,1514970000,1514973600,1514977200,1514980800,1514984400,1514988000,1514991600,1514995200,1514998800,1515002400,1515006000,1515009600,1515013200,1515016800,1515020400,1515024000,1515027600,1515031200,1515034800,1515038400,1515042000,1515045600,1515049200,1515052800,1515056400,1515060000,1515063600,1515067200,1515070800,1515074400,1515078000,1515081600,1515085200,1515088800,1515092400,1515096000,1515099600,1515103200,1515106800,1515110400,1515114000,1515117600,1515121200,1515124800,1515128400,1515132000,1515135600,1515139200,1515142800,1515146400,1515150000,1515153600,1515157200,1515160800,1515164400,1515168000,1515171600,1515175200,1515178800,1515182400,1515186000,1515189600,1515193200,1515196800,1515200400,1515204000,1515207600,1515211200,1515214800,1515218400,1515222000,1515225600,1515229200,1515232800,1515236400,1515240000,1515243600,1515247200,1515250800,1515254400,1515258000,1515261600,1515265200,1515268800,1515272400,1515276000,1515279600,1515283200,1515286800,1515290400,1515294000,1515297600,1515301200,1515304800,1515308400,1515312000,1515315600,1515319200,1515322800,1515326400,1515330000,1515333600,1515337200,1515340800,1515344400,1515348000,1515351600,1515355200,1515358800,1515362400,1515366000,1515369600],"y":[3,1,1,1,1,1,1,1,7,23,29,32,33,33,31,31,30,31,30,28,24,20,17,9,2,6,19,19,16,20,21,19,22,20,16,22,23,23,24,24,22,16,14,11,14,15,15,17,20,24,23,24,25,22,21,12,13,25,25,28,29,28,28,24,22,19,17,17,15,11,7,7,7,6,5,2,2,13,12,8,14,20,25,26,28,27,26,26,26,23,23,27,29,28,29,28,30,27,28,25,21,19,16,13,20,19,23,24,24,23,23,24,24,21,20,24,20,18,22,23,27,23,19,17,22,19,21,16,18,22,24,24,28,28,28,27,24,18,17,18,21,15,12,2,1,1,1,3,2,4,12,20,27,25,27,31,32,32,31,30,30,29,30,29,27,25,23,22,25],"text":["date.time: 2018-01-01 00:00:00<br />concentration:  3<br />pollutant: O3","date.time: 2018-01-01 01:00:00<br />concentration:  1<br />pollutant: O3","date.time: 2018-01-01 02:00:00<br />concentration:  1<br />pollutant: O3","date.time: 2018-01-01 03:00:00<br />concentration:  1<br />pollutant: O3","date.time: 2018-01-01 04:00:00<br />concentration:  1<br />pollutant: O3","date.time: 2018-01-01 05:00:00<br />concentration:  1<br />pollutant: O3","date.time: 2018-01-01 06:00:00<br />concentration:  1<br />pollutant: O3","date.time: 2018-01-01 07:00:00<br />concentration:  1<br />pollutant: O3","date.time: 2018-01-01 08:00:00<br />concentration:  7<br />pollutant: O3","date.time: 2018-01-01 09:00:00<br />concentration: 23<br />pollutant: O3","date.time: 2018-01-01 10:00:00<br />concentration: 29<br />pollutant: O3","date.time: 2018-01-01 11:00:00<br />concentration: 32<br />pollutant: O3","date.time: 2018-01-01 12:00:00<br />concentration: 33<br />pollutant: O3","date.time: 2018-01-01 13:00:00<br />concentration: 33<br />pollutant: O3","date.time: 2018-01-01 14:00:00<br />concentration: 31<br />pollutant: O3","date.time: 2018-01-01 15:00:00<br />concentration: 31<br />pollutant: O3","date.time: 2018-01-01 16:00:00<br />concentration: 30<br />pollutant: O3","date.time: 2018-01-01 17:00:00<br />concentration: 31<br />pollutant: O3","date.time: 2018-01-01 18:00:00<br />concentration: 30<br />pollutant: O3","date.time: 2018-01-01 19:00:00<br />concentration: 28<br />pollutant: O3","date.time: 2018-01-01 20:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-01 21:00:00<br />concentration: 20<br />pollutant: O3","date.time: 2018-01-01 22:00:00<br />concentration: 17<br />pollutant: O3","date.time: 2018-01-01 23:00:00<br />concentration:  9<br />pollutant: O3","date.time: 2018-01-02 00:00:00<br />concentration:  2<br />pollutant: O3","date.time: 2018-01-02 01:00:00<br />concentration:  6<br />pollutant: O3","date.time: 2018-01-02 02:00:00<br />concentration: 19<br />pollutant: O3","date.time: 2018-01-02 03:00:00<br />concentration: 19<br />pollutant: O3","date.time: 2018-01-02 04:00:00<br />concentration: 16<br />pollutant: O3","date.time: 2018-01-02 05:00:00<br />concentration: 20<br />pollutant: O3","date.time: 2018-01-02 06:00:00<br />concentration: 21<br />pollutant: O3","date.time: 2018-01-02 07:00:00<br />concentration: 19<br />pollutant: O3","date.time: 2018-01-02 08:00:00<br />concentration: 22<br />pollutant: O3","date.time: 2018-01-02 09:00:00<br />concentration: 20<br />pollutant: O3","date.time: 2018-01-02 10:00:00<br />concentration: 16<br />pollutant: O3","date.time: 2018-01-02 11:00:00<br />concentration: 22<br />pollutant: O3","date.time: 2018-01-02 12:00:00<br />concentration: 23<br />pollutant: O3","date.time: 2018-01-02 13:00:00<br />concentration: 23<br />pollutant: O3","date.time: 2018-01-02 14:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-02 15:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-02 16:00:00<br />concentration: 22<br />pollutant: O3","date.time: 2018-01-02 17:00:00<br />concentration: 16<br />pollutant: O3","date.time: 2018-01-02 18:00:00<br />concentration: 14<br />pollutant: O3","date.time: 2018-01-02 19:00:00<br />concentration: 11<br />pollutant: O3","date.time: 2018-01-02 20:00:00<br />concentration: 14<br />pollutant: O3","date.time: 2018-01-02 21:00:00<br />concentration: 15<br />pollutant: O3","date.time: 2018-01-02 22:00:00<br />concentration: 15<br />pollutant: O3","date.time: 2018-01-02 23:00:00<br />concentration: 17<br />pollutant: O3","date.time: 2018-01-03 00:00:00<br />concentration: 20<br />pollutant: O3","date.time: 2018-01-03 01:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-03 02:00:00<br />concentration: 23<br />pollutant: O3","date.time: 2018-01-03 03:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-03 04:00:00<br />concentration: 25<br />pollutant: O3","date.time: 2018-01-03 05:00:00<br />concentration: 22<br />pollutant: O3","date.time: 2018-01-03 06:00:00<br />concentration: 21<br />pollutant: O3","date.time: 2018-01-03 07:00:00<br />concentration: 12<br />pollutant: O3","date.time: 2018-01-03 08:00:00<br />concentration: 13<br />pollutant: O3","date.time: 2018-01-03 09:00:00<br />concentration: 25<br />pollutant: O3","date.time: 2018-01-03 10:00:00<br />concentration: 25<br />pollutant: O3","date.time: 2018-01-03 11:00:00<br />concentration: 28<br />pollutant: O3","date.time: 2018-01-03 12:00:00<br />concentration: 29<br />pollutant: O3","date.time: 2018-01-03 13:00:00<br />concentration: 28<br />pollutant: O3","date.time: 2018-01-03 14:00:00<br />concentration: 28<br />pollutant: O3","date.time: 2018-01-03 15:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-03 16:00:00<br />concentration: 22<br />pollutant: O3","date.time: 2018-01-03 17:00:00<br />concentration: 19<br />pollutant: O3","date.time: 2018-01-03 18:00:00<br />concentration: 17<br />pollutant: O3","date.time: 2018-01-03 19:00:00<br />concentration: 17<br />pollutant: O3","date.time: 2018-01-03 20:00:00<br />concentration: 15<br />pollutant: O3","date.time: 2018-01-03 21:00:00<br />concentration: 11<br />pollutant: O3","date.time: 2018-01-03 22:00:00<br />concentration:  7<br />pollutant: O3","date.time: 2018-01-03 23:00:00<br />concentration:  7<br />pollutant: O3","date.time: 2018-01-04 00:00:00<br />concentration:  7<br />pollutant: O3","date.time: 2018-01-04 01:00:00<br />concentration:  6<br />pollutant: O3","date.time: 2018-01-04 02:00:00<br />concentration:  5<br />pollutant: O3","date.time: 2018-01-04 03:00:00<br />concentration:  2<br />pollutant: O3","date.time: 2018-01-04 04:00:00<br />concentration:  2<br />pollutant: O3","date.time: 2018-01-04 05:00:00<br />concentration: 13<br />pollutant: O3","date.time: 2018-01-04 06:00:00<br />concentration: 12<br />pollutant: O3","date.time: 2018-01-04 07:00:00<br />concentration:  8<br />pollutant: O3","date.time: 2018-01-04 08:00:00<br />concentration: 14<br />pollutant: O3","date.time: 2018-01-04 09:00:00<br />concentration: 20<br />pollutant: O3","date.time: 2018-01-04 10:00:00<br />concentration: 25<br />pollutant: O3","date.time: 2018-01-04 11:00:00<br />concentration: 26<br />pollutant: O3","date.time: 2018-01-04 12:00:00<br />concentration: 28<br />pollutant: O3","date.time: 2018-01-04 13:00:00<br />concentration: 27<br />pollutant: O3","date.time: 2018-01-04 14:00:00<br />concentration: 26<br />pollutant: O3","date.time: 2018-01-04 15:00:00<br />concentration: 26<br />pollutant: O3","date.time: 2018-01-04 16:00:00<br />concentration: 26<br />pollutant: O3","date.time: 2018-01-04 17:00:00<br />concentration: 23<br />pollutant: O3","date.time: 2018-01-04 18:00:00<br />concentration: 23<br />pollutant: O3","date.time: 2018-01-04 19:00:00<br />concentration: 27<br />pollutant: O3","date.time: 2018-01-04 20:00:00<br />concentration: 29<br />pollutant: O3","date.time: 2018-01-04 21:00:00<br />concentration: 28<br />pollutant: O3","date.time: 2018-01-04 22:00:00<br />concentration: 29<br />pollutant: O3","date.time: 2018-01-04 23:00:00<br />concentration: 28<br />pollutant: O3","date.time: 2018-01-05 00:00:00<br />concentration: 30<br />pollutant: O3","date.time: 2018-01-05 01:00:00<br />concentration: 27<br />pollutant: O3","date.time: 2018-01-05 02:00:00<br />concentration: 28<br />pollutant: O3","date.time: 2018-01-05 03:00:00<br />concentration: 25<br />pollutant: O3","date.time: 2018-01-05 04:00:00<br />concentration: 21<br />pollutant: O3","date.time: 2018-01-05 05:00:00<br />concentration: 19<br />pollutant: O3","date.time: 2018-01-05 06:00:00<br />concentration: 16<br />pollutant: O3","date.time: 2018-01-05 07:00:00<br />concentration: 13<br />pollutant: O3","date.time: 2018-01-05 08:00:00<br />concentration: 20<br />pollutant: O3","date.time: 2018-01-05 09:00:00<br />concentration: 19<br />pollutant: O3","date.time: 2018-01-05 10:00:00<br />concentration: 23<br />pollutant: O3","date.time: 2018-01-05 11:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-05 12:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-05 13:00:00<br />concentration: 23<br />pollutant: O3","date.time: 2018-01-05 14:00:00<br />concentration: 23<br />pollutant: O3","date.time: 2018-01-05 15:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-05 16:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-05 17:00:00<br />concentration: 21<br />pollutant: O3","date.time: 2018-01-05 18:00:00<br />concentration: 20<br />pollutant: O3","date.time: 2018-01-05 19:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-05 20:00:00<br />concentration: 20<br />pollutant: O3","date.time: 2018-01-05 21:00:00<br />concentration: 18<br />pollutant: O3","date.time: 2018-01-05 22:00:00<br />concentration: 22<br />pollutant: O3","date.time: 2018-01-05 23:00:00<br />concentration: 23<br />pollutant: O3","date.time: 2018-01-06 00:00:00<br />concentration: 27<br />pollutant: O3","date.time: 2018-01-06 01:00:00<br />concentration: 23<br />pollutant: O3","date.time: 2018-01-06 02:00:00<br />concentration: 19<br />pollutant: O3","date.time: 2018-01-06 03:00:00<br />concentration: 17<br />pollutant: O3","date.time: 2018-01-06 04:00:00<br />concentration: 22<br />pollutant: O3","date.time: 2018-01-06 05:00:00<br />concentration: 19<br />pollutant: O3","date.time: 2018-01-06 06:00:00<br />concentration: 21<br />pollutant: O3","date.time: 2018-01-06 07:00:00<br />concentration: 16<br />pollutant: O3","date.time: 2018-01-06 08:00:00<br />concentration: 18<br />pollutant: O3","date.time: 2018-01-06 09:00:00<br />concentration: 22<br />pollutant: O3","date.time: 2018-01-06 10:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-06 11:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-06 12:00:00<br />concentration: 28<br />pollutant: O3","date.time: 2018-01-06 13:00:00<br />concentration: 28<br />pollutant: O3","date.time: 2018-01-06 14:00:00<br />concentration: 28<br />pollutant: O3","date.time: 2018-01-06 15:00:00<br />concentration: 27<br />pollutant: O3","date.time: 2018-01-06 16:00:00<br />concentration: 24<br />pollutant: O3","date.time: 2018-01-06 17:00:00<br />concentration: 18<br />pollutant: O3","date.time: 2018-01-06 18:00:00<br />concentration: 17<br />pollutant: O3","date.time: 2018-01-06 19:00:00<br />concentration: 18<br />pollutant: O3","date.time: 2018-01-06 20:00:00<br />concentration: 21<br />pollutant: O3","date.time: 2018-01-06 21:00:00<br />concentration: 15<br />pollutant: O3","date.time: 2018-01-06 22:00:00<br />concentration: 12<br />pollutant: O3","date.time: 2018-01-06 23:00:00<br />concentration:  2<br />pollutant: O3","date.time: 2018-01-07 00:00:00<br />concentration:  1<br />pollutant: O3","date.time: 2018-01-07 01:00:00<br />concentration:  1<br />pollutant: O3","date.time: 2018-01-07 02:00:00<br />concentration:  1<br />pollutant: O3","date.time: 2018-01-07 03:00:00<br />concentration:  3<br />pollutant: O3","date.time: 2018-01-07 04:00:00<br />concentration:  2<br />pollutant: O3","date.time: 2018-01-07 05:00:00<br />concentration:  4<br />pollutant: O3","date.time: 2018-01-07 06:00:00<br />concentration: 12<br />pollutant: O3","date.time: 2018-01-07 07:00:00<br />concentration: 20<br />pollutant: O3","date.time: 2018-01-07 08:00:00<br />concentration: 27<br />pollutant: O3","date.time: 2018-01-07 09:00:00<br />concentration: 25<br />pollutant: O3","date.time: 2018-01-07 10:00:00<br />concentration: 27<br />pollutant: O3","date.time: 2018-01-07 11:00:00<br />concentration: 31<br />pollutant: O3","date.time: 2018-01-07 12:00:00<br />concentration: 32<br />pollutant: O3","date.time: 2018-01-07 13:00:00<br />concentration: 32<br />pollutant: O3","date.time: 2018-01-07 14:00:00<br />concentration: 31<br />pollutant: O3","date.time: 2018-01-07 15:00:00<br />concentration: 30<br />pollutant: O3","date.time: 2018-01-07 16:00:00<br />concentration: 30<br />pollutant: O3","date.time: 2018-01-07 17:00:00<br />concentration: 29<br />pollutant: O3","date.time: 2018-01-07 18:00:00<br />concentration: 30<br />pollutant: O3","date.time: 2018-01-07 19:00:00<br />concentration: 29<br />pollutant: O3","date.time: 2018-01-07 20:00:00<br />concentration: 27<br />pollutant: O3","date.time: 2018-01-07 21:00:00<br />concentration: 25<br />pollutant: O3","date.time: 2018-01-07 22:00:00<br />concentration: 23<br />pollutant: O3","date.time: 2018-01-07 23:00:00<br />concentration: 22<br />pollutant: O3","date.time: 2018-01-08 00:00:00<br />concentration: 25<br />pollutant: O3"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","name":"O3","legendgroup":"O3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1514764800,1514768400,1514772000,1514775600,1514779200,1514782800,1514786400,1514790000,1514793600,1514797200,1514800800,1514804400,1514808000,1514811600,1514815200,1514818800,1514822400,1514826000,1514829600,1514833200,1514836800,1514840400,1514844000,1514847600,1514851200,1514854800,1514858400,1514862000,1514865600,1514869200,1514872800,1514876400,1514880000,1514883600,1514887200,1514890800,1514894400,1514898000,1514901600,1514905200,1514908800,1514912400,1514916000,1514919600,1514923200,1514926800,1514930400,1514934000,1514937600,1514941200,1514944800,1514948400,1514952000,1514955600,1514959200,1514962800,1514966400,1514970000,1514973600,1514977200,1514980800,1514984400,1514988000,1514991600,1514995200,1514998800,1515002400,1515006000,1515009600,1515013200,1515016800,1515020400,1515024000,1515027600,1515031200,1515034800,1515038400,1515042000,1515045600,1515049200,1515052800,1515056400,1515060000,1515063600,1515067200,1515070800,1515074400,1515078000,1515081600,1515085200,1515088800,1515092400,1515096000,1515099600,1515103200,1515106800,1515110400,1515114000,1515117600,1515121200,1515124800,1515128400,1515132000,1515135600,1515139200,1515142800,1515146400,1515150000,1515153600,1515157200,1515160800,1515164400,1515168000,1515171600,1515175200,1515178800,1515182400,1515186000,1515189600,1515193200,1515196800,1515200400,1515204000,1515207600,1515211200,1515214800,1515218400,1515222000,1515225600,1515229200,1515232800,1515236400,1515240000,1515243600,1515247200,1515250800,1515254400,1515258000,1515261600,1515265200,1515268800,1515272400,1515276000,1515279600,1515283200,1515286800,1515290400,1515294000,1515297600,1515301200,1515304800,1515308400,1515312000,1515315600,1515319200,1515322800,1515326400,1515330000,1515333600,1515337200,1515340800,1515344400,1515348000,1515351600,1515355200,1515358800,1515362400,1515366000,1515369600],"y":[1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,2,1,1,1,1,2,2,1,1,1,1,1,1,1],"text":["date.time: 2018-01-01 00:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 01:00:00<br />concentration:  3<br />pollutant: SO2","date.time: 2018-01-01 02:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 03:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 04:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 05:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 06:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 07:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 08:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 09:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 10:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 11:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 12:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 13:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 14:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 15:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 16:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 17:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 18:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 19:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 20:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 21:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 22:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-01 23:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 00:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 01:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 02:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 03:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 04:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 05:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 06:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 07:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 08:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 09:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 10:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 11:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 12:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 13:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 14:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 15:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 16:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 17:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 18:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 19:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 20:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 21:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 22:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-02 23:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 00:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 01:00:00<br />concentration:  2<br />pollutant: SO2","date.time: 2018-01-03 02:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 03:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 04:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 05:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 06:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 07:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 08:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 09:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 10:00:00<br />concentration:  2<br />pollutant: SO2","date.time: 2018-01-03 11:00:00<br />concentration:  2<br />pollutant: SO2","date.time: 2018-01-03 12:00:00<br />concentration:  2<br />pollutant: SO2","date.time: 2018-01-03 13:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 14:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 15:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 16:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 17:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 18:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 19:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 20:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 21:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 22:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-03 23:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 00:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 01:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 02:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 03:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 04:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 05:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 06:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 07:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 08:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 09:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 10:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 11:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 12:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 13:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 14:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 15:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 16:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 17:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 18:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 19:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 20:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 21:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 22:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-04 23:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 00:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 01:00:00<br />concentration:  3<br />pollutant: SO2","date.time: 2018-01-05 02:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 03:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 04:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 05:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 06:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 07:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 08:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 09:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 10:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 11:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 12:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 13:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 14:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 15:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 16:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 17:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 18:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 19:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 20:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 21:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 22:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-05 23:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 00:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 01:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 02:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 03:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 04:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 05:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 06:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 07:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 08:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 09:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 10:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 11:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 12:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 13:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 14:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 15:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 16:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 17:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 18:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 19:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 20:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 21:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 22:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-06 23:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 00:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 01:00:00<br />concentration:  2<br />pollutant: SO2","date.time: 2018-01-07 02:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 03:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 04:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 05:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 06:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 07:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 08:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 09:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 10:00:00<br />concentration:  2<br />pollutant: SO2","date.time: 2018-01-07 11:00:00<br />concentration:  2<br />pollutant: SO2","date.time: 2018-01-07 12:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 13:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 14:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 15:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 16:00:00<br />concentration:  2<br />pollutant: SO2","date.time: 2018-01-07 17:00:00<br />concentration:  2<br />pollutant: SO2","date.time: 2018-01-07 18:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 19:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 20:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 21:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 22:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-07 23:00:00<br />concentration:  1<br />pollutant: SO2","date.time: 2018-01-08 00:00:00<br />concentration:  1<br />pollutant: SO2"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","name":"SO2","legendgroup":"SO2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1514734560,1515399840],"tickmode":"array","ticktext":["Jan 02","Jan 04","Jan 06","Jan 08"],"tickvals":[1514851200,1515024000,1515196800,1515369600],"categoryorder":"array","categoryarray":["Jan 02","Jan 04","Jan 06","Jan 08"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"date.time","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.7000000000000002,57.700000000000003],"tickmode":"array","ticktext":["0","20","40"],"tickvals":[0,20,40],"categoryorder":"array","categoryarray":["0","20","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"concentration","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"pollutant","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"143351a8cbc7e":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"143351a8cbc7e","visdat":{"143351a8cbc7e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>This is also super useful when surveying spectroscopy data, although the large number of points in those datasets can take a while to render into interactive plotly plots.</p>
</div>
<div id="plotting-for-publication" class="section level2 hasAnchor" number="15.8">
<h2><span class="header-section-number">15.8</span> Plotting for publication<a href="visualizations.html#plotting-for-publication" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Up until now we haven’t payed much attention to the explicit aesthetics of plots beyond what we needed for our exploratory analysis. However, many journals, publications, instructors, etc. will want plots to adhere to certain aesthetic standards. There’s scores of options to play with, so we recommend you consult the <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/master/data-visualization.pdf">ggplot2 Cheat Sheet</a>.</p>
<div id="plot-themes" class="section level3 hasAnchor" number="15.8.1">
<h3><span class="header-section-number">15.8.1</span> Plot Themes<a href="visualizations.html#plot-themes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Overall themes can be applied to ggplot. The simple and minimalist <code>theme_classic()</code> is satisfactory for most submissions, but you can peruse the available these in ggplot <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">here</a> or you can explore many more themes in the <a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/"><code>ggthemes</code> package</a>.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="visualizations.html#cb253-1" tabindex="-1"></a><span class="co"># generating example plot to modify </span></span>
<span id="cb253-2"><a href="visualizations.html#cb253-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> torontoAir, </span>
<span id="cb253-3"><a href="visualizations.html#cb253-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> date.time,</span>
<span id="cb253-4"><a href="visualizations.html#cb253-4" tabindex="-1"></a>           <span class="at">y =</span> concentration,</span>
<span id="cb253-5"><a href="visualizations.html#cb253-5" tabindex="-1"></a>           <span class="at">colour =</span> pollutant)) <span class="sc">+</span></span>
<span id="cb253-6"><a href="visualizations.html#cb253-6" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb253-7"><a href="visualizations.html#cb253-7" tabindex="-1"></a></span>
<span id="cb253-8"><a href="visualizations.html#cb253-8" tabindex="-1"></a><span class="co"># default theme</span></span>
<span id="cb253-9"><a href="visualizations.html#cb253-9" tabindex="-1"></a>default <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Default geom_scatter&quot;</span>)</span>
<span id="cb253-10"><a href="visualizations.html#cb253-10" tabindex="-1"></a></span>
<span id="cb253-11"><a href="visualizations.html#cb253-11" tabindex="-1"></a></span>
<span id="cb253-12"><a href="visualizations.html#cb253-12" tabindex="-1"></a><span class="co"># Classic theme</span></span>
<span id="cb253-13"><a href="visualizations.html#cb253-13" tabindex="-1"></a>classic <span class="ot">&lt;-</span> p <span class="sc">+</span> </span>
<span id="cb253-14"><a href="visualizations.html#cb253-14" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb253-15"><a href="visualizations.html#cb253-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;theme_classic()&quot;</span>)</span>
<span id="cb253-16"><a href="visualizations.html#cb253-16" tabindex="-1"></a> </span>
<span id="cb253-17"><a href="visualizations.html#cb253-17" tabindex="-1"></a></span>
<span id="cb253-18"><a href="visualizations.html#cb253-18" tabindex="-1"></a><span class="co"># arranging into grid</span></span>
<span id="cb253-19"><a href="visualizations.html#cb253-19" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(default, classic, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>
</div>
<div id="legends" class="section level3 hasAnchor" number="15.8.2">
<h3><span class="header-section-number">15.8.2</span> Legends<a href="visualizations.html#legends" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can specify the position of the legend under the <code>theme()</code> option as such:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="visualizations.html#cb254-1" tabindex="-1"></a>bottom <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb254-2"><a href="visualizations.html#cb254-2" tabindex="-1"></a></span>
<span id="cb254-3"><a href="visualizations.html#cb254-3" tabindex="-1"></a>inside <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">95</span>, .<span class="dv">95</span>))</span>
<span id="cb254-4"><a href="visualizations.html#cb254-4" tabindex="-1"></a></span>
<span id="cb254-5"><a href="visualizations.html#cb254-5" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(bottom, inside, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
<p>Other legend positions include: “none”, “left”, “right”, “bottom”, “top”, or a two-element numeric vector to specify the location such as <code>c(0.95, 0.95)</code> for inside the top-right corner. <code>c(0.05, 0.05)</code> would place it inside the bottom right corner, and so on. Also note that <code>legend.position = "none"</code> will remove the legend entirely.</p>
</div>
<div id="modifying-labels" class="section level3 hasAnchor" number="15.8.3">
<h3><span class="header-section-number">15.8.3</span> Modifying labels<a href="visualizations.html#modifying-labels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The labels generated for the plots are derived from the variable names passed along to the <code>ggplot()</code> function. Consequently, variable names that are easy to code become ugly labels on the plot. You can modify labels using the <code>labs()</code> function. Note in the example below that we changed the legend’s title by specifying what <code>aes()</code> option we used to create the legend; in the example below it’s <code>colour</code>.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="visualizations.html#cb255-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Toronto Air quality&quot;</span>,</span>
<span id="cb255-2"><a href="visualizations.html#cb255-2" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;from Jan 1st to 8th, 2018&quot;</span>, </span>
<span id="cb255-3"><a href="visualizations.html#cb255-3" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb255-4"><a href="visualizations.html#cb255-4" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Concentration (ppb)&quot;</span>,</span>
<span id="cb255-5"><a href="visualizations.html#cb255-5" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">&quot;Pollutant&quot;</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-145-1.png" width="672" /></p>
</div>
<div id="modifying-axis" class="section level3 hasAnchor" number="15.8.4">
<h3><span class="header-section-number">15.8.4</span> Modifying Axis<a href="visualizations.html#modifying-axis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ve already talked about labelling axis titles in <a href="visualizations.html#modifying-labels">Modifying labels</a>, and adding marginal plots in <a href="visualizations.html#scatter-plots">Scatter plots</a>. So we’ll just briefly touch upon some simple axis modifications.</p>
<div id="transforming-axix" class="section level4 hasAnchor" number="15.8.4.1">
<h4><span class="header-section-number">15.8.4.1</span> Transforming axix<a href="visualizations.html#transforming-axix" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Transformations are largely related to <em>continuous</em> data, and are done using <code>scale_y_continuous()</code> or <code>scale_x_continuous()</code> functions. For example to scale the y-axis of our plot we’d do the following:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="visualizations.html#cb256-1" tabindex="-1"></a>p <span class="sc">+</span></span>
<span id="cb256-2"><a href="visualizations.html#cb256-2" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="sc">+</span></span>
<span id="cb256-3"><a href="visualizations.html#cb256-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Log10(concentration)&quot;</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-146-1.png" width="672" /></p>
<p>Other useful transformations include “log2” for base-2 logs, “date” for dates, and “hms” for time. The later two are useful if R hasn’t correctly interpreted your dataset. The data type for the <code>data.time</code> column of our dataset was correctly interpreted during our initial importation using <code>read_csv()</code>. Hooray for doing it right the first time.</p>
</div>
<div id="limits" class="section level4 hasAnchor" number="15.8.4.2">
<h4><span class="header-section-number">15.8.4.2</span> Limits<a href="visualizations.html#limits" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The limits of plots created with <code>ggplot()</code> are automatically assigned, but you can override these using the <code>lims()</code> function. For example we can specify the limits of our example plot to show from 0 to 100 ppb:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="visualizations.html#cb257-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-147-1.png" width="672" /></p>
</div>
<div id="axis-tickslabels" class="section level4 hasAnchor" number="15.8.4.3">
<h4><span class="header-section-number">15.8.4.3</span> Axis ticks/labels<a href="visualizations.html#axis-tickslabels" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Sometimes when you are plotting, the length of the axis labels is unreadable. This is often the case with categorical data, such as the name of cities like we’ve encountered earlier. We addressed this earlier in [Bar charts] by rotating the plot 90<span class="math inline">\(^\circ\)</span> with the <code>coord_flip()</code> function. This is often the best solution as it’s how we read English. Another solution is to rotate the axis labels themselves:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="visualizations.html#cb258-1" tabindex="-1"></a>basePlot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(sumAtl, p <span class="sc">==</span> <span class="st">&quot;NL&quot;</span>),</span>
<span id="cb258-2"><a href="visualizations.html#cb258-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> city, </span>
<span id="cb258-3"><a href="visualizations.html#cb258-3" tabindex="-1"></a>           <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb258-4"><a href="visualizations.html#cb258-4" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb258-5"><a href="visualizations.html#cb258-5" tabindex="-1"></a></span>
<span id="cb258-6"><a href="visualizations.html#cb258-6" tabindex="-1"></a>default <span class="ot">&lt;-</span> basePlot <span class="sc">+</span></span>
<span id="cb258-7"><a href="visualizations.html#cb258-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;default plot&quot;</span>)</span>
<span id="cb258-8"><a href="visualizations.html#cb258-8" tabindex="-1"></a></span>
<span id="cb258-9"><a href="visualizations.html#cb258-9" tabindex="-1"></a>flip <span class="ot">&lt;-</span> basePlot <span class="sc">+</span></span>
<span id="cb258-10"><a href="visualizations.html#cb258-10" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb258-11"><a href="visualizations.html#cb258-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;coord_flip()&quot;</span>)</span>
<span id="cb258-12"><a href="visualizations.html#cb258-12" tabindex="-1"></a></span>
<span id="cb258-13"><a href="visualizations.html#cb258-13" tabindex="-1"></a>rotated <span class="ot">&lt;-</span> basePlot <span class="sc">+</span></span>
<span id="cb258-14"><a href="visualizations.html#cb258-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>)) <span class="sc">+</span></span>
<span id="cb258-15"><a href="visualizations.html#cb258-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;element_text(angle = 45)&quot;</span>)</span>
<span id="cb258-16"><a href="visualizations.html#cb258-16" tabindex="-1"></a></span>
<span id="cb258-17"><a href="visualizations.html#cb258-17" tabindex="-1"></a>rotatedHJust <span class="ot">&lt;-</span> basePlot <span class="sc">+</span></span>
<span id="cb258-18"><a href="visualizations.html#cb258-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb258-19"><a href="visualizations.html#cb258-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;element_text(angle = 45, hjust = 1)&quot;</span>)</span>
<span id="cb258-20"><a href="visualizations.html#cb258-20" tabindex="-1"></a></span>
<span id="cb258-21"><a href="visualizations.html#cb258-21" tabindex="-1"></a></span>
<span id="cb258-22"><a href="visualizations.html#cb258-22" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(default, flip, rotated, rotatedHJust, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
</div>
</div>
<div id="arranging-plots" class="section level3 hasAnchor" number="15.8.5">
<h3><span class="header-section-number">15.8.5</span> Arranging plots<a href="visualizations.html#arranging-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We talked about how facets can be used to generate multiple plots from a dataset (small multiples), but sometimes you want to combine two or more <em>different</em> plots together. There are a couple of ways, but we’ve been using <code>grid.arrange()</code> from the <code>gridExtra</code> pacakge (as demonstrated above). You can read up on <a href="https://cran.r-project.org/web/packages/egg/vignettes/Ecosystem.html"><code>gridExtra</code> here</a>. There is also the <a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html"><code>ggarrange</code> function</a> from the <code>ggpubr</code> package which, amongst other things, can easily create shared legends between plots.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="visualizations.html#cb259-1" tabindex="-1"></a>colchart <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> sumAtl,</span>
<span id="cb259-2"><a href="visualizations.html#cb259-2" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(city, mean),</span>
<span id="cb259-3"><a href="visualizations.html#cb259-3" tabindex="-1"></a>                       <span class="at">y =</span> mean, </span>
<span id="cb259-4"><a href="visualizations.html#cb259-4" tabindex="-1"></a>                       <span class="at">fill =</span> p)) <span class="sc">+</span></span>
<span id="cb259-5"><a href="visualizations.html#cb259-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb259-6"><a href="visualizations.html#cb259-6" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> sd, </span>
<span id="cb259-7"><a href="visualizations.html#cb259-7" tabindex="-1"></a>                    <span class="at">ymax =</span> mean <span class="sc">+</span> sd)) <span class="sc">+</span></span>
<span id="cb259-8"><a href="visualizations.html#cb259-8" tabindex="-1"></a>  <span class="fu">coord_flip</span>() </span>
<span id="cb259-9"><a href="visualizations.html#cb259-9" tabindex="-1"></a></span>
<span id="cb259-10"><a href="visualizations.html#cb259-10" tabindex="-1"></a>boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> atlNO2, </span>
<span id="cb259-11"><a href="visualizations.html#cb259-11" tabindex="-1"></a>                  <span class="fu">aes</span>( <span class="at">x =</span> city, </span>
<span id="cb259-12"><a href="visualizations.html#cb259-12" tabindex="-1"></a>                       <span class="at">y =</span> conc,</span>
<span id="cb259-13"><a href="visualizations.html#cb259-13" tabindex="-1"></a>                       <span class="at">fill =</span> p)) <span class="sc">+</span></span>
<span id="cb259-14"><a href="visualizations.html#cb259-14" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb259-15"><a href="visualizations.html#cb259-15" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb259-16"><a href="visualizations.html#cb259-16" tabindex="-1"></a></span>
<span id="cb259-17"><a href="visualizations.html#cb259-17" tabindex="-1"></a>boxplot</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="visualizations.html#cb260-1" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(colchart, </span>
<span id="cb260-2"><a href="visualizations.html#cb260-2" tabindex="-1"></a>                  boxplot, </span>
<span id="cb260-3"><a href="visualizations.html#cb260-3" tabindex="-1"></a>                  <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb260-4"><a href="visualizations.html#cb260-4" tabindex="-1"></a>                  <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb260-5"><a href="visualizations.html#cb260-5" tabindex="-1"></a>                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb260-6"><a href="visualizations.html#cb260-6" tabindex="-1"></a>                  <span class="at">common.legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb260-7"><a href="visualizations.html#cb260-7" tabindex="-1"></a>                  <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="R4EnvChem_files/figure-html/unnamed-chunk-149-2.png" width="672" /></p>
</div>
<div id="anotating-plots" class="section level3 hasAnchor" number="15.8.6">
<h3><span class="header-section-number">15.8.6</span> Anotating plots<a href="visualizations.html#anotating-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Everyplot can do with a bit of annotation. These range from providing critical information for contextualizing and understanding your plot to pointing out something you think the reader might miss but should know. These are different then <em>captions</em>, which is accomplished in the <code>rmarkdown</code> chunk header (see <a href="using-r-markdown.html#r-code-chunk-options">R code chunk options</a> for a refresher).</p>
<p>Let’s quickly plot a map of annual mean 1-hr [NO2] in our dataset so we can visualzie them spatially. Note, the map we’re making here is rather basic, to make prettier maps see <a href="chm410-air-quality-lab.html#chm410-air-quality-lab">CHM410: Air Quality Lab</a>.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="visualizations.html#cb261-1" tabindex="-1"></a><span class="co"># need lat and long value for map</span></span>
<span id="cb261-2"><a href="visualizations.html#cb261-2" tabindex="-1"></a>mapNO2 <span class="ot">&lt;-</span> atlNO2 <span class="sc">%&gt;%</span></span>
<span id="cb261-3"><a href="visualizations.html#cb261-3" tabindex="-1"></a>  <span class="fu">group_by</span>(latitude, longitude, p,  city) <span class="sc">%&gt;%</span></span>
<span id="cb261-4"><a href="visualizations.html#cb261-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(conc))</span>
<span id="cb261-5"><a href="visualizations.html#cb261-5" tabindex="-1"></a></span>
<span id="cb261-6"><a href="visualizations.html#cb261-6" tabindex="-1"></a><span class="co">#install.packages(&quot;ggmap&quot;)</span></span>
<span id="cb261-7"><a href="visualizations.html#cb261-7" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb261-8"><a href="visualizations.html#cb261-8" tabindex="-1"></a></span>
<span id="cb261-9"><a href="visualizations.html#cb261-9" tabindex="-1"></a><span class="co"># atlMap &lt;- get_stamenmap(bbox = make_bbox(lon = mapNO2$longitude, </span></span>
<span id="cb261-10"><a href="visualizations.html#cb261-10" tabindex="-1"></a><span class="co">#                                          lat = mapNO2$latitude, </span></span>
<span id="cb261-11"><a href="visualizations.html#cb261-11" tabindex="-1"></a><span class="co">#                                          f = 0.1), </span></span>
<span id="cb261-12"><a href="visualizations.html#cb261-12" tabindex="-1"></a><span class="co">#                         zoom = 6, </span></span>
<span id="cb261-13"><a href="visualizations.html#cb261-13" tabindex="-1"></a><span class="co">#                         maptype = &quot;terrain&quot;, </span></span>
<span id="cb261-14"><a href="visualizations.html#cb261-14" tabindex="-1"></a><span class="co">#                         crop = FALSE)</span></span>
<span id="cb261-15"><a href="visualizations.html#cb261-15" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb261-16"><a href="visualizations.html#cb261-16" tabindex="-1"></a><span class="co"># atlMap &lt;- ggmap(atlMap) </span></span>
<span id="cb261-17"><a href="visualizations.html#cb261-17" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb261-18"><a href="visualizations.html#cb261-18" tabindex="-1"></a><span class="co"># atlMap</span></span></code></pre></div>
<p>Now we want to plot our annual mean 1-hr [NO2] onto the map. We’ve covered this in detail in <a href="chm410-air-quality-lab.html#plotting-airbeam-data-spatially">Plotting Airbeam data spatially</a>, but for this plot we spefically want to annotate each point with it’s corresponding city location. Doing this manually would take ages, so we’re going to use the <a href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html"><code>ggrepel</code> package</a>. We simply need to specify which column (<code>naps id</code>) we’ll use for our labels:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="visualizations.html#cb262-1" tabindex="-1"></a><span class="co"># atlMap + geom_point(data = mapNO2, </span></span>
<span id="cb262-2"><a href="visualizations.html#cb262-2" tabindex="-1"></a><span class="co">#              aes(x=longitude,</span></span>
<span id="cb262-3"><a href="visualizations.html#cb262-3" tabindex="-1"></a><span class="co">#                  y=latitude,</span></span>
<span id="cb262-4"><a href="visualizations.html#cb262-4" tabindex="-1"></a><span class="co">#                  colour = mean,</span></span>
<span id="cb262-5"><a href="visualizations.html#cb262-5" tabindex="-1"></a><span class="co">#                  size = mean),</span></span>
<span id="cb262-6"><a href="visualizations.html#cb262-6" tabindex="-1"></a><span class="co">#              alpha = 0.8) +</span></span>
<span id="cb262-7"><a href="visualizations.html#cb262-7" tabindex="-1"></a><span class="co">#   scale_alpha(guide = &quot;none&quot;) + # removing legend for alpha</span></span>
<span id="cb262-8"><a href="visualizations.html#cb262-8" tabindex="-1"></a><span class="co">#   scale_size(guide = &quot;none&quot;) + # removing legend for size</span></span>
<span id="cb262-9"><a href="visualizations.html#cb262-9" tabindex="-1"></a><span class="co">#   ggrepel::geom_label_repel(data = mapNO2, </span></span>
<span id="cb262-10"><a href="visualizations.html#cb262-10" tabindex="-1"></a><span class="co">#                             aes(x=longitude,</span></span>
<span id="cb262-11"><a href="visualizations.html#cb262-11" tabindex="-1"></a><span class="co">#                                 y=latitude,</span></span>
<span id="cb262-12"><a href="visualizations.html#cb262-12" tabindex="-1"></a><span class="co">#                                 label = city),</span></span>
<span id="cb262-13"><a href="visualizations.html#cb262-13" tabindex="-1"></a><span class="co">#                             box.padding = 0.5,</span></span>
<span id="cb262-14"><a href="visualizations.html#cb262-14" tabindex="-1"></a><span class="co">#                             max.overlaps = Inf)</span></span>
<span id="cb262-15"><a href="visualizations.html#cb262-15" tabindex="-1"></a><span class="co"># </span></span></code></pre></div>
<p>Again, not the prettiest map, but that’s up to you to fix in post. <a href="https://ggrepel.slowkow.com/articles/examples.html"><code>geom_text_repel()</code></a> is an incredibly useful package for quickly annotating plots. If you need to label/annotate points check it out.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="summarizing-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelling-linear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/UofTChem-Teaching/R4EnvChem/visualizations-redux.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

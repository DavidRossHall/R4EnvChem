---
title: 'Chapter 10: Tidying Your Data'
output:
  html_document:
    df_print: paged
---

# Before Going in: Working with the `storms` dataset

Before we dive into the exercises, let's get familiar with the dataset we'll be using for the exercises - the `storms` dataset from the `tidyverse` package.

The `storms` dataset contains information on the 2015 Atlantic tropical storms and hurricanes. It provides details like the storm name, date of occurrence, wind speed, atmospheric pressure, and more. This dataset is a great example of real-world data, and will allow us to perform various data tidying operations to extract insights.

Let's first import and take a peek at the data. Simply run the code below!

```{r}
# Importing the necessary library
library(tidyverse)

# Viewing the first few rows of the storms dataset
head(storms)
```


------------------------------------------------------------------------

# Exercise 1: Making Data Wider

**Your Task:**

We have selected the first 10 rows of the `storms` dataset for this exercise. 

For this dataset (`subset_storms`), use the `pivot_wider()` function to spread the `wind` values across different `status` columns. Assign this to a new variable named `wider_data`. Use `names_prefix`=`wind_`.

```{r}
# Complete the code below and run the cell.
subset_storms <- storms[1:10, ]

# Your code here
wider_data <- 
```


#### Test Your Code (Exercise 1)

Do not modify the cell below. 

```{r}
library(testthat, quietly = TRUE)
test_that("Making data 'wider' using pivot_wider()", {
  expect_true("wind_tropical depression" %in% colnames(wider_data))
  expect_true("wind_tropical storm" %in% colnames(wider_data))
})

```

------------------------------------------------------------------------

# Exercise 2: Uniting Columns

**Your Task:**

Using the `storms` dataset, unite the `year` and `month` columns into a new column named `Year_Month`. Use a hyphen ("-") as the separator. Use the `unite()` function, and assign the result to a new variable named `united_data`.


```{r}
# Complete the code below and run the cell.

# Your code here
united_data <- 
```


#### Test Your Code (Exercise 1)

Do not modify the cell below. 
```{r}
library(testthat, quietly = TRUE)
test_that("Uniting columns test", {
  
  expect_true("Year_Month" %in% colnames(united_data))
  expect_equal(nchar(as.character(united_data$Year_Month[1])), 6)
})
```


------------------------------------------------------------------------

# Exercise 3: Renaming Columns

**Your Task:**

Rename the `wind` column to `Wind_Speed` and the `pressure` column to `Air_Pressure` in the `storms` dataset. Assign the result to a new variable named `renamed_data`.

```{r}
# Complete the code below and run the cell.

# Your code here
renamed_data <- 
```

#### Test Your Code (Exercise 3)

Do not modify the cell below. 
```{r}
library(testthat, quietly = TRUE)
test_that("Renaming columns test", {
  
  expect_true("Wind_Speed" %in% colnames(renamed_data))
  expect_true("Air_Pressure" %in% colnames(renamed_data))
})

```

------------------------------------------------------------------------

# Exercise 4: Selecting Columns by Prefix

**Your Task:**

We have mutated the `storms` dataset with a new column called `speed_category` that labels rows with wind speed over 50 as "High" and others as "Low". 

Using this `mutated_storms` dataset, select all columns that contain the word "speed". Then, assign the resulted dataset to a new variable named `modified_data`.

Use the `select()` along with `starts_with()` or `contains()` functions.


```{r}
# Complete the code below and run the cell.
mutated_storms <- storms %>% 
  mutate(speed_category = ifelse(wind > 50, "High", "Low"))

# Your code here
modified_data <- 
```

#### Test Your Code (Exercise 4)

Do not modify the cell below. 
```{r}
library(testthat, quietly = TRUE)

test_that("modified_data is correct", {
  
  # Ensure modified_data is a data.frame
  expect_true(is.data.frame(modified_data))
  
  # Ensure modified_data has columns containing the word 'speed'
  expect_true(any(str_detect(names(modified_data), "speed")))
  
  # Ensure number of rows is the same as original dataset
  expect_equal(nrow(modified_data), nrow(storms))
})


```

